<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂçóÈùíÂ±±„Éó„É™„Ç∫„É†„Éì„É´ - ÊäïË≥áÂÆ∂Âêë„ÅëÊÆµÈöéÁöÑÊèêÊ°à„Ç∑„Çπ„ÉÜ„É†</title>
    <link rel="stylesheet" href="/assets/css/common.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        .member-header {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
            color: white;
            padding: 20px 0;
            box-shadow: var(--shadow-sm);
        }

        .member-header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .member-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .member-name {
            font-weight: 600;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            height: 30px;
        }

        .logo img {
            height: 100%;
            width: auto;
            filter: brightness(0) invert(1);
        }

        .btn-logout {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 16px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            text-decoration: none;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .btn-logout:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .breadcrumb {
            padding: 20px 0;
            font-size: 0.9em;
            color: var(--gray-500);
        }

        .breadcrumb a {
            color: var(--primary-light);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        /* ÊÆµÈöéÁöÑÊèêÊ°à„Ç∑„Çπ„ÉÜ„É†„ÅÆ„Çπ„Çø„Ç§„É´„Çícommon.css„Éô„Éº„Çπ„ÅßË™øÊï¥ */
        .stage-indicator {
            background: white;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-sm);
            border-top: 3px solid var(--primary-light);
        }

        .stage-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .stage-item {
            flex: 1;
            text-align: center;
            position: relative;
            padding: 10px;
        }

        .stage-item:not(:last-child):after {
            content: '';
            position: absolute;
            top: 35px;
            right: -50%;
            width: 100%;
            height: 2px;
            background: var(--gray-100);
            z-index: 0;
        }

        .stage-item.completed:not(:last-child):after {
            background: var(--success);
        }

        .stage-circle {
            width: 60px;
            height: 60px;
            background: var(--gray-100);
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.3em;
            color: var(--gray-300);
            position: relative;
            z-index: 1;
            border-radius: 50%;
        }

        .stage-item.completed .stage-circle {
            background: var(--success);
            color: white;
        }

        .stage-item.current .stage-circle {
            background: var(--primary-light);
            color: white;
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.2);
        }

        .stage-label {
            font-size: 0.875rem;
            color: var(--gray-500);
            font-weight: 600;
        }

        .stage-item.completed .stage-label {
            color: var(--success);
        }

        .stage-item.current .stage-label {
            color: var(--primary-light);
        }

        .nav-tabs {
            display: flex;
            background: white;
            box-shadow: var(--shadow-sm);
            overflow-x: auto;
            margin-bottom: 30px;
        }

        .nav-tab {
            padding: 20px 30px;
            background: white;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray-500);
            white-space: nowrap;
            transition: all 0.2s ease;
            flex-shrink: 0;
            position: relative;
        }

        .nav-tab.locked {
            background: var(--gray-50);
            color: var(--gray-200);
            cursor: not-allowed;
            position: relative;
        }

        .nav-tab.locked:after {
            content: 'üîí';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
        }

        .nav-tab:not(.locked):hover {
            background: var(--gray-50);
        }

        .nav-tab.active {
            color: var(--primary-dark);
            border-bottom: 3px solid var(--primary-light);
            background: var(--primary-lighter);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-card {
            background: white;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
            border-top: 3px solid var(--primary-light);
        }

        .locked-overlay {
            position: relative;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-100) 100%);
            border: 2px dashed var(--gray-200);
        }

        .locked-content {
            text-align: center;
            padding: 40px;
        }

        .locked-icon {
            font-size: 4em;
            color: var(--gray-200);
            margin-bottom: 20px;
        }

        .locked-title {
            font-size: 1.5em;
            color: var(--gray-500);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .locked-description {
            color: var(--gray-400);
            margin-bottom: 20px;
        }

        .unlock-button {
            background: var(--primary-black);
            color: white;
            padding: 12px 30px;
            border: none;
            font-weight: 600;
            letter-spacing: 0.03em;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-block;
            text-decoration: none;
            border-radius: 0;
        }

        .unlock-button:hover {
            background: #1a1a1a;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .subsection-title {
            color: var(--primary-dark);
            font-size: 1.5em;
            margin: 25px 0 15px;
            font-weight: 600;
            border-left: 4px solid var(--primary-light);
            padding-left: 15px;
        }

        .property-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .info-box {
            background: var(--gray-50);
            padding: 20px;
            border-left: 4px solid var(--primary-light);
        }

        .info-box h4 {
            color: var(--primary-dark);
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .info-box p {
            color: var(--gray-500);
            margin: 5px 0;
        }

        .highlight-number {
            font-size: 2.5em;
            color: var(--primary-dark);
            font-weight: 700;
            display: block;
            margin: 10px 0;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .kpi-card {
            background: white;
            padding: 25px;
            text-align: center;
            box-shadow: var(--shadow-sm);
            border-top: 3px solid var(--primary-light);
        }

        .kpi-label {
            color: var(--gray-400);
            font-size: 0.875rem;
            letter-spacing: 0.05em;
            margin-bottom: 10px;
        }

        .kpi-value {
            color: var(--primary-dark);
            font-size: 2.5em;
            font-weight: 700;
        }

        .kpi-unit {
            color: var(--gray-500);
            font-size: 0.875rem;
            margin-top: 5px;
        }

        .stage-description {
            background: var(--primary-lighter);
            padding: 20px;
            margin-top: 20px;
        }

        .stage-description h3 {
            color: var(--primary-dark);
            margin-bottom: 10px;
        }

        .action-buttons {
            text-align: center;
            padding: 30px;
            background: var(--gray-50);
            margin-top: 30px;
        }

        .specs-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            box-shadow: var(--shadow-sm);
            margin: 20px 0;
        }

        .specs-table thead {
            background: linear-gradient(to bottom, #edf2f7, #e2e8f0);
        }

        .specs-table th {
            color: var(--gray-600);
            font-weight: 600;
            text-align: left;
            padding: 15px;
            border-bottom: 2px solid var(--gray-200);
            letter-spacing: 0.03em;
        }

        .specs-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--gray-100);
            color: var(--gray-500);
        }

        .specs-table tr:hover {
            background: var(--gray-50);
            transition: background 0.2s;
        }
        
        /* „Çπ„Éî„Éä„Éº„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÔºàPDF„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁî®Ôºâ */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 15px;
            }

            .member-header {
                padding: 15px 0;
            }

            .member-header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
                padding: 0 15px;
            }

            .member-info {
                gap: 10px;
                font-size: 0.9em;
            }

            .btn-logout {
                padding: 6px 12px;
                font-size: 0.8em;
            }

            /* ÁÆ°ÁêÜËÄÖ„Éë„Éç„É´„ÅÆ„É¢„Éê„Ç§„É´ÂØæÂøú */
            #adminPanel {
                width: calc(100vw - 30px) !important;
                right: 15px !important;
                left: 15px !important;
                top: 140px !important;
                max-height: 60vh !important;
            }

            /* „Éë„É≥„Åè„Åö„Éä„Éì */
            .breadcrumb {
                font-size: 0.9em;
                margin-bottom: 20px;
            }

            /* „Çπ„ÉÜ„Éº„Ç∏„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº */
            .stage-indicator {
                margin-bottom: 20px;
            }

            .stage-indicator h2 {
                font-size: 1.3em;
                margin-bottom: 15px;
            }

            .stage-progress {
                flex-direction: row;
                gap: 5px;
                overflow-x: auto;
                padding: 10px 0;
            }

            .stage-item {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 5px;
                padding: 10px;
                background: white;
                border-radius: 10px;
                box-shadow: var(--shadow-sm);
                min-width: 60px;
                flex-shrink: 0;
            }

            .stage-item:not(:last-child):after {
                display: none;
            }

            .stage-circle {
                width: 36px;
                height: 36px;
                line-height: 36px;
                font-size: 1em;
                flex-shrink: 0;
            }

            .stage-label {
                font-size: 0.7em;
                font-weight: 600;
                text-align: center;
            }

            /* „Çø„Éñ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */
            .nav-tabs {
                flex-direction: column;
                gap: 5px;
                margin-bottom: 20px;
            }

            .nav-tab {
                padding: 15px 20px;
                font-size: 0.95em;
                text-align: left;
                border-radius: 8px;
            }

            .nav-tab.locked {
                opacity: 0.5;
                background: var(--gray-100);
                padding: 12px 20px;
            }

            /* „Çª„ÇØ„Ç∑„Éß„É≥„Ç´„Éº„Éâ */
            .section-card {
                padding: 20px 15px;
                margin-bottom: 20px;
            }

            .section-title {
                font-size: 1.4em;
                margin-bottom: 15px;
            }

            .subsection-title {
                font-size: 1.1em;
                margin: 20px 0 10px;
            }

            /* KPI„Ç∞„É™„ÉÉ„Éâ */
            .kpi-grid {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }

            .kpi-card {
                padding: 15px;
            }

            .kpi-value {
                font-size: 1.8em;
            }

            /* Áâ©‰ª∂Ê¶ÇË¶Å */
            .property-overview {
                flex-direction: column;
                gap: 15px;
            }

            .info-box {
                padding: 15px;
            }

            .highlight-number {
                font-size: 1.6em;
            }

            /* „É≠„ÉÉ„ÇØÁîªÈù¢ */
            .locked-overlay {
                padding: 30px 20px;
            }

            .locked-content {
                max-width: none;
            }

            .locked-icon {
                font-size: 3em;
                margin-bottom: 15px;
            }

            .locked-title {
                font-size: 1.3em;
                margin-bottom: 10px;
            }

            .locked-description {
                font-size: 0.95em;
                margin-bottom: 20px;
                line-height: 1.6;
            }

            /* „Éú„Çø„É≥ */
            .btn {
                padding: 12px 24px;
                font-size: 0.95em;
            }

            .unlock-button {
                padding: 12px 24px;
                font-size: 0.95em;
            }

            .action-buttons {
                margin-top: 20px;
            }

            .action-buttons .btn {
                width: 100%;
                margin-bottom: 10px;
            }

            /* „ÉÅ„É£„Éº„Éà„Éª„Ç∞„É©„Éï„ÅÆ„É¢„Éê„Ç§„É´ÊúÄÈÅ©Âåñ */
            .chart-container {
                overflow-x: auto;
                margin: 15px 0;
            }

            /* „ÉÜ„Éº„Éñ„É´„ÅÆ„É¢„Éê„Ç§„É´ÊúÄÈÅ©Âåñ */
            table {
                font-size: 0.9em;
                width: 100%;
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }

            /* „ÉÜ„Ç≠„Çπ„Éà„ÅÆ„É¢„Éê„Ç§„É´Ë™øÊï¥ */
            body {
                font-size: 16px;
                line-height: 1.6;
            }

            p {
                line-height: 1.7;
            }
        }
    </style>
</head>
<body>
    <!-- ‰ºöÂì°„Éò„ÉÉ„ÉÄ„Éº -->
    <header class="member-header">
        <div class="member-header-content">
            <div class="logo">
                <img src="/assets/images/logo/prism-logo-optimized.svg" alt="PRISM">
            </div>
            <div class="member-info">
                <span class="member-name" id="memberName">VIP‰ºöÂì°Êßò</span>
                <button id="adminToggle" onclick="toggleAdminMode()" class="btn-logout" style="margin-right: 10px;"><span class="material-icons" style="vertical-align: middle; margin-right: 5px; font-size: 18px;">settings</span>ÁÆ°ÁêÜËÄÖ</button>
                <a href="/" class="btn-logout" onclick="logout()">„É≠„Ç∞„Ç¢„Ç¶„Éà</a>
            </div>
        </div>
    </header>

    <!-- ÁÆ°ÁêÜËÄÖ„Éë„Éç„É´ËÉåÊôØ„Ç™„Éº„Éê„Éº„É¨„Ç§ -->
    <div id="adminOverlay" onclick="closeAdminPanel()" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999;"></div>
    
    <!-- ÁÆ°ÁêÜËÄÖ„Éë„Éç„É´ -->
    <div id="adminPanel" style="display: none; position: fixed; top: 80px; right: 20px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); width: 320px; z-index: 1000; max-height: 80vh; overflow-y: auto;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 style="margin: 0; color: var(--primary-dark);"><span class="material-icons" style="vertical-align: middle; margin-right: 8px;">settings</span>ÁÆ°ÁêÜËÄÖ„Ç≥„É≥„Éà„É≠„Éº„É´</h3>
            <button onclick="closeAdminPanel()" style="background: none; border: none; font-size: 24px; cursor: pointer; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; color: var(--gray-500);">√ó</button>
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: var(--gray-500);">È°ßÂÆ¢„Çø„Ç§„ÉóÈÅ∏Êäû</label>
            <select id="customerType" onchange="changeCustomerType()" style="width: 100%; padding: 8px; border: 1px solid var(--gray-200); border-radius: 5px;">
                <option value="new">Êñ∞Ë¶èÈ°ßÂÆ¢ÔºàÁî∞‰∏≠ÊßòÔºâ- „Çπ„ÉÜ„Éº„Ç∏1</option>
                <option value="interested" selected>Èñ¢ÂøÉÈ°ßÂÆ¢ÔºàÈà¥Êú®ÊßòÔºâ- „Çπ„ÉÜ„Éº„Ç∏2</option>
                <option value="serious">Êú¨Ê†ºÊ§úË®éÔºàÂ±±Áî∞ÊßòÔºâ- „Çπ„ÉÜ„Éº„Ç∏3</option>
                <option value="negotiating">ÂïÜË´á‰∏≠Ôºà‰ΩêËó§ÊßòÔºâ- „Çπ„ÉÜ„Éº„Ç∏4</option>
                <option value="closing">ÊàêÁ¥ÑÂâçÔºàÈ´òÊ©ãÊßòÔºâ- „Çπ„ÉÜ„Éº„Ç∏5</option>
            </select>
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 10px; font-weight: 600; color: var(--gray-500);">„Çπ„ÉÜ„Éº„Ç∏Áõ¥Êé•ÊåáÂÆö</label>
            <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                <button class="stage-btn" onclick="setStage(1)" style="padding: 8px 16px; border: 1px solid var(--gray-200); background: white; cursor: pointer; border-radius: 5px;">S1</button>
                <button class="stage-btn active" onclick="setStage(2)" style="padding: 8px 16px; border: 1px solid var(--primary-light); background: var(--primary-lighter); cursor: pointer; border-radius: 5px; color: var(--primary-dark);">S2</button>
                <button class="stage-btn" onclick="setStage(3)" style="padding: 8px 16px; border: 1px solid var(--gray-200); background: white; cursor: pointer; border-radius: 5px;">S3</button>
                <button class="stage-btn" onclick="setStage(4)" style="padding: 8px 16px; border: 1px solid var(--gray-200); background: white; cursor: pointer; border-radius: 5px;">S4</button>
                <button class="stage-btn" onclick="setStage(5)" style="padding: 8px 16px; border: 1px solid var(--gray-200); background: white; cursor: pointer; border-radius: 5px;">S5</button>
            </div>
        </div>
        
        <div style="margin-bottom: 20px; padding: 15px; background: var(--gray-50); border-radius: 5px;">
            <p style="margin-bottom: 5px;"><strong>ÁèæÂú®„ÅÆÁä∂ÊÖãÔºö</strong></p>
            <p style="margin: 2px 0;">È°ßÂÆ¢: <span id="currentCustomer">Èñ¢ÂøÉÈ°ßÂÆ¢ÔºàÈà¥Êú®ÊßòÔºâ</span></p>
            <p style="margin: 2px 0;">„Çπ„ÉÜ„Éº„Ç∏: <span id="currentStageInfo">„Çπ„ÉÜ„Éº„Ç∏2</span></p>
        </div>
        
        <div style="display: flex; flex-direction: column; gap: 10px;">
            <button onclick="unlockAll()" style="padding: 10px; background: var(--success); color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 600;">üîì ÂÖ®Ë≥áÊñô„Ç¢„É≥„É≠„ÉÉ„ÇØ</button>
            <button onclick="resetAll()" style="padding: 10px; background: var(--danger); color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 600;">üîÑ „Çπ„ÉÜ„Éº„Ç∏2„Å´„É™„Çª„ÉÉ„Éà</button>
        </div>
    </div>

    <div class="container">
        <!-- „Éë„É≥„Åè„Åö„É™„Çπ„Éà -->
        <div class="breadcrumb">
            <a href="/member/">Áâ©‰ª∂‰∏ÄË¶ß</a> > <a href="/properties/001/">ÂçóÈùíÂ±±„Éó„É™„Ç∫„É†„Éì„É´</a>
        </div>

        <!-- „Çπ„ÉÜ„Éº„Ç∏„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº -->
        <div class="stage-indicator">
            <h2 style="color: var(--primary-dark); margin-bottom: 20px;">ÁèæÂú®„ÅÆ„Çπ„ÉÜ„Éº„Ç∏</h2>
            <div class="stage-progress">
                <div class="stage-item completed" id="stage1">
                    <div class="stage-circle">1</div>
                    <div class="stage-label">ÂàùÂõûÊé•Ëß¶</div>
                </div>
                <div class="stage-item current" id="stage2">
                    <div class="stage-circle">2</div>
                    <div class="stage-label">Èñ¢ÂøÉË°®Êòé</div>
                </div>
                <div class="stage-item" id="stage3">
                    <div class="stage-circle">3</div>
                    <div class="stage-label">Ë©≥Á¥∞Ê§úË®é</div>
                </div>
                <div class="stage-item" id="stage4">
                    <div class="stage-circle">4</div>
                    <div class="stage-label">ÂïÜË´á</div>
                </div>
                <div class="stage-item" id="stage5">
                    <div class="stage-circle">5</div>
                    <div class="stage-label">ÊúÄÁµÇÁ¢∫Ë™ç</div>
                </div>
            </div>
            <div class="stage-description">
                <h3>„Çπ„ÉÜ„Éº„Ç∏5ÔºöÊúÄÁµÇÁ¢∫Ë™ç</h3>
                <p>ÂÖ®„Å¶„ÅÆË≥áÊñô„Çí„ÅîÁ¢∫Ë™ç„ÅÑ„Åü„Å†„Åç„ÄÅÊäïË≥áÂà§Êñ≠„Å´ÂøÖË¶Å„Å™ÊÉÖÂ†±„ÇíÂÖ®„Å¶Èñ≤Ë¶ß„Åß„Åç„ÇãÊÆµÈöé„Åß„Åô„ÄÇ</p>
                <p style="margin-top: 10px;"><strong>„Ç¢„É≥„É≠„ÉÉ„ÇØÊ∏à„ÅøÔºö</strong>ÂÖ®„Å¶„ÅÆË≥áÊñô</p>
                <p><strong>Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„ÉóÔºö</strong>LINE„Åß„ÅÆ„ÅîÁõ∏Ë´á„Éª„ÅîÂ•ëÁ¥Ñ„ÅÆ„ÅäÊâãÁ∂ö„Åç</p>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview', 1)">1. Áâ©‰ª∂Ê¶ÇË¶Å</button>
            <button class="nav-tab" onclick="showTab('simulation', 2)">2. ÂèéÁõä„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</button>
            <button class="nav-tab" onclick="showTab('valuation', 3)">3. ‰æ°Ê†ºÊüªÂÆö</button>
            <button class="nav-tab" onclick="showTab('finance', 4)">4. ËûçË≥áË®àÁîª</button>
            <button class="nav-tab" onclick="showTab('summary', 5)">5. ÊäïË≥áÂà§Êñ≠„Çµ„Éû„É™„Éº</button>
            <button class="nav-tab" onclick="showTab('documents', 5)">6. ÂøÖË¶ÅÊõ∏È°û‰∏ÄÂºè</button>
        </div>

        <!-- 1. Áâ©‰ª∂Ê¶ÇË¶ÅÔºà„Çπ„ÉÜ„Éº„Ç∏1„ÅßÈñãÁ§∫Ôºâ -->
        <div id="overview" class="tab-content active">
            <div class="section-card">
                <h2 class="section-title">1. Áâ©‰ª∂Ê¶ÇË¶Å</h2>
                
                <!-- ÊäïË≥á„Éù„Ç§„É≥„ÉàÊ¶ÇË¶Å„Ç≥„É°„É≥„Éà -->
                <div style="background: var(--primary-lighter); padding: 25px; border-radius: 12px; margin-bottom: 30px;">
                    <h3 class="subsection-title" style="margin-top: 0;">ÊäïË≥á„Éù„Ç§„É≥„Éà</h3>
                    <p style="line-height: 1.8; color: var(--gray-600); margin-bottom: 15px;">
                        ÂçóÈùíÂ±±„Éó„É™„Ç∫„É†„Éì„É´„ÅØ„ÄÅÊù±‰∫¨„É°„Éà„É≠Ë°®ÂèÇÈÅìÈßÖ„Åã„ÇâÂæíÊ≠©5ÂàÜ„Å®„ÅÑ„ÅÜÁµ∂Â•Ω„ÅÆ„É≠„Ç±„Éº„Ç∑„Éß„É≥„Å´‰ΩçÁΩÆ„Åô„Çã„ÄÅ2019Âπ¥ÁØâ„ÅÆÁØâÊµÖ„Éó„É¨„Éü„Ç¢„É†„Éì„É´„Åß„Åô„ÄÇ
                        Âë®Ëæ∫„Å´„ÅØÈ´òÁ¥ö„Éñ„É©„É≥„Éâ„Ç∑„Éß„ÉÉ„Éó„ÇÑ„Ç´„Éï„Çß„ÅåÁ´ã„Å°‰∏¶„Å≥„ÄÅÂÆâÂÆö„Åó„ÅüË≥ÉË≤∏ÈúÄË¶Å„ÅåË¶ãËæº„ÇÅ„Çã„Ç®„É™„Ç¢„Åß„Åô„ÄÇ
                    </p>
                    <p style="line-height: 1.8; color: var(--gray-600); margin-bottom: 15px;">
                        <strong>Âà©Âõû„Çä„ÅÆÈ≠ÖÂäõÔºö</strong>ÁèæÂú®„ÅÆË°®Èù¢Âà©Âõû„Çä9.0%„ÅØ„ÄÅÈÉΩÂøÉ‰∏ÄÁ≠âÂú∞„ÅÆÁâ©‰ª∂„Å®„Åó„Å¶„ÅØÈùûÂ∏∏„Å´È≠ÖÂäõÁöÑ„Å™Ê∞¥Ê∫ñ„Åß„Åô„ÄÇ
                        Ê∫ÄÂÆ§Á®ºÂÉçÊôÇ„ÅØ10.8%„ÅÆÈ´òÂà©Âõû„Çä„ÅåÊúüÂæÖ„Åß„Åç„ÄÅNOIÂà©Âõû„Çä„ÇÇ6.9%„Å®ÂÆâÂÆö„Åó„ÅüÂèéÁõäÊÄß„ÇíË™á„Çä„Åæ„Åô„ÄÇ
                    </p>
                    <p style="line-height: 1.8; color: var(--gray-600);">
                        <strong>Â∞ÜÊù•ÊÄßÔºö</strong>ÂçóÈùíÂ±±„Ç®„É™„Ç¢„ÅØ‰ªäÂæå„ÇÇÁ∂ôÁ∂öÁöÑ„Å™Áô∫Â±ï„ÅåË¶ãËæº„Åæ„Çå„ÄÅË≥ÉÊñô„ÅÆ‰∏äÊòá‰ΩôÂú∞„ÇÇÂçÅÂàÜ„Å´„ÅÇ„Çä„Åæ„Åô„ÄÇ
                        ÁèæÂú®83.3%„ÅÆÁ®ºÂÉçÁéá„Åß„Åô„Åå„ÄÅÈÅ©Âàá„Å™„É™„Éº„Ç∑„É≥„Ç∞Êà¶Áï•„Å´„Çà„ÇäÊ∫ÄÂÆ§Á®ºÂÉç„ÇÇÂçÅÂàÜ„Å´ÈÅîÊàêÂèØËÉΩ„Åß„Åô„ÄÇ
                    </p>
                </div>
                
                <!-- „É≠„Ç±„Éº„Ç∑„Éß„É≥ÂàÜÊûê„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <h3 class="subsection-title">„É≠„Ç±„Éº„Ç∑„Éß„É≥ÂàÜÊûê</h3>
                
                <!-- Google Maps -->
                <div style="margin-bottom: 30px;">
                    <h4 style="font-size: 1.1em; margin-bottom: 15px;">Âë®Ëæ∫Âú∞Âõ≥</h4>
                    <div style="width: 100%; height: 400px; border-radius: 10px; overflow: hidden; box-shadow: var(--shadow-sm);">
                        <iframe 
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1620.8603544436673!2d139.7104!3d35.6641!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zMzXCsDM5JzUwLjgiTiAxMznCsDQyJzM3LjQiRQ!5e0!3m2!1sja!2sjp!4v1652345678901"
                            width="100%" 
                            height="400" 
                            style="border:0;" 
                            allowfullscreen="" 
                            loading="lazy" 
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                    </div>
                </div>

                <!-- Street View -->
                <div style="margin-bottom: 30px;">
                    <h4 style="font-size: 1.1em; margin-bottom: 15px;">„Çπ„Éà„É™„Éº„Éà„Éì„É•„Éº</h4>
                    <div style="width: 100%; height: 400px; border-radius: 10px; overflow: hidden; box-shadow: var(--shadow-sm);">
                        <iframe 
                            src="https://www.google.com/maps/embed?pb=!4v1652345678902!6m8!1m7!1sCAoSLEFGMVFpcE9QMDl5VXZGVm9BVnVfVFZEQ3Z3cVVJVjVfNGl3UXZ3MWNKTUJO!2m2!1d35.6641!2d139.7104!3f0!4f0!5f0.7820865974627469"
                            width="100%" 
                            height="400" 
                            style="border:0;" 
                            allowfullscreen="" 
                            loading="lazy" 
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                    </div>
                </div>
                
                <!-- Áâ©‰ª∂ÂÜôÁúü„ÇÆ„É£„É©„É™„Éº -->
                <div style="margin-bottom: 30px;">
                    <h4 style="font-size: 1.1em; margin-bottom: 15px;">Áâ©‰ª∂ÂÜôÁúü</h4>
                    
                    <!-- „É°„Ç§„É≥ÂÜôÁúüË°®Á§∫ -->
                    <div style="margin-bottom: 20px;">
                        <img id="mainGalleryImage" 
                             src="/assets/images/properties/001/main.jpg" 
                             alt="ÂçóÈùíÂ±±„Éó„É™„Ç∫„É†„Éì„É´" 
                             style="width: 100%; height: 500px; object-fit: cover; border-radius: 10px; box-shadow: var(--shadow-md);">
                    </div>
                    
                    <!-- „Çµ„É†„Éç„Ç§„É´ -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px;">
                        <img src="/assets/images/properties/001/main.jpg" 
                             alt="„É°„Ç§„É≥" 
                             onclick="changeGalleryImage(this.src)"
                             style="width: 100%; height: 80px; object-fit: cover; border-radius: 8px; cursor: pointer; box-shadow: var(--shadow-sm); opacity: 1; transition: opacity 0.3s;"
                             onmouseover="this.style.opacity='1'"
                             onmouseout="if(this.src !== document.getElementById('mainGalleryImage').src) this.style.opacity='0.7'">
                        <img src="/assets/images/properties/001/exterior.jpg" 
                             alt="Â§ñË¶≥" 
                             onclick="changeGalleryImage(this.src)"
                             style="width: 100%; height: 80px; object-fit: cover; border-radius: 8px; cursor: pointer; box-shadow: var(--shadow-sm); opacity: 0.7; transition: opacity 0.3s;"
                             onmouseover="this.style.opacity='1'"
                             onmouseout="if(this.src !== document.getElementById('mainGalleryImage').src) this.style.opacity='0.7'">
                        <img src="/assets/images/properties/001/interior.jpg" 
                             alt="ÂÜÖË£Ö" 
                             onclick="changeGalleryImage(this.src)"
                             style="width: 100%; height: 80px; object-fit: cover; border-radius: 8px; cursor: pointer; box-shadow: var(--shadow-sm); opacity: 0.7; transition: opacity 0.3s;"
                             onmouseover="this.style.opacity='1'"
                             onmouseout="if(this.src !== document.getElementById('mainGalleryImage').src) this.style.opacity='0.7'">
                        <img src="/assets/images/properties/001/main.jpg" 
                             alt="„Ç®„É≥„Éà„É©„É≥„Çπ" 
                             onclick="changeGalleryImage(this.src)"
                             style="width: 100%; height: 80px; object-fit: cover; border-radius: 8px; cursor: pointer; box-shadow: var(--shadow-sm); opacity: 0.7; transition: opacity 0.3s;"
                             onmouseover="this.style.opacity='1'"
                             onmouseout="if(this.src !== document.getElementById('mainGalleryImage').src) this.style.opacity='0.7'">
                        <img src="/assets/images/properties/001/exterior.jpg" 
                             alt="ÂÖ±Áî®ÈÉ®" 
                             onclick="changeGalleryImage(this.src)"
                             style="width: 100%; height: 80px; object-fit: cover; border-radius: 8px; cursor: pointer; box-shadow: var(--shadow-sm); opacity: 0.7; transition: opacity 0.3s;"
                             onmouseover="this.style.opacity='1'"
                             onmouseout="if(this.src !== document.getElementById('mainGalleryImage').src) this.style.opacity='0.7'">
                    </div>
                </div>
                
                <h3 class="subsection-title">Âü∫Êú¨ÊÉÖÂ†±</h3>
                <div class="property-overview">
                    <div class="info-box">
                        <h4>Áâ©‰ª∂ÂêçÁß∞</h4>
                        <p>ÂçóÈùíÂ±±„Éó„É™„Ç∫„É†„Éì„É´</p>
                        <p>Êù±‰∫¨ÈÉΩÊ∏ØÂå∫ÂçóÈùíÂ±±3‰∏ÅÁõÆ15Áï™8Âè∑</p>
                    </div>
                    <div class="info-box">
                        <h4>Áâ©‰ª∂„Çø„Ç§„Éó</h4>
                        <p>RCÈÄ† ‰∫ãÂãôÊâÄ„Éì„É´</p>
                        <p>ÁØâÂπ¥ÊúàÔºö2018Âπ¥4ÊúàÁ´£Â∑•ÔºàÁØâ7Âπ¥Ôºâ</p>
                    </div>
                    <div class="info-box">
                        <h4>Áâ©‰ª∂‰æ°Ê†º</h4>
                        <span class="highlight-number">3ÂÑÑ8,500‰∏áÂÜÜ</span>
                        <p>Ë°®Èù¢Âà©Âõû„ÇäÔºö9.0%ÔºàÁèæÊ≥ÅÔºâ</p>
                    </div>
                </div>

                <h3 class="subsection-title">Á´ãÂú∞Ë©ï‰æ°„ÉªÂª∫Áâ©Ë©≥Á¥∞</h3>
                <table class="specs-table">
                    <thead>
                        <tr>
                            <th>È†ÖÁõÆ</th>
                            <th>ÂÜÖÂÆπ</th>
                            <th>Ë©ï‰æ°</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ÊúÄÂØÑÈßÖ</td>
                            <td>Êù±‰∫¨„É°„Éà„É≠„ÄåË°®ÂèÇÈÅì„ÄçÈßÖ ÂæíÊ≠©4ÂàÜ / „ÄåÂ§ñËãëÂâç„ÄçÈßÖ ÂæíÊ≠©8ÂàÜ</td>
                            <td>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</td>
                        </tr>
                        <tr>
                            <td>ÈÉΩÂøÉ„Ç¢„ÇØ„Çª„Çπ</td>
                            <td>ÈäÄÂ∫ßÁ∑ö„ÉªÂçäËîµÈñÄÁ∑ö„ÉªÂçÉ‰ª£Áî∞Á∑öÂà©Áî®ÂèØ„ÄÅ‰∏ªË¶ÅÈßÖÁõ¥ÈÄö</td>
                            <td>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</td>
                        </tr>
                        <tr>
                            <td>Âë®Ëæ∫Áí∞Â¢É</td>
                            <td>ÂçóÈùíÂ±±„Ç®„É™„Ç¢„ÄÅÈ´òÁ¥ö„Ç™„Éï„Ç£„Çπ„ÉªÂïÜÊ•≠ÊñΩË®≠ÈõÜÁ©çÂú∞Âüü</td>
                            <td>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</td>
                        </tr>
                        <tr>
                            <td>Áî®ÈÄîÂú∞Âüü</td>
                            <td>Á¨¨‰∫åÁ®Æ‰∏≠È´òÂ±§‰ΩèÂ±ÖÂ∞ÇÁî®Âú∞ÂüüÔºàÂª∫ËíΩÁéá60%/ÂÆπÁ©çÁéá300%Ôºâ</td>
                            <td>‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</td>
                        </tr>
                        <tr>
                            <td>Êï∑Âú∞Èù¢Á©ç</td>
                            <td>154.96„é°Ôºà46.88Âù™Ôºâ„ÉªÂçóË•øËßíÂú∞</td>
                            <td>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</td>
                        </tr>
                        <tr>
                            <td>Âª∫Áâ©Ë¶èÊ®°</td>
                            <td>RCÈÄ†3ÈöéÂª∫„Å¶„ÉªÂª∂Â∫ä298.56„é°Ôºà90.31Âù™Ôºâ</td>
                            <td>‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="subsection-title">ÊäïË≥áÈÅ©Ê†ºÊÄßË©ï‰æ°</h3>
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-label">DSCRÔºàËûçË≥áËøîÊ∏àÂÄçÁéáÔºâ</div>
                        <div class="kpi-value">3.21</div>
                        <div class="kpi-unit">ÂÄçÔºàÂÑ™ËâØÂà§ÂÆöÔºâ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">NOIÂà©Âõû„Çä</div>
                        <div class="kpi-value">6.9</div>
                        <div class="kpi-unit">%</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">ÂÖ•Â±ÖÁéá</div>
                        <div class="kpi-value">83.3</div>
                        <div class="kpi-unit">%Ôºà5/6ÂÆ§Ôºâ</div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-black" onclick="advanceStage()">Ë©≥Á¥∞ÊÉÖÂ†±„ÇíÂ∏åÊúõ„Åô„Çã</button>
                    <button class="btn btn-outline-black" onclick="requestConsultation()">Ë≥™Âïè„Åô„Çã</button>
                </div>
            </div>
        </div>

        <!-- 2. ÂèéÁõä„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥Ôºà„Çπ„ÉÜ„Éº„Ç∏2„ÅßÈñãÁ§∫Ôºâ -->
        <div id="simulation" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">2. ÊäïË≥áÂèéÁõä„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h2>
                
                <h3 class="subsection-title">ÊäïË≥áÊ¶ÇË¶Å</h3>
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-label">Áâ©‰ª∂‰æ°Ê†º</div>
                        <div class="kpi-value">3.85</div>
                        <div class="kpi-unit">ÂÑÑÂÜÜ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Âπ¥ÈñìË≥ÉÊñôÂèéÂÖ•ÔºàÁèæÊ≥ÅÔºâ</div>
                        <div class="kpi-value">3,474</div>
                        <div class="kpi-unit">‰∏áÂÜÜ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Ê∫ÄÂÆ§ÊÉ≥ÂÆöÂèéÂÖ•</div>
                        <div class="kpi-value">4,170</div>
                        <div class="kpi-unit">‰∏áÂÜÜ/Âπ¥</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Ë°®Èù¢Âà©Âõû„ÇäÔºàÁèæÊ≥ÅÔºâ</div>
                        <div class="kpi-value">9.0</div>
                        <div class="kpi-unit">%</div>
                    </div>
                </div>

                <!-- ÁèæÊ≥Å„É¨„É≥„Éà„É≠„Éº„É´Ôºà‰æ°Ê†ºÊüªÂÆö„Çø„Éñ„Åã„ÇâÁßªÂãïÔºâ -->
                <h3 class="subsection-title">ÁèæÊ≥Å„É¨„É≥„Éà„É≠„Éº„É´</h3>
                <table class="specs-table">
                    <thead>
                        <tr>
                            <th>Èöé</th>
                            <th>„ÉÜ„Éä„É≥„Éà</th>
                            <th>Ê•≠Á®Æ</th>
                            <th>Ë≥ÉÊñô/Êúà</th>
                            <th>Â•ëÁ¥ÑÊúüÈñì</th>
                            <th>Áä∂ÊÖã</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>3F</td>
                            <td>„Éá„É´„ÇøÊ†™Âºè‰ºöÁ§æ</td>
                            <td>IT</td>
                            <td style="text-align: right;">550,000ÂÜÜ</td>
                            <td>2024.01„Äú2025.12</td>
                            <td style="color: var(--success);">ÂÖ•Â±Ö‰∏≠</td>
                        </tr>
                        <tr>
                            <td>3F</td>
                            <td>„Ç®„Éó„Ç∑„É≠„É≥ÂêàÂêå‰ºöÁ§æ</td>
                            <td>„Ç≥„É≥„Çµ„É´</td>
                            <td style="text-align: right;">530,000ÂÜÜ</td>
                            <td>2025.02„Äú2027.01</td>
                            <td style="color: var(--success);">ÂÖ•Â±Ö‰∏≠</td>
                        </tr>
                        <tr>
                            <td>2F</td>
                            <td>Ê†™Âºè‰ºöÁ§æ„Ç¨„É≥„Éû</td>
                            <td>ÂïÜÁ§æ</td>
                            <td style="text-align: right;">540,000ÂÜÜ</td>
                            <td>2022.10„Äú2024.09</td>
                            <td style="color: var(--warning);">Êõ¥Êñ∞‰∫§Ê∏â‰∏≠</td>
                        </tr>
                        <tr style="background: #fff5f5;">
                            <td>2F</td>
                            <td style="color: var(--danger);">‚Äï</td>
                            <td>‚Äï</td>
                            <td style="text-align: right; color: var(--danger);">ÔºàÂãüÈõÜ‰∏≠Ôºâ</td>
                            <td>‚Äï</td>
                            <td style="color: var(--danger);">Á©∫ÂÆ§</td>
                        </tr>
                        <tr>
                            <td>1F</td>
                            <td>Ê†™Âºè‰ºöÁ§æ„Ç¢„É´„Éï„Ç°</td>
                            <td>Â∫ÉÂëä</td>
                            <td style="text-align: right;">580,000ÂÜÜ</td>
                            <td>2023.04„Äú2025.03</td>
                            <td style="color: var(--warning);">Êõ¥Êñ∞‰∫àÂÆö</td>
                        </tr>
                        <tr>
                            <td>1F</td>
                            <td>ÂêàÂêå‰ºöÁ§æ„Éô„Éº„Çø</td>
                            <td>‰∏çÂãïÁî£</td>
                            <td style="text-align: right;">560,000ÂÜÜ</td>
                            <td>2024.07„Äú2026.06</td>
                            <td style="color: var(--success);">ÂÖ•Â±Ö‰∏≠</td>
                        </tr>
                    </tbody>
                </table>

                <!-- 20Âπ¥Èñì„ÅÆ„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„Éº„Ç∞„É©„Éï -->
                <h3 class="subsection-title">„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„Éº‰∫àÊ∏¨Ôºà20Âπ¥ÈñìÔºâ</h3>
                <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: var(--shadow-sm);">
                    <canvas id="cashflowChart" width="800" height="400"></canvas>
                </div>
                
                <!-- 20Âπ¥Èñì„ÅÆ„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„ÉºË©¶ÁÆóË°® -->
                <h3 class="subsection-title">„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„ÉºË©¶ÁÆóË°®Ôºà20Âπ¥ÈñìÔºâ</h3>
                <div style="overflow-x: auto;">
                <table class="specs-table" style="font-size: 0.9em;">
                    <thead>
                        <tr>
                            <th style="min-width: 120px;">Âπ¥</th>
                            <th>1Âπ¥ÁõÆ</th>
                            <th>2Âπ¥ÁõÆ</th>
                            <th>3Âπ¥ÁõÆ</th>
                            <th>4Âπ¥ÁõÆ</th>
                            <th>5Âπ¥ÁõÆ</th>
                            <th>10Âπ¥ÁõÆ</th>
                            <th>15Âπ¥ÁõÆ</th>
                            <th>20Âπ¥ÁõÆ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Ë≥ÉÊñôÂèéÂÖ•</strong></td>
                            <td style="text-align: right;">4,170</td>
                            <td style="text-align: right;">4,191</td>
                            <td style="text-align: right;">4,212</td>
                            <td style="text-align: right;">4,233</td>
                            <td style="text-align: right;">4,254</td>
                            <td style="text-align: right;">4,361</td>
                            <td style="text-align: right;">4,470</td>
                            <td style="text-align: right;">4,582</td>
                        </tr>
                        <tr>
                            <td><strong>ÈÅãÂñ∂Ë≤ªÁî®</strong></td>
                            <td style="text-align: right; color: var(--danger);">-813</td>
                            <td style="text-align: right; color: var(--danger);">-821</td>
                            <td style="text-align: right; color: var(--danger);">-829</td>
                            <td style="text-align: right; color: var(--danger);">-838</td>
                            <td style="text-align: right; color: var(--danger);">-846</td>
                            <td style="text-align: right; color: var(--danger);">-890</td>
                            <td style="text-align: right; color: var(--danger);">-935</td>
                            <td style="text-align: right; color: var(--danger);">-983</td>
                        </tr>
                        <tr>
                            <td><strong>NOI</strong></td>
                            <td style="text-align: right;">3,357</td>
                            <td style="text-align: right;">3,370</td>
                            <td style="text-align: right;">3,383</td>
                            <td style="text-align: right;">3,395</td>
                            <td style="text-align: right;">3,408</td>
                            <td style="text-align: right;">3,471</td>
                            <td style="text-align: right;">3,535</td>
                            <td style="text-align: right;">3,599</td>
                        </tr>
                        <tr>
                            <td><strong>„É≠„Éº„É≥ËøîÊ∏à</strong></td>
                            <td style="text-align: right; color: var(--danger);">-1,036</td>
                            <td style="text-align: right; color: var(--danger);">-1,036</td>
                            <td style="text-align: right; color: var(--danger);">-1,036</td>
                            <td style="text-align: right; color: var(--danger);">-1,036</td>
                            <td style="text-align: right; color: var(--danger);">-1,036</td>
                            <td style="text-align: right; color: var(--danger);">-1,036</td>
                            <td style="text-align: right; color: var(--danger);">-1,036</td>
                            <td style="text-align: right; color: var(--danger);">-1,036</td>
                        </tr>
                        <tr style="background: var(--primary-lighter);">
                            <td><strong>Á¥îCF</strong></td>
                            <td style="text-align: right; font-weight: bold; color: var(--primary-dark);">2,321</td>
                            <td style="text-align: right; font-weight: bold; color: var(--primary-dark);">2,334</td>
                            <td style="text-align: right; font-weight: bold; color: var(--primary-dark);">2,347</td>
                            <td style="text-align: right; font-weight: bold; color: var(--primary-dark);">2,359</td>
                            <td style="text-align: right; font-weight: bold; color: var(--primary-dark);">2,372</td>
                            <td style="text-align: right; font-weight: bold; color: var(--primary-dark);">2,435</td>
                            <td style="text-align: right; font-weight: bold; color: var(--primary-dark);">2,499</td>
                            <td style="text-align: right; font-weight: bold; color: var(--primary-dark);">2,563</td>
                        </tr>
                        <tr style="background: #f0f8ff;">
                            <td><strong>Á¥ØË®àCF</strong></td>
                            <td style="text-align: right; font-weight: bold;">2,321</td>
                            <td style="text-align: right; font-weight: bold;">4,655</td>
                            <td style="text-align: right; font-weight: bold;">7,002</td>
                            <td style="text-align: right; font-weight: bold;">9,361</td>
                            <td style="text-align: right; font-weight: bold;">11,733</td>
                            <td style="text-align: right; font-weight: bold;">23,893</td>
                            <td style="text-align: right; font-weight: bold;">36,540</td>
                            <td style="text-align: right; font-weight: bold;">49,680</td>
                        </tr>
                    </tbody>
                </table>
                </div>
                <p style="text-align: right; font-size: 0.9em; color: var(--gray-500); margin-top: 10px;">‚ÄªÂçò‰ΩçÔºö‰∏áÂÜÜ</p>

                <div class="action-buttons">
                    <button class="btn btn-black" onclick="advanceStage()">‰æ°Ê†ºÊüªÂÆö„ÇíÁ¢∫Ë™ç„Åô„Çã</button>
                    <button class="btn btn-outline-black" onclick="requestConsultation()">Â∞ÇÈñÄÂÆ∂„Å´Áõ∏Ë´á„Åô„Çã</button>
                </div>
            </div>
        </div>

        <!-- 3. ‰æ°Ê†ºÊüªÂÆöÔºà„Çπ„ÉÜ„Éº„Ç∏3„ÅßÈñãÁ§∫Ôºâ -->
        <div id="valuation" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">3. PRISMÁã¨Ëá™‰æ°Ê†ºÊüªÂÆöÂàÜÊûê</h2>
                
                <h3 class="subsection-title">ÊüªÂÆöÁµêÊûú„Çµ„Éû„É™„Éº</h3>
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-label">Â£≤Âá∫‰æ°Ê†º</div>
                        <div class="kpi-value">3.85</div>
                        <div class="kpi-unit">ÂÑÑÂÜÜ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">PRISMÊüªÂÆö‰æ°Ê†º</div>
                        <div class="kpi-value">3.81</div>
                        <div class="kpi-unit">ÂÑÑÂÜÜ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">‰æ°Ê†ºÂ¶•ÂΩìÊÄß</div>
                        <div class="kpi-value" style="color: var(--success);">ÈÅ©Ê≠£</div>
                        <div class="kpi-unit">Â∏ÇÂ†¥‰æ°Ê†º</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">ÊäïË≥áÊé®Â•®Â∫¶</div>
                        <div class="kpi-value">S</div>
                        <div class="kpi-unit">ÊúÄÂÑ™ÂÖàÊé®Â•®</div>
                    </div>
                </div>
                
                <h3 class="subsection-title">Âª∫Áâ©Ë®≠ÂÇô‰ªïÊßò</h3>
                <div class="property-overview">
                    <div class="info-box">
                        <h4>ÈõªÊ∞óË®≠ÂÇô</h4>
                        <p>60VA/„é°„ÉªÈ´òÂúßÂèóÈõª</p>
                        <p>ÂêÑÈöéÂÄãÂà•Â•ëÁ¥ÑÂØæÂøú</p>
                    </div>
                    <div class="info-box">
                        <h4>Á©∫Ë™øË®≠ÂÇô</h4>
                        <p>ÂÄãÂà•Á©∫Ë™øÊñπÂºè</p>
                        <p>24ÊôÇÈñìÂØæÂøúÂèØËÉΩ</p>
                    </div>
                    <div class="info-box">
                        <h4>„Çª„Ç≠„É•„É™„ÉÜ„Ç£</h4>
                        <p>„Çª„Ç≥„É†24ÊôÇÈñìÁõ£Ë¶ñ</p>
                        <p>IC„Ç´„Éº„ÉâÂØæÂøú</p>
                    </div>
                </div>
                
                <h3 class="subsection-title">ÂÖ¨ÁöÑË©ï‰æ°„ÉªÊãÖ‰øùË©ï‰æ°ÂàÜÊûê</h3>
                <table class="specs-table">
                    <thead>
                        <tr>
                            <th>Ë©ï‰æ°ÊñπÊ≥ï</th>
                            <th>Ë©ï‰æ°È°çÔºàÂÜÜÔºâ</th>
                            <th>ÊúÄÁµÇË©ï‰æ°È°ç„Å®„ÅÆÂ∑Æ</th>
                            <th>ÂÇôËÄÉ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ÊúÄÁµÇË©ï‰æ°È°çÔºàÊú¨„É¨„Éù„Éº„ÉàÔºâ</td>
                            <td style="text-align: right; font-weight: 600;">385,000,000</td>
                            <td style="text-align: center;">Âü∫Ê∫ñ</td>
                            <td>Â∏ÇÂ†¥ÊÄßËÄÉÊÖÆ</td>
                        </tr>
                        <tr>
                            <td>Á©çÁÆó‰æ°Ê†º</td>
                            <td style="text-align: right;">381,205,529</td>
                            <td style="text-align: center;">-1.0%</td>
                            <td>ÂúüÂú∞„ÉªÂª∫Áâ©ÂêàË®à</td>
                        </tr>
                        <tr>
                            <td>ÂèéÁõäÈÇÑÂÖÉ‰æ°Ê†ºÔºàÂπ≥ÂùáÔºâ</td>
                            <td style="text-align: right;">363,675,500</td>
                            <td style="text-align: center;">-5.5%</td>
                            <td>DCF„ÉªÁõ¥Êé•ÈÇÑÂÖÉÊ≥ï</td>
                        </tr>
                        <tr style="background: var(--primary-lighter);">
                            <td><strong>ÈäÄË°åÊãÖ‰øùË©ï‰æ°ÔºàÊé®ÂÆöÔºâ</strong></td>
                            <td style="text-align: right;"><strong>276,211,593</strong></td>
                            <td style="text-align: center;"><strong>-28.3%</strong></td>
                            <td><strong>‰øùÂÆàÁöÑË©ï‰æ°</strong></td>
                        </tr>
                    </tbody>
                </table>
                
                <div style="margin-top: 20px; padding: 20px; background: var(--primary-lighter);">
                    <h4 style="color: var(--primary-dark); margin-bottom: 15px;">ËûçË≥áÊù°‰ª∂„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h4>
                    <table class="specs-table">
                        <thead>
                            <tr>
                                <th>LTV</th>
                                <th>ËûçË≥áÂèØËÉΩÈ°ç</th>
                                <th>ÂøÖË¶ÅËá™Â∑±Ë≥áÈáë</th>
                                <th>DSCRÔºàÊÉ≥ÂÆöÔºâ</th>
                                <th>ËûçË≥áÂà§ÂÆö</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>50%</td>
                                <td style="text-align: right;">138,105,797ÂÜÜ</td>
                                <td style="text-align: right;">246,894,203ÂÜÜ</td>
                                <td style="text-align: center;">3.85</td>
                                <td style="text-align: center; color: var(--success);">‚óéÂÑ™ËâØ</td>
                            </tr>
                            <tr style="background: var(--primary-lighter);">
                                <td><strong>60%</strong></td>
                                <td style="text-align: right;"><strong>231,000,000ÂÜÜ</strong></td>
                                <td style="text-align: right;"><strong>154,000,000ÂÜÜ</strong></td>
                                <td style="text-align: center;"><strong>3.21</strong></td>
                                <td style="text-align: center; color: var(--success);"><strong>‚óéÂÑ™ËâØ</strong></td>
                            </tr>
                            <tr>
                                <td>70%</td>
                                <td style="text-align: right;">269,500,000ÂÜÜ</td>
                                <td style="text-align: right;">115,500,000ÂÜÜ</td>
                                <td style="text-align: center;">2.75</td>
                                <td style="text-align: center; color: var(--success);">‚óãËâØÂ•Ω</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div style="margin-top: 20px; color: var(--primary-text); font-size: 0.9em;">
                        <p><strong>Êé®Â•®ËûçË≥áÊù°‰ª∂Ôºö</strong></p>
                        <ul style="padding-left: 20px; margin-top: 10px; line-height: 1.8;">
                            <li>LTV 60%‰ª•ÂÜÖÔºàËûçË≥áÈ°ç2.31ÂÑÑÂÜÜÔºâ</li>
                            <li>ÈáëÂà© 1.0ÔΩû1.5%ÔºàÂ§âÂãïÈáëÂà©Ôºâ</li>
                            <li>ËøîÊ∏àÊúüÈñì 20ÔΩû25Âπ¥</li>
                            <li>DSCR 3.21ÂÄçÔºàÂçÅÂàÜ„Å™ËøîÊ∏à‰ΩôÂäõÔºâ</li>
                        </ul>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-black" onclick="advanceStage()">ËûçË≥áË®àÁîª„ÇíÁ¢∫Ë™ç„Åô„Çã</button>
                </div>
            </div>
        </div>

        <!-- 4. ËûçË≥áË®àÁîªÔºà„Çπ„ÉÜ„Éº„Ç∏4„ÅßÈñãÁ§∫Ôºâ -->
        <div id="finance" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">4. ËûçË≥áË®àÁîª„ÉªÈäÄË°åË©ï‰æ°„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h2>
                
                <h3 class="subsection-title">Êé®Â•®ËûçË≥á„Éó„É©„É≥</h3>
                <div class="property-overview">
                    <div class="info-box">
                        <h4>ËûçË≥áÈáëÈ°ç</h4>
                        <span class="highlight-number">2.31ÂÑÑÂÜÜ</span>
                        <p>ËûçË≥áÊØîÁéáÔºö60%ÔºàLTVÔºâ</p>
                    </div>
                    <div class="info-box">
                        <h4>Ëá™Â∑±Ë≥áÈáë</h4>
                        <span class="highlight-number">1.54ÂÑÑÂÜÜ</span>
                        <p>È†≠ÈáëÔºãË´∏Ë≤ªÁî®</p>
                    </div>
                    <div class="info-box">
                        <h4>ÊÉ≥ÂÆöÈáëÂà©</h4>
                        <span class="highlight-number">1.5%</span>
                        <p>Â§âÂãïÈáëÂà©ÔºàÂÑ™ÈÅáÈáëÂà©Ôºâ</p>
                    </div>
                </div>
                
                <h3 class="subsection-title">ËøîÊ∏àË®àÁîªË©≥Á¥∞</h3>
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-label">ÊúàÈ°çËøîÊ∏àÈ°ç</div>
                        <div class="kpi-value">103.6</div>
                        <div class="kpi-unit">‰∏áÂÜÜ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Âπ¥ÈñìËøîÊ∏àÈ°ç</div>
                        <div class="kpi-value">1,243</div>
                        <div class="kpi-unit">‰∏áÂÜÜ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">ËøîÊ∏àÊúüÈñì</div>
                        <div class="kpi-value">22</div>
                        <div class="kpi-unit">Âπ¥</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Á∑èËøîÊ∏àÈ°ç</div>
                        <div class="kpi-value">3.11</div>
                        <div class="kpi-unit">ÂÑÑÂÜÜ</div>
                    </div>
                </div>
                
                <h3 class="subsection-title">25Âπ¥ÈñìËøîÊ∏àË®àÁîª</h3>
                <div style="max-height: 400px; overflow-y: auto; border: 1px solid var(--gray-200); margin-bottom: 20px;">
                    <table class="specs-table">
                        <thead style="position: sticky; top: 0; background: white; z-index: 1;">
                            <tr>
                                <th>Âπ¥</th>
                                <th>ÊúàÈ°çËøîÊ∏à</th>
                                <th>Âπ¥ÈñìÂÖÉÈáë</th>
                                <th>Âπ¥ÈñìÂà©ÊÅØ</th>
                                <th>Á¥ØË®àÂÖÉÈáë</th>
                                <th>ÊÆãÂÖÉÈáë</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">9,067,200ÂÜÜ</td>
                                <td style="text-align: right;">3,364,800ÂÜÜ</td>
                                <td style="text-align: right;">9,067,200ÂÜÜ</td>
                                <td style="text-align: right;">221,932,800ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>2Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">9,203,308ÂÜÜ</td>
                                <td style="text-align: right;">3,228,692ÂÜÜ</td>
                                <td style="text-align: right;">18,270,508ÂÜÜ</td>
                                <td style="text-align: right;">212,729,492ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>3Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">9,343,357ÂÜÜ</td>
                                <td style="text-align: right;">3,088,643ÂÜÜ</td>
                                <td style="text-align: right;">27,613,865ÂÜÜ</td>
                                <td style="text-align: right;">203,386,135ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>4Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">9,487,412ÂÜÜ</td>
                                <td style="text-align: right;">2,944,588ÂÜÜ</td>
                                <td style="text-align: right;">37,101,277ÂÜÜ</td>
                                <td style="text-align: right;">193,898,723ÂÜÜ</td>
                            </tr>
                            <tr style="background: var(--primary-lighter);">
                                <td><strong>5Âπ¥ÁõÆ</strong></td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;"><strong>9,635,543ÂÜÜ</strong></td>
                                <td style="text-align: right;">2,796,457ÂÜÜ</td>
                                <td style="text-align: right;"><strong>46,736,820ÂÜÜ</strong></td>
                                <td style="text-align: right;"><strong>184,263,180ÂÜÜ</strong></td>
                            </tr>
                            <tr>
                                <td>6Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">9,787,817ÂÜÜ</td>
                                <td style="text-align: right;">2,644,183ÂÜÜ</td>
                                <td style="text-align: right;">56,524,637ÂÜÜ</td>
                                <td style="text-align: right;">174,475,363ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>7Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">9,944,304ÂÜÜ</td>
                                <td style="text-align: right;">2,487,696ÂÜÜ</td>
                                <td style="text-align: right;">66,468,941ÂÜÜ</td>
                                <td style="text-align: right;">164,531,059ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>8Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">10,105,069ÂÜÜ</td>
                                <td style="text-align: right;">2,326,931ÂÜÜ</td>
                                <td style="text-align: right;">76,574,010ÂÜÜ</td>
                                <td style="text-align: right;">154,425,990ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>9Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">10,270,195ÂÜÜ</td>
                                <td style="text-align: right;">2,161,805ÂÜÜ</td>
                                <td style="text-align: right;">86,844,205ÂÜÜ</td>
                                <td style="text-align: right;">144,155,795ÂÜÜ</td>
                            </tr>
                            <tr style="background: var(--primary-lighter);">
                                <td><strong>10Âπ¥ÁõÆ</strong></td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;"><strong>10,439,748ÂÜÜ</strong></td>
                                <td style="text-align: right;">1,992,252ÂÜÜ</td>
                                <td style="text-align: right;"><strong>97,283,953ÂÜÜ</strong></td>
                                <td style="text-align: right;"><strong>133,716,047ÂÜÜ</strong></td>
                            </tr>
                            <tr>
                                <td>11Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">10,613,904ÂÜÜ</td>
                                <td style="text-align: right;">1,818,096ÂÜÜ</td>
                                <td style="text-align: right;">107,897,857ÂÜÜ</td>
                                <td style="text-align: right;">123,102,143ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>12Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">10,792,743ÂÜÜ</td>
                                <td style="text-align: right;">1,639,257ÂÜÜ</td>
                                <td style="text-align: right;">118,690,600ÂÜÜ</td>
                                <td style="text-align: right;">112,309,400ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>13Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">10,976,435ÂÜÜ</td>
                                <td style="text-align: right;">1,455,565ÂÜÜ</td>
                                <td style="text-align: right;">129,667,035ÂÜÜ</td>
                                <td style="text-align: right;">101,332,965ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>14Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">11,165,162ÂÜÜ</td>
                                <td style="text-align: right;">1,266,838ÂÜÜ</td>
                                <td style="text-align: right;">140,832,197ÂÜÜ</td>
                                <td style="text-align: right;">90,167,803ÂÜÜ</td>
                            </tr>
                            <tr style="background: var(--primary-lighter);">
                                <td><strong>15Âπ¥ÁõÆ</strong></td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;"><strong>11,359,115ÂÜÜ</strong></td>
                                <td style="text-align: right;">1,072,885ÂÜÜ</td>
                                <td style="text-align: right;"><strong>152,191,312ÂÜÜ</strong></td>
                                <td style="text-align: right;"><strong>78,808,688ÂÜÜ</strong></td>
                            </tr>
                            <tr>
                                <td>16Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">11,558,483ÂÜÜ</td>
                                <td style="text-align: right;">873,517ÂÜÜ</td>
                                <td style="text-align: right;">163,749,795ÂÜÜ</td>
                                <td style="text-align: right;">67,250,205ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>17Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">11,763,462ÂÜÜ</td>
                                <td style="text-align: right;">668,538ÂÜÜ</td>
                                <td style="text-align: right;">175,513,257ÂÜÜ</td>
                                <td style="text-align: right;">55,486,743ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>18Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">11,974,248ÂÜÜ</td>
                                <td style="text-align: right;">457,752ÂÜÜ</td>
                                <td style="text-align: right;">187,487,505ÂÜÜ</td>
                                <td style="text-align: right;">43,512,495ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>19Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">12,191,032ÂÜÜ</td>
                                <td style="text-align: right;">240,968ÂÜÜ</td>
                                <td style="text-align: right;">199,678,537ÂÜÜ</td>
                                <td style="text-align: right;">31,321,463ÂÜÜ</td>
                            </tr>
                            <tr style="background: var(--primary-lighter);">
                                <td><strong>20Âπ¥ÁõÆ</strong></td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;"><strong>12,414,013ÂÜÜ</strong></td>
                                <td style="text-align: right;">17,987ÂÜÜ</td>
                                <td style="text-align: right;"><strong>212,092,550ÂÜÜ</strong></td>
                                <td style="text-align: right;"><strong>18,907,450ÂÜÜ</strong></td>
                            </tr>
                            <tr>
                                <td>21Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">1,036,000ÂÜÜ</td>
                                <td style="text-align: right;">12,643,393ÂÜÜ</td>
                                <td style="text-align: right;">0ÂÜÜ</td>
                                <td style="text-align: right;">224,735,943ÂÜÜ</td>
                                <td style="text-align: right;">6,264,057ÂÜÜ</td>
                            </tr>
                            <tr>
                                <td>22Âπ¥ÁõÆ</td>
                                <td style="text-align: right;">525,304ÂÜÜ</td>
                                <td style="text-align: right;">6,264,057ÂÜÜ</td>
                                <td style="text-align: right;">39,605ÂÜÜ</td>
                                <td style="text-align: right;">231,000,000ÂÜÜ</td>
                                <td style="text-align: right;">0ÂÜÜ</td>
                            </tr>
                            <tr style="background: var(--success-light);">
                                <td><strong>ÂÆåÊ∏à</strong></td>
                                <td style="text-align: center;"><strong>22Âπ¥ÁõÆ„ÅßÂÆåÊ∏à</strong></td>
                                <td style="text-align: right;"><strong>231,000,000ÂÜÜ</strong></td>
                                <td style="text-align: right;"><strong>80,840,040ÂÜÜ</strong></td>
                                <td style="text-align: right;"><strong>231,000,000ÂÜÜ</strong></td>
                                <td style="text-align: right;"><strong>0ÂÜÜ</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div style="background: var(--primary-lighter); padding: 20px; margin: 20px 0;">
                    <h4 style="color: var(--primary-dark); margin-bottom: 15px;">ËøîÊ∏àË®àÁîª„Çµ„Éû„É™„Éº</h4>
                    <div class="property-overview">
                        <div class="info-box">
                            <h5>ÂÆåÊ∏àÂπ¥Êï∞</h5>
                            <span class="highlight-number">22Âπ¥</span>
                            <p>Ë®≠ÂÆöÊúüÈñì25Âπ¥„Çà„Çä3Âπ¥Êó©ÊúüÂÆåÊ∏à</p>
                        </div>
                        <div class="info-box">
                            <h5>Á∑èËøîÊ∏àÈ°ç</h5>
                            <span class="highlight-number">3.118ÂÑÑÂÜÜ</span>
                            <p>ÂÖÉÈáë2.31ÂÑÑÂÜÜÔºãÂà©ÊÅØ8,084‰∏áÂÜÜ</p>
                        </div>
                        <div class="info-box">
                            <h5>Âà©ÊÅØÁ∑èÈ°ç</h5>
                            <span class="highlight-number">8,084‰∏áÂÜÜ</span>
                            <p>ÂÖÉÈáë„Å´ÂØæ„Åô„ÇãÂà©ÊÅØÊØîÁéáÔºö35.0%</p>
                        </div>
                    </div>
                </div>
                
                <h3 class="subsection-title">„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„Éº„Ç´„Éê„Éº„É¨„Ç∑„Ç™ÂàÜÊûê</h3>
                <div class="property-overview">
                    <div class="info-box">
                        <h4>DSCRÔºàÂÇµÂãôËøîÊ∏à„Ç´„Éê„ÉºÁéáÔºâ</h4>
                        <span class="highlight-number">3.21ÂÄç</span>
                        <p>ÂÑ™ËâØ„Å™ËøîÊ∏à‰ΩôÂäõ</p>
                    </div>
                    <div class="info-box">
                        <h4>ËøîÊ∏àÊØîÁéá</h4>
                        <span class="highlight-number">35.8%</span>
                        <p>NOI„Å´Âç†„ÇÅ„ÇãËøîÊ∏à„ÅÆÂâ≤Âêà</p>
                    </div>
                    <div class="info-box">
                        <h4>„Éï„É™„Éº„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„Éº</h4>
                        <span class="highlight-number">1,366‰∏áÂÜÜ</span>
                        <p>„É≠„Éº„É≥ËøîÊ∏àÂæå„ÅÆÊâãÊÆã„Çä</p>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 20px; background: var(--primary-bg);">
                    <h4 style="color: var(--primary-dark); margin-bottom: 15px;">ËûçË≥áÊù°‰ª∂„É°„É¢</h4>
                    <p style="line-height: 1.8; color: var(--primary-text);">
                        <strong>Êú¨Áâ©‰ª∂„ÅÆËûçË≥áÁâπÂæ¥Ôºö</strong><br>
                        „Éª DSCR 3.21ÂÄç„Å®ÂçÅÂàÜ„Å™ËøîÊ∏à‰ΩôÂäõ„Åå„ÅÇ„Çä„ÄÅÈäÄË°åËûçË≥á„ÅÆÂèñ„Çä‰ªò„Åë„ÅåÂÆπÊòì<br>
                        „Éª ÊúàÈ°ç103.6‰∏áÂÜÜ„ÅÆËøîÊ∏à„Å´ÂØæ„Åó„Å¶„ÄÅNOI„Åå2,661‰∏áÂÜÜ„Å®ÂçÅÂàÜ„Å™„Éû„Éº„Ç∏„É≥<br>
                        „Éª ÂçóÈùíÂ±±„ÅÆÂÑ™ËâØÁâ©‰ª∂„Åß„ÅÇ„Çä„ÄÅÊãÖ‰øù‰æ°ÂÄ§„ÅåÂÆâÂÆö„Åó„Å¶„ÅÑ„Çã„Åü„ÇÅÂÑ™ÈÅáÈáëÂà©„ÅÆÈÅ©Áî®„ÅåÊúüÂæÖ<br>
                        „Éª 25Âπ¥Èñì„ÅÆÈï∑ÊúüËøîÊ∏à„ÅßÊúàÈ°çË≤†ÊãÖ„ÇíÊäëÂà∂„Åó„ÄÅÂÆâÂÆöÁöÑ„Å™„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„Éº„ÇíÁ¢∫‰øù
                    </p>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-black" onclick="advanceStage()">ÊúÄÁµÇÁ¢∫Ë™ç„Å∏ÈÄ≤„ÇÄ</button>
                    <button class="btn btn-outline-black" onclick="requestConsultation()">ËûçË≥áÁõ∏Ë´á„ÇíÁî≥„ÅóËæº„ÇÄ</button>
                </div>
            </div>
        </div>

        <!-- 5. ÊäïË≥áÂà§Êñ≠„Çµ„Éû„É™„ÉºÔºà„Çπ„ÉÜ„Éº„Ç∏5„ÅßÈñãÁ§∫Ôºâ -->
        <div id="summary" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">5. ÊäïË≥áÂà§Êñ≠„Çµ„Éû„É™„Éº</h2>
                
                <div style="background: var(--primary-lighter); padding: 30px; text-align: center; margin: 20px 0;">
                    <h2 style="color: var(--primary-dark); margin-bottom: 20px;">PRISMÊäïË≥áÊé®Â•®Â∫¶</h2>
                    <span style="font-size: 4em; color: var(--primary-dark); font-weight: bold;">S</span>
                    <p style="margin-top: 10px; font-size: 1.2em;">ÊúÄÂÑ™ÂÖàÊé®Â•®</p>
                </div>
                
                <h3 class="subsection-title">DCFÊ≥ï„Å´„Çà„ÇãÂèéÁõä‰æ°Ê†ºÁÆóÂÆö</h3>
                <table class="specs-table">
                    <thead>
                        <tr>
                            <th>È†ÖÁõÆ</th>
                            <th>Ë®≠ÂÆöÂÄ§</th>
                            <th>Ë®≠ÂÆöÊ†πÊã†</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ÂàÜÊûêÊúüÈñì</td>
                            <td>10Âπ¥Èñì</td>
                            <td>‰∏ÄËà¨ÁöÑ„Å™‰∏çÂãïÁî£ÊäïË≥áÊúüÈñì</td>
                        </tr>
                        <tr>
                            <td>Ââ≤ÂºïÁéá</td>
                            <td>3.5%</td>
                            <td>ÂçóÈùíÂ±±„Ç®„É™„Ç¢„ÅÆÂÑ™ËâØÁâ©‰ª∂„É™„Çπ„ÇØ</td>
                        </tr>
                        <tr>
                            <td>ÊúÄÁµÇÈÇÑÂÖÉÂà©Âõû„Çä</td>
                            <td>4.0%</td>
                            <td>Ââ≤ÂºïÁéáÔºã0.5%ÔºàÁ´ãÂú∞„ÅÆÂÆâÂÆöÊÄßËÄÉÊÖÆÔºâ</td>
                        </tr>
                        <tr>
                            <td>Ë≥ÉÊñô‰∏äÊòáÁéáÔºà1-5Âπ¥ÁõÆÔºâ</td>
                            <td>1.0%/Âπ¥</td>
                            <td>ÂçóÈùíÂ±±„Ç®„É™„Ç¢„ÅÆÈúÄË¶ÅÂ¢óÂä†ÂÇæÂêë</td>
                        </tr>
                        <tr>
                            <td>Á©∫ÂÆ§Áéá</td>
                            <td>5.0%</td>
                            <td>„Ç®„É™„Ç¢Âπ≥ÂùáÊ∞¥Ê∫ñÔºàÂÑ™ËâØÁâ©‰ª∂Ôºâ</td>
                        </tr>
                        <tr style="background: var(--primary-lighter);">
                            <td><strong>DCFÊ≥ï„Å´„Çà„ÇãÂèéÁõä‰æ°Ê†º</strong></td>
                            <td colspan="2" style="text-align: center; font-size: 1.2em; font-weight: bold;">357,782,000ÂÜÜ</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3 class="subsection-title">10Âπ¥Èñì„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„Éº‰∫àÊ∏¨</h3>
                <table class="specs-table">
                    <thead>
                        <tr>
                            <th>Âπ¥Ê¨°</th>
                            <th>Á∑èÂèéÂÖ•</th>
                            <th>ÈÅãÂñ∂Ë≤ªÁî®</th>
                            <th>NOI</th>
                            <th>Ë≥áÊú¨ÁöÑÊîØÂá∫</th>
                            <th>NCF</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1Âπ¥ÁõÆ</td>
                            <td style="text-align: right;">34,740,000</td>
                            <td style="text-align: right;">8,130,610</td>
                            <td style="text-align: right;">26,609,390</td>
                            <td style="text-align: right;">1,000,000</td>
                            <td style="text-align: right;">25,609,390</td>
                        </tr>
                        <tr>
                            <td>2Âπ¥ÁõÆ</td>
                            <td style="text-align: right;">35,087,400</td>
                            <td style="text-align: right;">8,211,916</td>
                            <td style="text-align: right;">26,875,484</td>
                            <td style="text-align: right;">1,000,000</td>
                            <td style="text-align: right;">25,875,484</td>
                        </tr>
                        <tr>
                            <td>3Âπ¥ÁõÆ</td>
                            <td style="text-align: right;">35,438,274</td>
                            <td style="text-align: right;">8,294,035</td>
                            <td style="text-align: right;">27,144,239</td>
                            <td style="text-align: right;">1,000,000</td>
                            <td style="text-align: right;">26,144,239</td>
                        </tr>
                        <tr>
                            <td>5Âπ¥ÁõÆ</td>
                            <td style="text-align: right;">36,150,583</td>
                            <td style="text-align: right;">8,460,745</td>
                            <td style="text-align: right;">27,689,838</td>
                            <td style="text-align: right;">5,000,000</td>
                            <td style="text-align: right;">22,689,838</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3 class="subsection-title">ÊäïË≥áÊåáÊ®ô„Çµ„Éû„É™„Éº</h3>
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-label">10Âπ¥ÈñìÂπ≥ÂùáNOI</div>
                        <div class="kpi-value">2,853</div>
                        <div class="kpi-unit">‰∏áÂÜÜ/Âπ¥</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">NOIÂà©Âõû„ÇäÔºàÁèæÊ≥ÅÔºâ</div>
                        <div class="kpi-value">6.9</div>
                        <div class="kpi-unit">%</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">NCFÂà©Âõû„ÇäÔºàÁèæÊ≥ÅÔºâ</div>
                        <div class="kpi-value">6.65</div>
                        <div class="kpi-unit">%</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Á∑èÂêàÊäïË≥áÂà©Âõû„ÇäÔºàIRRÔºâ</div>
                        <div class="kpi-value">12.8</div>
                        <div class="kpi-unit">%</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; padding: 20px; background: var(--primary-bg);">
                    <h4 style="color: var(--primary-dark); margin-bottom: 15px;">ÊäïË≥áÂà§Êñ≠Á∑èÊã¨</h4>
                    <p style="line-height: 1.8; color: var(--primary-text);">
                        <strong>Êú¨Áâ©‰ª∂„ÅØ‰ª•‰∏ã„ÅÆÁêÜÁî±„Å´„Çà„ÇäÊúÄÂÑ™ÂÖàÊé®Â•®Áâ©‰ª∂„Å®Âà§ÂÆö„Åó„Åæ„Åó„ÅüÔºö</strong><br>
                        1. Ë°®ÂèÇÈÅìÈßÖÂæíÊ≠©4ÂàÜ„Å®„ÅÑ„ÅÜÂÑ™ËâØ„Å™Á´ãÂú∞Êù°‰ª∂<br>
                        2. DSCR 3.21ÂÄç„Å®„ÅÑ„ÅÜÂçÅÂàÜ„Å™ËøîÊ∏à‰ΩôÂäõ<br>
                        3. NOIÂà©Âõû„Çä6.9%„Å®È´òÊ∞¥Ê∫ñ„ÅÆÂèéÁõäÊÄß<br>
                        4. Á©çÁÆó‰æ°Ê†º„Å®Â∏ÇÂ†¥‰æ°Ê†º„ÅåËøë‰ºº„Åó„Å¶„Åä„Çä„ÄÅË≥áÁî£‰æ°ÂÄ§„ÅÆË£∑‰ªò„Åë„ÅåÊòéÁ¢∫<br>
                        5. ÂçóÈùíÂ±±„Ç®„É™„Ç¢„ÅÆÂ∞ÜÊù•ÊÄß„Å®Â∏åÂ∞ëÊÄß„Åã„Çâ„ÄÅÈï∑ÊúüÁöÑ„Å™Ë≥áÁî£‰æ°ÂÄ§Á∂≠ÊåÅ„ÅåÊúüÂæÖ„Åï„Çå„Çã
                    </p>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-black" onclick="requestConsultation()">LINE„ÅßÂ•ëÁ¥ÑÁõ∏Ë´á</button>
                </div>
            </div>
        </div>

        <!-- 6. ÂøÖË¶ÅÊõ∏È°û‰∏ÄÂºèÔºà„Çπ„ÉÜ„Éº„Ç∏5„ÅßÈñãÁ§∫Ôºâ -->
        <div id="documents" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">6. „ÅîÊèê‰æõË≥áÊñô‰∏ÄË¶ß</h2>
                
                <h3 class="subsection-title">„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂèØËÉΩË≥áÊñô</h3>
                <div style="background: var(--gray-50); padding: 30px;">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 30px;">
                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: var(--shadow-sm); display: flex; flex-direction: column; height: 100%;">
                            <h4 style="color: var(--primary-dark); margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="color: var(--success); margin-right: 10px; font-size: 1.2em;">‚úì</span>
                                Áâ©‰ª∂Ê¶ÇË¶ÅÊõ∏ÔºàË©≥Á¥∞ÁâàÔºâ
                            </h4>
                            <p style="font-size: 0.9em; color: var(--gray-500); line-height: 1.6; margin-bottom: 15px; flex-grow: 1;">
                                Áâ©‰ª∂„ÅÆÂü∫Êú¨ÊÉÖÂ†±„ÄÅÁ´ãÂú∞Êù°‰ª∂„ÄÅÂª∫Áâ©‰ªïÊßò„ÄÅ„É¨„É≥„Éà„É≠„Éº„É´„ÇíË®òËºâ„Åó„ÅüË©≥Á¥∞„Å™Ê¶ÇË¶ÅÊõ∏„Åß„Åô„ÄÇ
                            </p>
                            <button class="btn btn-black" onclick="downloadDocument('property-overview')" style="width: 100%; font-size: 0.9em; opacity: 1; visibility: visible; display: flex; align-items: center; justify-content: center;"><span class="material-icons" style="margin-right: 8px; font-size: 18px;">description</span>„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</button>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: var(--shadow-sm); display: flex; flex-direction: column; height: 100%;">
                            <h4 style="color: var(--primary-dark); margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="color: var(--success); margin-right: 10px; font-size: 1.2em;">‚úì</span>
                                PRISM‰æ°ÂÄ§Ë©ï‰æ°„É¨„Éù„Éº„Éà
                            </h4>
                            <p style="font-size: 0.9em; color: var(--gray-500); line-height: 1.6; margin-bottom: 15px; flex-grow: 1;">
                                Êú¨„É¨„Éù„Éº„Éà„ÅÆÂÆåÂÖ®ÁâàÔºà30„Éö„Éº„Ç∏Ôºâ„ÄÇÂÖ¨ÁöÑË©ï‰æ°„ÄÅÊãÖ‰øùË©ï‰æ°„ÄÅDCFÂàÜÊûê„ÄÅ25Âπ¥ËûçË≥áË®àÁîª„Å™„Å©„ÇíÂê´„ÇÄÁ∑èÂêàÁöÑ„Å™ÊäïË≥áÂà§Êñ≠Ë≥áÊñô„Åß„Åô„ÄÇ
                            </p>
                            <button class="btn btn-black" onclick="downloadPDF('complete')" style="width: 100%; font-size: 0.9em; opacity: 1; visibility: visible; display: flex; align-items: center; justify-content: center;"><span class="material-icons" style="margin-right: 8px; font-size: 18px;">picture_as_pdf</span>PDFÁâà„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</button>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 30px;">
                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: var(--shadow-sm); display: flex; flex-direction: column; height: 100%;">
                            <h4 style="color: var(--primary-dark); margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="color: var(--success); margin-right: 10px; font-size: 1.2em;">‚úì</span>
                                ÂèéÊîØ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
                            </h4>
                            <p style="font-size: 0.9em; color: var(--gray-500); line-height: 1.6; margin-bottom: 15px; flex-grow: 1;">
                                Ë©≥Á¥∞„Å™ÂèéÊîØË®àÁÆó„Å®10Âπ¥Èñì„ÅÆ„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„Éº‰∫àÊ∏¨„ÇíÂê´„ÇÄÂåÖÊã¨ÁöÑ„Å™ÂèéÊîØÂàÜÊûê„É¨„Éù„Éº„Éà„Åß„Åô„ÄÇPDFÁâà„Å®ExcelÁâà„Çí„ÅîÁî®ÊÑè„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ
                            </p>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-black" onclick="downloadDocument('financial-simulation-pdf')" style="flex: 1; font-size: 0.9em; opacity: 1; visibility: visible; display: flex; align-items: center; justify-content: center;"><span class="material-icons" style="margin-right: 8px; font-size: 18px;">picture_as_pdf</span>PDFÁâà</button>
                                <button class="btn btn-black" onclick="downloadDocument('cashflow-simulation')" style="flex: 1; font-size: 0.9em; opacity: 1; visibility: visible; display: flex; align-items: center; justify-content: center;"><span class="material-icons" style="margin-right: 8px; font-size: 18px;">table_chart</span>ExcelÁâà</button>
                            </div>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: var(--shadow-sm); display: flex; flex-direction: column; height: 100%;">
                            <h4 style="color: var(--primary-dark); margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="color: var(--success); margin-right: 10px; font-size: 1.2em;">‚úì</span>
                                ËûçË≥á„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
                            </h4>
                            <p style="font-size: 0.9em; color: var(--gray-500); line-height: 1.6; margin-bottom: 15px; flex-grow: 1;">
                                Êé®Â•®ÈáëËûçÊ©üÈñ¢„Åß„ÅÆËûçË≥áÊù°‰ª∂„ÄÅ25Âπ¥ËøîÊ∏à„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÄÅÂøÖË¶ÅÊõ∏È°û„ÅÆ‰∏ÄË¶ß„ÇíË®òËºâ„Åó„ÅüËûçË≥áÊèêÊ°àÊõ∏„Åß„Åô„ÄÇ
                            </p>
                            <button class="btn btn-black" onclick="downloadDocument('loan-simulation')" style="width: 100%; font-size: 0.9em; opacity: 1; visibility: visible; display: flex; align-items: center; justify-content: center;"><span class="material-icons" style="margin-right: 8px; font-size: 18px;">account_balance</span>„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</button>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-black" onclick="downloadAllDocuments()" style="display: inline-flex; align-items: center; justify-content: center; padding: 15px 30px; font-size: 1.1em;"><span class="material-icons" style="margin-right: 8px; font-size: 24px;">download</span>ÂÖ®Ë≥áÊñô‰∏ÄÊã¨„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ÁèæÂú®„ÅÆ„Çπ„ÉÜ„Éº„Ç∏Ôºà„Éá„Éï„Ç©„É´„Éà„ÅßÂÖ®Ë≥áÊñôÈñãÊîæÔºâ
        let currentStage = 5;
        let isAdminMode = false;
        
        // ÂÜôÁúü„ÇÆ„É£„É©„É™„Éº„ÅÆÁîªÂÉèÂàá„ÇäÊõø„ÅàÈñ¢Êï∞
        function changeGalleryImage(src) {
            const mainImage = document.getElementById('mainGalleryImage');
            if (mainImage) {
                mainImage.src = src;
                
                // „Åô„Åπ„Å¶„ÅÆ„Çµ„É†„Éç„Ç§„É´„ÅÆÈÄèÊòéÂ∫¶„Çí„É™„Çª„ÉÉ„Éà
                const thumbnails = document.querySelectorAll('[onclick*="changeGalleryImage"]');
                thumbnails.forEach(thumb => {
                    thumb.style.opacity = thumb.src === src ? '1' : '0.7';
                });
            }
        }

        function showTab(tabId, requiredStage) {
            // ÂøÖË¶Å„Å™„Çπ„ÉÜ„Éº„Ç∏„Å´ÈÅî„Åó„Å¶„ÅÑ„Å™„ÅÑÂ†¥ÂêàÔºàÁÆ°ÁêÜËÄÖ„É¢„Éº„Éâ„Åß„Å™„Åë„Çå„Å∞Ôºâ
            if (requiredStage && requiredStage > currentStage && !isAdminMode) {
                showLockedMessage(requiredStage);
                return;
            }
            
            // „Åô„Åπ„Å¶„ÅÆ„Çø„Éñ„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíÈùûË°®Á§∫
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => {
                content.classList.remove('active');
            });
            
            // „Åô„Åπ„Å¶„ÅÆ„Çø„Éñ„Éú„Çø„É≥„Åã„Çâ active „ÇØ„É©„Çπ„ÇíÂâäÈô§
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ÈÅ∏Êäû„Åï„Çå„Åü„Çø„Éñ„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíË°®Á§∫
            document.getElementById(tabId).classList.add('active');
            
            // ÈÅ∏Êäû„Åï„Çå„Åü„Çø„Éñ„Éú„Çø„É≥„Å´ active „ÇØ„É©„Çπ„ÇíËøΩÂä†
            const activeTab = Array.from(tabs).find(tab => 
                tab.textContent.includes(getTabTitle(tabId))
            );
            if (activeTab && !activeTab.classList.contains('locked')) {
                activeTab.classList.add('active');
            }
            
            // „Éö„Éº„Ç∏„Éà„ÉÉ„Éó„Å´„Çπ„ÇØ„É≠„Éº„É´
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function getTabTitle(tabId) {
            const titles = {
                'overview': 'Áâ©‰ª∂Ê¶ÇË¶Å',
                'simulation': 'ÂèéÁõä„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥',
                'valuation': '‰æ°Ê†ºÊüªÂÆö',
                'finance': 'ËûçË≥áË®àÁîª',
                'summary': 'ÊäïË≥áÂà§Êñ≠',
                'documents': 'ÂøÖË¶ÅÊõ∏È°û'
            };
            return titles[tabId] || '';
        }
        
        function showLockedMessage(requiredStage) {
            const messages = {
                3: '‰æ°Ê†ºÊüªÂÆöÂàÜÊûê„Çí„ÅîË¶ß„ÅÑ„Åü„Å†„Åè„Å´„ÅØ„ÄÅË©≥Á¥∞Ê§úË®éÊÆµÈöé„Å∏„ÅÆÁßªË°å„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ',
                4: 'ËûçË≥áË®àÁîª„ÅÆË©≥Á¥∞„ÅØ„ÄÅÂïÜË´áÊÆµÈöé„Åß„ÅîÊèê‰æõ„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ',
                5: 'ÊúÄÁµÇË≥áÊñô„ÅØ„ÄÅÂ•ëÁ¥ÑÂâç„ÅÆÊúÄÁµÇÁ¢∫Ë™çÊÆµÈöé„Åß„ÅîÊèê‰æõ„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ'
            };
            
            alert(messages[requiredStage] || '„Åì„ÅÆÊÉÖÂ†±„ÅØÊ¨°„ÅÆÊÆµÈöé„Åß„ÅîÊèê‰æõ„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ');
        }
        
        function requestUnlock(stage) {
            const actions = {
                3: '‰æ°Ê†ºÊüªÂÆöÂàÜÊûê„ÅÆ„Ç¢„É≥„É≠„ÉÉ„ÇØÁî≥Ë´ã„ÇíÂèó„Åë‰ªò„Åë„Åæ„Åó„Åü„ÄÇÊãÖÂΩìËÄÖ„Çà„ÇäÈÄ£Áµ°„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ',
                4: 'ÂïÜË´á„ÅÆ„ÅäÁî≥„ÅóËæº„Åø„ÇíÂèó„Åë‰ªò„Åë„Åæ„Åó„Åü„ÄÇÊó•Á®ãË™øÊï¥„ÅÆ„ÅîÈÄ£Áµ°„Çí„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ',
                5: 'ÊúÄÁµÇÊ§úË®éÊÆµÈöé„Å∏„ÅÆÁßªË°å„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åó„Åü„ÄÇÂÖ®Ë≥áÊñô„ÇíÊ∫ñÂÇô„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ'
            };
            
            alert(actions[stage]);
            // ÂÆüÈöõ„Å´„ÅØ„Åì„Åì„ÅßAPI„Ç≥„Éº„É´„Å™„Å©„ÇíË°å„ÅÜ
        }
        
        function advanceStage() {
            if (currentStage < 5) {
                currentStage++;
                updateStageIndicator();
                unlockContent();
                alert(`„Çπ„ÉÜ„Éº„Ç∏${currentStage}„Å´ÈÄ≤„Åø„Åæ„Åó„Åü„ÄÇÊñ∞„Åó„ÅÑÊÉÖÂ†±„Åå„Ç¢„É≥„É≠„ÉÉ„ÇØ„Åï„Çå„Åæ„Åó„Åü„ÄÇ`);
            }
        }
        
        function updateStageIndicator() {
            // „Çπ„ÉÜ„Éº„Ç∏„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº„ÇíÊõ¥Êñ∞
            const stageItems = document.querySelectorAll('.stage-item');
            stageItems.forEach((item, index) => {
                if (index < currentStage - 1) {
                    item.classList.add('completed');
                    item.classList.remove('current');
                } else if (index === currentStage - 1) {
                    item.classList.add('current');
                    item.classList.remove('completed');
                } else {
                    item.classList.remove('completed', 'current');
                }
            });
            
            // „Çπ„ÉÜ„Éº„Ç∏Ë™¨Êòé„ÇíÊõ¥Êñ∞
            const descriptions = {
                1: {
                    title: '„Çπ„ÉÜ„Éº„Ç∏1ÔºöÂàùÂõûÊé•Ëß¶',
                    desc: 'Áâ©‰ª∂„ÅÆÂü∫Êú¨ÊÉÖÂ†±„Çí„ÅîÁ¢∫Ë™ç„ÅÑ„Åü„Å†„ÅèÊÆµÈöé„Åß„Åô„ÄÇ',
                    unlocked: 'Áâ©‰ª∂Ê¶ÇË¶Å',
                    next: 'ÂèéÁõä„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥'
                },
                2: {
                    title: '„Çπ„ÉÜ„Éº„Ç∏2ÔºöÈñ¢ÂøÉË°®Êòé',
                    desc: 'Áâ©‰ª∂Ê¶ÇË¶Å„Çí„ÅîÁ¢∫Ë™ç„ÅÑ„Åü„Å†„Åç„ÄÅ„Çà„ÇäË©≥Á¥∞„Å™ÂèéÁõä„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„Çí„ÅîË¶ß„ÅÑ„Åü„Å†„Åë„ÇãÊÆµÈöé„Åß„Åô„ÄÇ',
                    unlocked: 'Áâ©‰ª∂Ê¶ÇË¶Å„ÄÅÂèéÁõä„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥',
                    next: '‰æ°Ê†ºÊüªÂÆöÂàÜÊûê„ÄÅËûçË≥áË®àÁîªË©≥Á¥∞'
                },
                3: {
                    title: '„Çπ„ÉÜ„Éº„Ç∏3ÔºöË©≥Á¥∞Ê§úË®é',
                    desc: 'PRISMÁã¨Ëá™„ÅÆ‰æ°Ê†ºÊüªÂÆöÂàÜÊûê„Å´„Çà„Çä„ÄÅÊäïË≥áÂà§Êñ≠„ÅÆÊùêÊñô„Çí„ÅîÊèê‰æõ„Åó„Åæ„Åô„ÄÇ',
                    unlocked: 'Áâ©‰ª∂Ê¶ÇË¶Å„ÄÅÂèéÁõä„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÄÅ‰æ°Ê†ºÊüªÂÆö',
                    next: 'ËûçË≥áË®àÁîªË©≥Á¥∞„ÄÅÊäïË≥áÂà§Êñ≠„Çµ„Éû„É™„Éº'
                },
                4: {
                    title: '„Çπ„ÉÜ„Éº„Ç∏4ÔºöÂïÜË´á',
                    desc: 'ËûçË≥áË®àÁîª„ÇíÂê´„ÇÄÂÖ∑‰ΩìÁöÑ„Å™ÊäïË≥á„Éó„É©„É≥„Çí„ÅîÊèêÊ°à„Åó„Åæ„Åô„ÄÇ',
                    unlocked: 'Áâ©‰ª∂Ê¶ÇË¶Å„ÄÅÂèéÁõä„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÄÅ‰æ°Ê†ºÊüªÂÆö„ÄÅËûçË≥áË®àÁîª',
                    next: 'ÊäïË≥áÂà§Êñ≠„Çµ„Éû„É™„Éº„ÄÅÂ•ëÁ¥ÑÊõ∏È°û'
                },
                5: {
                    title: '„Çπ„ÉÜ„Éº„Ç∏5ÔºöÊúÄÁµÇÁ¢∫Ë™ç',
                    desc: 'ÂÖ®„Å¶„ÅÆÊÉÖÂ†±„ÇíÈñãÁ§∫„Åó„ÄÅÊúÄÁµÇÁöÑ„Å™ÊäïË≥áÂà§Êñ≠„Çí„Çµ„Éù„Éº„Éà„Åó„Åæ„Åô„ÄÇ',
                    unlocked: 'ÂÖ®Ë≥áÊñô',
                    next: 'Â•ëÁ¥ÑÊâãÁ∂ö„Åç„Å∏'
                }
            };
            
            const stageDesc = descriptions[currentStage];
            if (stageDesc) {
                document.querySelector('.stage-description').innerHTML = `
                    <h3>${stageDesc.title}</h3>
                    <p>${stageDesc.desc}</p>
                    <p style="margin-top: 10px;"><strong>„Ç¢„É≥„É≠„ÉÉ„ÇØÊ∏à„ÅøÔºö</strong>${stageDesc.unlocked}</p>
                    <p><strong>Ê¨°„ÅÆ„Çπ„ÉÜ„Éº„Ç∏„ÅßÈñãÁ§∫Ôºö</strong>${stageDesc.next}</p>
                `;
            }
        }
        
        function unlockContent() {
            const tabs = document.querySelectorAll('.nav-tab');
            const unlockMap = {
                1: [0],              // „Çπ„ÉÜ„Éº„Ç∏1: Áâ©‰ª∂Ê¶ÇË¶Å„ÅÆ„Åø
                2: [0, 1],           // „Çπ„ÉÜ„Éº„Ç∏2: Áâ©‰ª∂Ê¶ÇË¶Å„ÄÅÂèéÁõä„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
                3: [0, 1, 2],        // „Çπ„ÉÜ„Éº„Ç∏3: Ôºã‰æ°Ê†ºÊüªÂÆö
                4: [0, 1, 2, 3],     // „Çπ„ÉÜ„Éº„Ç∏4: ÔºãËûçË≥áË®àÁîª
                5: [0, 1, 2, 3, 4, 5] // „Çπ„ÉÜ„Éº„Ç∏5: ÂÖ®„Å¶
            };
            
            tabs.forEach((tab, index) => {
                if ((unlockMap[currentStage] && unlockMap[currentStage].includes(index)) || isAdminMode) {
                    tab.classList.remove('locked');
                } else {
                    tab.classList.add('locked');
                }
            });
        }

        // ÁÆ°ÁêÜËÄÖ„É¢„Éº„Éâ„ÅÆÂàáÊõø
        function toggleAdminMode() {
            isAdminMode = !isAdminMode;
            const adminPanel = document.getElementById('adminPanel');
            const adminOverlay = document.getElementById('adminOverlay');
            const adminBtn = document.getElementById('adminToggle');
            
            if (isAdminMode) {
                adminPanel.style.display = 'block';
                adminOverlay.style.display = 'block';
                adminBtn.style.background = 'var(--primary-light)';
                adminBtn.innerHTML = '<span class="material-icons" style="vertical-align: middle; margin-right: 5px; font-size: 18px;">settings</span>ÁÆ°ÁêÜËÄÖÔºàONÔºâ';
                unlockContent(); // ÁÆ°ÁêÜËÄÖ„É¢„Éº„ÉâÊôÇ„ÅØÂÖ®„Çø„Éñ„Ç¢„É≥„É≠„ÉÉ„ÇØ
                
                // „É¢„Éê„Ç§„É´„Åß„ÅÆ„Çπ„ÇØ„É≠„Éº„É´Èò≤Ê≠¢
                if (window.innerWidth <= 768) {
                    document.body.style.overflow = 'hidden';
                }
            } else {
                adminPanel.style.display = 'none';
                adminOverlay.style.display = 'none';
                adminBtn.style.background = 'rgba(255, 255, 255, 0.2)';
                adminBtn.innerHTML = '<span class="material-icons" style="vertical-align: middle; margin-right: 5px; font-size: 18px;">settings</span>ÁÆ°ÁêÜËÄÖ';
                unlockContent(); // ÈÄöÂ∏∏„É¢„Éº„Éâ„Å´Êàª„Åô
                document.body.style.overflow = '';
            }
        }
        
        // ÁÆ°ÁêÜËÄÖ„Éë„Éç„É´„ÇíÈñâ„Åò„Çã
        function closeAdminPanel() {
            isAdminMode = false;
            const adminPanel = document.getElementById('adminPanel');
            const adminOverlay = document.getElementById('adminOverlay');
            const adminBtn = document.getElementById('adminToggle');
            
            adminPanel.style.display = 'none';
            adminOverlay.style.display = 'none';
            adminBtn.style.background = 'rgba(255, 255, 255, 0.2)';
            adminBtn.innerHTML = '<span class="material-icons" style="vertical-align: middle; margin-right: 5px; font-size: 18px;">settings</span>ÁÆ°ÁêÜËÄÖ';
            unlockContent(); // ÈÄöÂ∏∏„É¢„Éº„Éâ„Å´Êàª„Åô
            document.body.style.overflow = '';
        }
        
        // „Çπ„ÉÜ„Éº„Ç∏Ë®≠ÂÆöÔºàÁÆ°ÁêÜËÄÖÁî®Ôºâ
        function setStage(stage) {
            currentStage = stage;
            updateStageIndicator();
            unlockContent();
            // loadStageContent(stage); // ÂâäÈô§: HTML„Å´Êó¢„Å´„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Åå„ÅÇ„Çã„Åü„ÇÅ‰∏çË¶Å
            
            // „Éú„Çø„É≥„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖã„ÇíÊõ¥Êñ∞
            document.querySelectorAll('.stage-btn').forEach(btn => {
                btn.style.background = 'white';
                btn.style.borderColor = 'var(--gray-200)';
                btn.style.color = 'inherit';
            });
            event.target.style.background = 'var(--primary-lighter)';
            event.target.style.borderColor = 'var(--primary-light)';
            event.target.style.color = 'var(--primary-dark)';
            
            // ÁÆ°ÁêÜËÄÖÊÉÖÂ†±„ÇíÊõ¥Êñ∞
            document.getElementById('currentStageInfo').textContent = `„Çπ„ÉÜ„Éº„Ç∏${stage}`;
            
            // Ë©≤ÂΩì„Åô„Çã„Çø„Éñ„ÇíË°®Á§∫
            if (stage === 1) showTab('overview', 1);
            else if (stage === 2) showTab('simulation', 2);
            else if (stage >= 3) showTab('overview', 1);
        }
        
        // È°ßÂÆ¢„Çø„Ç§„ÉóÂ§âÊõ¥ÔºàÁÆ°ÁêÜËÄÖÁî®Ôºâ
        function changeCustomerType() {
            const customerType = document.getElementById('customerType').value;
            const customerNames = {
                'new': 'Êñ∞Ë¶èÈ°ßÂÆ¢ÔºàÁî∞‰∏≠ÊßòÔºâ',
                'interested': 'Èñ¢ÂøÉÈ°ßÂÆ¢ÔºàÈà¥Êú®ÊßòÔºâ',
                'serious': 'Êú¨Ê†ºÊ§úË®éÔºàÂ±±Áî∞ÊßòÔºâ',
                'negotiating': 'ÂïÜË´á‰∏≠Ôºà‰ΩêËó§ÊßòÔºâ',
                'closing': 'ÊàêÁ¥ÑÂâçÔºàÈ´òÊ©ãÊßòÔºâ'
            };
            
            const stageMap = {
                'new': 1,
                'interested': 2,
                'serious': 3,
                'negotiating': 4,
                'closing': 5
            };
            
            document.getElementById('currentCustomer').textContent = customerNames[customerType];
            setStage(stageMap[customerType]);
        }
        
        // ÂÖ®Ë≥áÊñô„Ç¢„É≥„É≠„ÉÉ„ÇØÔºàÁÆ°ÁêÜËÄÖÁî®Ôºâ
        function unlockAll() {
            currentStage = 5;
            updateStageIndicator();
            unlockContent();
            // loadStageContent(5); // ÂâäÈô§: HTML„Å´Êó¢„Å´„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Åå„ÅÇ„Çã„Åü„ÇÅ‰∏çË¶Å
            alert('ÂÖ®„Å¶„ÅÆË≥áÊñô„Åå„Ç¢„É≥„É≠„ÉÉ„ÇØ„Åï„Çå„Åæ„Åó„Åü„ÄÇ');
            
            // UIÊõ¥Êñ∞
            document.getElementById('currentStageInfo').textContent = '„Çπ„ÉÜ„Éº„Ç∏5';
            document.getElementById('customerType').value = 'closing';
            document.getElementById('currentCustomer').textContent = 'ÊàêÁ¥ÑÂâçÔºàÈ´òÊ©ãÊßòÔºâ';
        }
        
        // „É™„Çª„ÉÉ„ÉàÔºàÁÆ°ÁêÜËÄÖÁî®Ôºâ
        function resetAll() {
            currentStage = 2;
            updateStageIndicator();
            unlockContent();
            // resetContent(); // ÂâäÈô§: HTML„Å´Êó¢„Å´„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Åå„ÅÇ„Çã„Åü„ÇÅ‰∏çË¶Å
            showTab('overview', 1);
            document.getElementById('customerType').value = 'interested';
            document.getElementById('currentCustomer').textContent = 'Èñ¢ÂøÉÈ°ßÂÆ¢ÔºàÈà¥Êú®ÊßòÔºâ';
            document.getElementById('currentStageInfo').textContent = '„Çπ„ÉÜ„Éº„Ç∏2';
            alert('ÂàùÊúüÁä∂ÊÖãÔºà„Çπ„ÉÜ„Éº„Ç∏2Ôºâ„Å´„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„Åü„ÄÇ');
        }

        // „Çπ„ÉÜ„Éº„Ç∏„Åî„Å®„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑË™≠„ÅøËæº„ÅøÔºàÂªÉÊ≠¢ÔºöHTML„Å´Áõ¥Êé•Ë®òËºâÔºâ
        /* function loadStageContent(stage) {
            if (stage >= 3) {
                // ‰æ°Ê†ºÊüªÂÆö„ÅÆ„É≠„ÉÉ„ÇØ„ÇíËß£Èô§„Åó„Å¶ÂÆü„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíË°®Á§∫
                document.querySelector('#valuation .section-card').innerHTML = `
                    <h2 class="section-title">3. PRISMÁã¨Ëá™‰æ°Ê†ºÊüªÂÆöÂàÜÊûê</h2>
                    <h3 class="subsection-title">ÊüªÂÆöÁµêÊûú„Çµ„Éû„É™„Éº</h3>
                    <div class="kpi-grid">
                        <div class="kpi-card">
                            <div class="kpi-label">Â£≤Âá∫‰æ°Ê†º</div>
                            <div class="kpi-value">6.8</div>
                            <div class="kpi-unit">ÂÑÑÂÜÜ</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">PRISMÊüªÂÆö‰æ°Ê†º</div>
                            <div class="kpi-value">7.2</div>
                            <div class="kpi-unit">ÂÑÑÂÜÜ</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">‰æ°Ê†ºÂ¶•ÂΩìÊÄß</div>
                            <div class="kpi-value" style="color: var(--success);">ÂÑ™ËâØ</div>
                            <div class="kpi-unit">Ââ≤ÂÆâÂà§ÂÆö</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">ÊäïË≥áÊé®Â•®Â∫¶</div>
                            <div class="kpi-value">S</div>
                            <div class="kpi-unit">ÊúÄÂÑ™ÂÖàÊé®Â•®</div>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-black" onclick="advanceStage()">ËûçË≥áË®àÁîª„ÇíÁ¢∫Ë™ç„Åô„Çã</button>
                    </div>
                `;
            }
            
            if (stage >= 4) {
                // ËûçË≥áË®àÁîª„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ
                document.querySelector('#finance .section-card').innerHTML = `
                    <h2 class="section-title">4. ËûçË≥áË®àÁîª„ÉªÈäÄË°åË©ï‰æ°„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h2>
                    <h3 class="subsection-title">Êé®Â•®ËûçË≥á„Éó„É©„É≥</h3>
                    <div class="property-overview">
                        <div class="info-box">
                            <h4>ËûçË≥áÈáëÈ°ç</h4>
                            <span class="highlight-number">5.1ÂÑÑÂÜÜ</span>
                            <p>ËûçË≥áÊØîÁéáÔºö75%</p>
                        </div>
                        <div class="info-box">
                            <h4>Ëá™Â∑±Ë≥áÈáë</h4>
                            <span class="highlight-number">1.8ÂÑÑÂÜÜ</span>
                            <p>È†≠ÈáëÔºãË´∏Ë≤ªÁî®</p>
                        </div>
                        <div class="info-box">
                            <h4>ÊÉ≥ÂÆöÈáëÂà©</h4>
                            <span class="highlight-number">1.2%</span>
                            <p>Â§âÂãïÈáëÂà©ÔºàÂÑ™ÈÅáÈÅ©Áî®Ôºâ</p>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-black" onclick="advanceStage()">ÊúÄÁµÇÁ¢∫Ë™ç„Å∏ÈÄ≤„ÇÄ</button>
                    </div>
                `;
            }
            
            if (stage >= 5) {
                // ÊäïË≥áÂà§Êñ≠„Çµ„Éû„É™„Éº„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ
                document.querySelector('#summary .section-card').innerHTML = `
                    <h2 class="section-title">5. ÊäïË≥áÂà§Êñ≠„Çµ„Éû„É™„Éº</h2>
                    <div style="background: var(--primary-lighter); padding: 30px; text-align: center; margin: 20px 0;">
                        <h2 style="color: var(--primary-dark); margin-bottom: 20px;">PRISMÊäïË≥áÊé®Â•®Â∫¶</h2>
                        <span style="font-size: 4em; color: var(--primary-dark); font-weight: bold;">S</span>
                        <p style="margin-top: 10px; font-size: 1.2em;">ÊúÄÂÑ™ÂÖàÊé®Â•®</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-black" onclick="requestConsultation()">LINE„ÅßÂ•ëÁ¥ÑÁõ∏Ë´á</button>
                    </div>
                `;
                
                // ÂøÖË¶ÅÊõ∏È°û„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ
                document.querySelector('#documents .section-card').innerHTML = `
                    <h2 class="section-title">6. „ÅîÊèê‰æõË≥áÊñô‰∏ÄË¶ß</h2>
                    <h3 class="subsection-title">„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂèØËÉΩË≥áÊñô</h3>
                    <div style="background: var(--gray-50); padding: 30px;">
                        <ul style="list-style: none; padding: 0;">
                            <li style="padding: 10px 0; border-bottom: 1px solid var(--gray-100); position: relative; padding-left: 35px;">
                                <span style="position: absolute; left: 0; color: var(--success); font-weight: bold; font-size: 1.2em;">‚úì</span>
                                Áâ©‰ª∂Ê¶ÇË¶ÅÊõ∏ÔºàË©≥Á¥∞ÁâàÔºâ
                            </li>
                            <li style="padding: 10px 0; border-bottom: 1px solid var(--gray-100); position: relative; padding-left: 35px;">
                                <span style="position: absolute; left: 0; color: var(--success); font-weight: bold; font-size: 1.2em;">‚úì</span>
                                PRISM‰æ°ÂÄ§Ë©ï‰æ°„É¨„Éù„Éº„ÉàÔºà30„Éö„Éº„Ç∏Ôºâ
                            </li>
                            <li style="padding: 10px 0; border-bottom: 1px solid var(--gray-100); position: relative; padding-left: 35px;">
                                <span style="position: absolute; left: 0; color: var(--success); font-weight: bold; font-size: 1.2em;">‚úì</span>
                                10Âπ¥ÈñìÂèéÊîØ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÔºàExcelÔºâ
                            </li>
                        </ul>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-black" onclick="alert('Ë≥áÊñô„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü')">ÂÖ®Ë≥áÊñô„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</button>
                    </div>
                `;
            }
        } */

        // „Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅÆ„É™„Çª„ÉÉ„ÉàÔºàÂªÉÊ≠¢ÔºöHTML„Å´Áõ¥Êé•Ë®òËºâÔºâ
        /* function resetContent() {
            // „É≠„ÉÉ„ÇØÁîªÈù¢„ÇíÂÜçË®≠ÂÆö
            document.querySelector('#valuation .section-card').innerHTML = `
                <div class="locked-overlay">
                    <div class="locked-content">
                        <div class="locked-icon">üîí</div>
                        <h2 class="locked-title">‰æ°Ê†ºÊüªÂÆöÂàÜÊûê</h2>
                        <p class="locked-description">
                            PRISMÁã¨Ëá™„ÅÆ3ÊâãÊ≥ï„Å´„Çà„ÇãË©≥Á¥∞„Å™‰æ°Ê†ºÊüªÂÆöÂàÜÊûê„Çí„ÅîË¶ß„ÅÑ„Åü„Å†„Åë„Åæ„Åô„ÄÇ<br>
                            „Ç®„É™„Ç¢Áõ∏Â†¥„Å®„ÅÆÊØîËºÉ„ÄÅÊäïË≥áÂ¶•ÂΩìÊÄß„ÅÆÂà§ÂÆöÁµêÊûú„ÇíÂê´„Åø„Åæ„Åô„ÄÇ
                        </p>
                        <button class="unlock-button" onclick="requestUnlock(3)">
                            „Ç¢„É≥„É≠„ÉÉ„ÇØ„ÇíÁî≥Ë´ã„Åô„Çã
                        </button>
                    </div>
                </div>
            `;
            document.querySelector('#finance .section-card').innerHTML = `
                <div class="locked-overlay">
                    <div class="locked-content">
                        <div class="locked-icon">üîí</div>
                        <h2 class="locked-title">ËûçË≥áË®àÁîªË©≥Á¥∞</h2>
                        <p class="locked-description">
                            ÊèêÊê∫ÈáëËûçÊ©üÈñ¢„ÅÆËûçË≥áÊù°‰ª∂„ÄÅÂøÖË¶ÅÂ±ûÊÄß„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÄÅ<br>
                            ÈäÄË°åË©ï‰æ°È°ç‰∫àÊ∏¨„Å™„Å©„ÄÅËûçË≥áÂÆüÁèæ„Å´Âêë„Åë„ÅüË©≥Á¥∞ÊÉÖÂ†±„Çí„ÅîÊèê‰æõ„Åó„Åæ„Åô„ÄÇ
                        </p>
                        <button class="unlock-button" onclick="requestUnlock(4)">
                            ÂïÜË´á„ÇíÁî≥„ÅóËæº„ÇÄ
                        </button>
                    </div>
                </div>
            `;
            document.querySelector('#summary .section-card').innerHTML = `
                <div class="locked-overlay">
                    <div class="locked-content">
                        <div class="locked-icon">üîí</div>
                        <h2 class="locked-title">ÊäïË≥áÂà§Êñ≠„Çµ„Éû„É™„Éº</h2>
                        <p class="locked-description">
                            Á∑èÂêàË©ï‰æ°„ÄÅ„É™„Çπ„ÇØÂàÜÊûê„ÄÅÊäïË≥á„Çπ„Ç±„Ç∏„É•„Éº„É´Á≠â„ÄÅ<br>
                            ÊúÄÁµÇÁöÑ„Å™ÊäïË≥áÂà§Êñ≠„Å´ÂøÖË¶Å„Å™ÂÖ®ÊÉÖÂ†±„ÇíÁµ±Âêà„Åó„Åü„É¨„Éù„Éº„Éà„Åß„Åô„ÄÇ
                        </p>
                        <button class="unlock-button" onclick="requestUnlock(5)">
                            ÊúÄÁµÇÊ§úË®éÊÆµÈöé„Å∏ÈÄ≤„ÇÄ
                        </button>
                    </div>
                </div>
            `;
            document.querySelector('#documents .section-card').innerHTML = `
                <div class="locked-overlay">
                    <div class="locked-content">
                        <div class="locked-icon">üîí</div>
                        <h2 class="locked-title">Â•ëÁ¥ÑÈñ¢ÈÄ£Êõ∏È°û‰∏ÄÂºè</h2>
                        <p class="locked-description">
                            ÈáçË¶Å‰∫ãÈ†ÖË™¨ÊòéÊõ∏„ÄÅÂ£≤Ë≤∑Â•ëÁ¥ÑÊõ∏Ê°à„ÄÅÁôªË®òÈñ¢ÈÄ£Êõ∏È°ûÁ≠â„ÄÅ<br>
                            Â•ëÁ¥Ñ„Å´ÂøÖË¶Å„Å™ÂÖ®„Å¶„ÅÆÊõ∏È°û„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„ÅÑ„Åü„Å†„Åë„Åæ„Åô„ÄÇ
                        </p>
                        <button class="unlock-button" onclick="requestUnlock(5)">
                            Â•ëÁ¥ÑÊ∫ñÂÇô„ÇíÈñãÂßã„Åô„Çã
                        </button>
                    </div>
                </div>
            `;
        } */

        function requestConsultation() {
            window.open('https://line.me/ti/p/@prism', '_blank');
        }

        // „É≠„Ç∞„Ç¢„Ç¶„ÉàÊ©üËÉΩ
        function logout() {
            sessionStorage.removeItem('prism_user');
            window.location.href = '/';
        }

        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„ÅÆÂá¶ÁêÜ
        document.addEventListener('DOMContentLoaded', function() {
            // „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±„ÇíË°®Á§∫
            const user = JSON.parse(sessionStorage.getItem('prism_user') || '{}');
            if (user.name) {
                document.getElementById('memberName').textContent = user.name;
            }

            // ÂàùÊúüÁä∂ÊÖãË®≠ÂÆöÔºà„Çπ„ÉÜ„Éº„Ç∏5„ÅßÂÖ®Ë≥áÊñôÈñãÊîæÔºâ
            currentStage = 5;
            updateStageIndicator();
            unlockContent();
            
            // ÁÆ°ÁêÜËÄÖ„Éë„Éç„É´„ÅÆ„Éá„Éï„Ç©„É´„ÉàË®≠ÂÆö„ÇíÊõ¥Êñ∞
            document.getElementById('customerType').value = 'closing';
            document.getElementById('currentCustomer').textContent = 'ÊàêÁ¥ÑÂâçÔºàÈ´òÊ©ãÊßòÔºâ';
            document.getElementById('currentStageInfo').textContent = '„Çπ„ÉÜ„Éº„Ç∏5';
        });

        // PDF„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊ©üËÉΩÔºàÂÆåÂÖ®Áâà„É¨„Éù„Éº„ÉàÁî®Ôºâ
        async function downloadPDF(docType = 'complete') {
            // „Éú„Çø„É≥„ÇíÂèñÂæó
            const button = event.currentTarget || event.target.closest('button');
            const originalContent = button.innerHTML;
            
            // „É≠„Éº„Éá„Ç£„É≥„Ç∞Ë°®Á§∫
            button.innerHTML = `
                <span class="material-icons" style="animation: spin 1s linear infinite; margin-right: 8px;">sync</span>
                „ÉÄ„Ç¶„É≥„É≠„Éº„Éâ‰∏≠...
            `;
            button.disabled = true;
            
            try {
                // ÂÆåÂÖ®Áâà„É¨„Éù„Éº„Éà„ÅØÁèæÂú®„Çµ„É≥„Éó„É´PDF„Çí‰ΩøÁî®
                // TODO: Â∞ÜÊù•ÁöÑ„Å´„ÇØ„É©„Ç§„Ç¢„É≥„Éà„Çµ„Ç§„Éâ„ÅßÂÆåÂÖ®Áâà„É¨„Éù„Éº„Éà„ÇíÁîüÊàê
                const link = document.createElement('a');
                link.href = '/report_sample/ÂçóÈùíÂ±±„Éó„É™„Ç∫„É†„Éì„É´_ÂÆåÂÖ®ÊäïË≥á„É¨„Éù„Éº„Éà_PRISM.pdf';
                link.download = 'ÂçóÈùíÂ±±„Éó„É™„Ç∫„É†„Éì„É´_ÂÆåÂÖ®ÊäïË≥á„É¨„Éù„Éº„Éà_PRISM.pdf';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (error) {
                console.error('PDF download error:', error);
                alert('PDF„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
            } finally {
                // „Éú„Çø„É≥„ÇíÂÖÉ„Å´Êàª„Åô
                button.innerHTML = originalContent;
                button.disabled = false;
            }
        }

        // „Çπ„ÇØ„É™„Éó„Éà„ÇíÂãïÁöÑ„Å´Ë™≠„ÅøËæº„ÇÄÈñ¢Êï∞
        function loadScript(src) {
            return new Promise((resolve, reject) => {
                if (document.querySelector(`script[src="${src}"]`)) {
                    resolve();
                    return;
                }
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }
        
        // ÂÄãÂà•Ë≥áÊñô„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊ©üËÉΩ
        async function downloadDocument(documentType) {
            const button = event.currentTarget || event.target.closest('button');
            const originalText = button.innerHTML;
            button.innerHTML = '<span class="material-icons" style="animation: spin 1s linear infinite; margin-right: 8px; font-size: 16px;">sync</span>ÁîüÊàê‰∏≠...';
            button.disabled = true;
            
            try {
                if (documentType === 'cashflow-simulation') {
                    // Next.js API„Åã„ÇâCSV„ÇíÂèñÂæó
                    const response = await fetch('/api/csv/cashflow');
                    if (!response.ok) throw new Error('Download failed');
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'Minamiaoyama_PRISM_Building_Cashflow_Simulation.csv';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                    
                    // ÊàêÂäüÈÄöÁü•
                    alert('10Âπ¥ÈñìÂèéÊîØ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÔºàCSVÔºâ„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü');
                } else {
                    // Next.js API„Åã„ÇâPDF„ÇíÂèñÂæó
                    let apiUrl;
                    let fileName;
                    let message;
                    
                    switch(documentType) {
                        case 'property-overview':
                            apiUrl = '/api/pdf/property-overview';
                            fileName = 'Minamiaoyama_PRISM_Building_Property_Overview.pdf';
                            message = 'Áâ©‰ª∂Ê¶ÇË¶ÅÊõ∏ÔºàË©≥Á¥∞ÁâàÔºâ„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü';
                            break;
                        case 'loan-simulation':
                            apiUrl = '/api/pdf/loan-proposal';
                            fileName = 'Minamiaoyama_PRISM_Building_Loan_Proposal.pdf';
                            message = 'ËûçË≥áÊèêÊ°àÊõ∏„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü';
                            break;
                        default:
                            // „Åù„ÅÆ‰ªñ„ÅÆ„Éâ„Ç≠„É•„É°„É≥„Éà„Çø„Ç§„Éó„ÅØ„Åæ„Å†„Çµ„Éù„Éº„Éà„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì
                            alert('„Åì„ÅÆ„Éâ„Ç≠„É•„É°„É≥„Éà„ÅØÊ∫ñÂÇô‰∏≠„Åß„Åô');
                            return;
                    }
                    
                    const response = await fetch(apiUrl);
                    if (!response.ok) throw new Error('Download failed');
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = fileName;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                    
                    // ÊàêÂäüÈÄöÁü•
                    alert(message);
                }
            } catch (error) {
                console.error('Download error:', error);
                alert('„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ„Åó„Å∞„Çâ„ÅèÁµå„Å£„Å¶„Åã„ÇâÂÜçÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // ‰∏ÄÊã¨„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊ©üËÉΩ
        async function downloadAllDocuments() {
            const button = event.currentTarget || event.target.closest('button');
            const originalText = button.innerHTML;
            button.innerHTML = '<span class="material-icons" style="animation: spin 1s linear infinite; margin-right: 8px; font-size: 20px;">sync</span>‰∏ÄÊã¨„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ‰∏≠...';
            button.disabled = true;
            
            const documentTypes = [
                'complete',  // PRISM‰æ°ÂÄ§Ë©ï‰æ°„É¨„Éù„Éº„Éà
                'property-overview',
                'cashflow-simulation',
                'loan-simulation'
            ];
            
            let successCount = 0;
            let failCount = 0;
            
            // „Çπ„ÇØ„É™„Éó„Éà„ÇíÂÖà„Å´Ë™≠„ÅøËæº„ÇÄ
            if (!window.PDFGenerator) {
                await loadScript('/js/pdf-generator.js');
            }
            if (!window.CSVGenerator) {
                await loadScript('/js/csv-generator.js');
            }
            await new Promise(resolve => setTimeout(resolve, 1000)); // jsPDFË™≠„ÅøËæº„ÅøÂæÖÊ©ü
            
            for (const type of documentTypes) {
                try {
                    // Â∞ë„ÅóÈÅÖÂª∂„ÇíÂÖ•„Çå„Å¶Âá¶ÁêÜ„ÇíÂàÜÊï£
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    if (type === 'complete') {
                        // PRISM‰æ°ÂÄ§Ë©ï‰æ°„É¨„Éù„Éº„Éà„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                        await downloadPDF('complete');
                        successCount++;
                    } else if (type === 'cashflow-simulation') {
                        // CSV„Ç∏„Çß„Éç„É¨„Éº„Çø„Éº„Çí‰ΩøÁî®
                        try {
                            console.log('Starting CSV generation...');
                            const csvGen = new CSVGenerator();
                            const csvContent = csvGen.generateCashflowCSV();
                            console.log('CSV content generated, downloading...');
                            csvGen.downloadCSV(csvContent, 'Minamiaoyama_PRISM_Building_Cashflow_Simulation.csv');
                            successCount++;
                            console.log('CSV download initiated successfully');
                        } catch (csvError) {
                            console.error('CSV generation/download error:', csvError);
                            throw csvError;
                        }
                    } else {
                        // PDF„Ç∏„Çß„Éç„É¨„Éº„Çø„Éº„Çí‰ΩøÁî®
                        const pdfGen = new PDFGenerator();
                        let doc;
                        let fileName;
                        
                        switch(type) {
                            case 'property-overview':
                                doc = await pdfGen.generatePropertyOverview();
                                fileName = 'Minamiaoyama_PRISM_Building_Property_Overview.pdf';
                                break;
                            case 'loan-simulation':
                                doc = await pdfGen.generateLoanProposal();
                                fileName = 'Minamiaoyama_PRISM_Building_Loan_Proposal.pdf';
                                break;
                            case 'important-matters':
                                doc = await pdfGen.generateImportantMatters();
                                fileName = 'Minamiaoyama_PRISM_Building_Important_Matters.pdf';
                                break;
                            case 'sales-contract':
                                doc = await pdfGen.generateSalesContract();
                                fileName = 'Minamiaoyama_PRISM_Building_Sales_Contract.pdf';
                                break;
                        }
                        
                        if (doc) {
                            pdfGen.downloadPDF(doc, fileName);
                            successCount++;
                        }
                    }
                } catch (error) {
                    console.error(`Failed to download ${type}:`, error);
                    failCount++;
                }
            }
            
            button.innerHTML = originalText;
            button.disabled = false;
            
            if (successCount === documentTypes.length) {
                alert(`ÂÖ®Ë≥áÊñôÔºà${successCount}„Éï„Ç°„Ç§„É´Ôºâ„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ\n\n‚Ä¢ PRISM‰æ°ÂÄ§Ë©ï‰æ°„É¨„Éù„Éº„ÉàÔºàPDFÔºâ\n‚Ä¢ Áâ©‰ª∂Ê¶ÇË¶ÅÊõ∏Ë©≥Á¥∞ÁâàÔºàPDFÔºâ\n‚Ä¢ 10Âπ¥ÈñìÂèéÊîØ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÔºàExcelÔºâ\n‚Ä¢ ËûçË≥áÊèêÊ°àÊõ∏25Âπ¥Ë®àÁîªÔºàPDFÔºâ`);
            } else if (failCount > 0) {
                alert(`‰∏ÄÈÉ®„ÅÆ„Éï„Ç°„Ç§„É´„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ\nÊàêÂäü: ${successCount}„Éï„Ç°„Ç§„É´\nÂ§±Êïó: ${failCount}„Éï„Ç°„Ç§„É´\n\nÂÜçÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ`);
            }
        }
    </script>
    
    <!-- „ÇØ„É©„Ç§„Ç¢„É≥„Éà„Çµ„Ç§„ÉâPDF/CSVÁîüÊàê„É©„Ç§„Éñ„É©„É™ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="/js/pdf-generator.js"></script>
    <script src="/js/pdf-generator-pdflib-enhanced.js"></script>
    <script src="/js/pdf-generator-financial.js"></script>
    <script src="/js/csv-generator.js"></script>
    
    <!-- Chart.js for interactive charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Japanese font support for jsPDF -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf-customfonts-support@1.0.1/dist/jspdf-plugin-addfonts.min.js"></script>
    
    <script>
        // jsPDF„ÅåË™≠„ÅøËæº„Åæ„Çå„Çã„Åæ„ÅßÂæÖÊ©ü
        // Chart.js„Çí‰ΩøÁî®„Åó„ÅüÂØæË©±Âûã„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„Éº„Ç∞„É©„Éï„ÅÆÊèèÁîª
        let cashflowChartInstance = null;
        
        function drawCashflowChart() {
            const canvas = document.getElementById('cashflowChart');
            if (!canvas || !window.Chart) {
                console.log('Canvas or Chart.js not available yet');
                return;
            }
            
            // Êó¢Â≠ò„ÅÆ„ÉÅ„É£„Éº„Éà„Åå„ÅÇ„Çå„Å∞Á†¥Ê£Ñ
            if (cashflowChartInstance) {
                cashflowChartInstance.destroy();
            }
            
            const ctx = canvas.getContext('2d');
            
            // „Éá„Éº„ÇøÊ∫ñÂÇôÔºà20Âπ¥ÂàÜÔºâ
            const years = [];
            const rentalIncome = [];  // Ë≥ÉÊñôÂèéÂÖ•
            const operatingExpenses = [];  // ÈÅãÂñ∂Ë≤ªÁî®
            const noi = [];  // NOI
            const loanRepayment = [];  // „É≠„Éº„É≥ËøîÊ∏à
            const netCF = [];  // Á¥îCF
            const cumulativeCF = [];  // Á¥ØË®àCF
            
            let cumulative = 0;
            for (let i = 1; i <= 20; i++) {
                years.push(`${i}Âπ¥`);
                
                // Ë≥ÉÊñôÂèéÂÖ•ÔºàÂπ¥0.5%‰∏äÊòáÔºâ
                const rental = Math.round(4170 * Math.pow(1.005, i - 1));
                rentalIncome.push(rental);
                
                // ÈÅãÂñ∂Ë≤ªÁî®ÔºàÂπ¥1%‰∏äÊòáÔºâ
                const operating = Math.round(813 * Math.pow(1.01, i - 1));
                operatingExpenses.push(-operating);  // „Éû„Ç§„Éä„ÇπÂÄ§„Å®„Åó„Å¶Ê†ºÁ¥ç
                
                // NOIÔºàË≥ÉÊñôÂèéÂÖ• - ÈÅãÂñ∂Ë≤ªÁî®Ôºâ
                const noiValue = rental - operating;
                noi.push(noiValue);
                
                // „É≠„Éº„É≥ËøîÊ∏àÔºàÂõ∫ÂÆöÔºâ
                const loan = -1036;  // „Éû„Ç§„Éä„ÇπÂÄ§„Å®„Åó„Å¶Ê†ºÁ¥ç
                loanRepayment.push(loan);
                
                // Á¥îCFÔºàNOI - „É≠„Éº„É≥ËøîÊ∏àÔºâ
                const netCashFlow = noiValue + loan;  // loan„ÅØÊó¢„Å´„Éû„Ç§„Éä„ÇπÂÄ§
                netCF.push(netCashFlow);
                
                // Á¥ØË®àCF
                cumulative += netCashFlow;
                cumulativeCF.push(cumulative);
            }
            
            // Chart.jsË®≠ÂÆö
            cashflowChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [
                        {
                            label: 'Ë≥ÉÊñôÂèéÂÖ•',
                            data: rentalIncome,
                            backgroundColor: 'rgba(74, 144, 226, 0.8)',
                            borderColor: 'rgba(74, 144, 226, 1)',
                            borderWidth: 1,
                            yAxisID: 'y-left',
                            order: 6,
                            stack: 'stack1'
                        },
                        {
                            label: 'ÈÅãÂñ∂Ë≤ªÁî®',
                            data: operatingExpenses,
                            backgroundColor: 'rgba(245, 101, 101, 0.8)',
                            borderColor: 'rgba(245, 101, 101, 1)',
                            borderWidth: 1,
                            yAxisID: 'y-left',
                            order: 5,
                            stack: 'stack1'
                        },
                        {
                            label: 'NOI',
                            data: noi,
                            type: 'line',
                            borderColor: 'rgba(72, 187, 120, 1)',
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            pointRadius: 3,
                            pointHoverRadius: 5,
                            pointBackgroundColor: 'rgba(72, 187, 120, 1)',
                            yAxisID: 'y-left',
                            order: 3
                        },
                        {
                            label: '„É≠„Éº„É≥ËøîÊ∏à',
                            data: loanRepayment,
                            backgroundColor: 'rgba(255, 159, 64, 0.8)',
                            borderColor: 'rgba(255, 159, 64, 1)',
                            borderWidth: 1,
                            yAxisID: 'y-left',
                            order: 4,
                            stack: 'stack2'
                        },
                        {
                            label: 'Á¥îCF',
                            data: netCF,
                            type: 'line',
                            borderColor: 'rgba(153, 102, 255, 1)',
                            backgroundColor: 'transparent',
                            borderWidth: 3,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            pointBackgroundColor: 'rgba(153, 102, 255, 1)',
                            yAxisID: 'y-left',
                            order: 2
                        },
                        {
                            label: 'Á¥ØË®àCF',
                            data: cumulativeCF,
                            type: 'line',
                            borderColor: 'rgba(233, 75, 60, 1)',
                            backgroundColor: 'rgba(233, 75, 60, 0.1)',
                            borderWidth: 3,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            pointBackgroundColor: '#fff',
                            pointBorderColor: 'rgba(233, 75, 60, 1)',
                            pointBorderWidth: 2,
                            tension: 0.1,
                            yAxisID: 'y-right',
                            order: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: '20Âπ¥Èñì„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„ÉºÊé®Áßª',
                            font: {
                                size: 16,
                                weight: 'bold'
                            },
                            padding: 20
                        },
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 15,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            padding: 12,
                            displayColors: true,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    
                                    // ÂÄ§„ÅÆË°®Á§∫Ôºà„Éó„É©„Çπ„Éû„Ç§„Éä„Çπ„ÇÇÂê´„ÇÄÔºâ
                                    const value = context.parsed.y;
                                    if (value >= 0) {
                                        label += '+' + value.toLocaleString() + '‰∏áÂÜÜ';
                                    } else {
                                        label += value.toLocaleString() + '‰∏áÂÜÜ';
                                    }
                                    
                                    // Á¥ØË®àCF„ÅÆÂ†¥Âêà„ÅØROI„ÇÇË°®Á§∫
                                    if (context.dataset.label === 'Á¥ØË®àCF') {
                                        const roi = (value / 38500 * 100).toFixed(1);
                                        label += ` (ROI: ${roi}%)`;
                                    }
                                    
                                    // NOI„ÅÆÂ†¥Âêà„ÅØÂà©Âõû„Çä„ÇÇË°®Á§∫
                                    if (context.dataset.label === 'NOI') {
                                        const yield_rate = (value * 12 / 38500 * 100).toFixed(2);
                                        label += ` (Âà©Âõû„Çä: ${yield_rate}%)`;
                                    }
                                    
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                autoSkip: true,
                                maxTicksLimit: 10,
                                font: {
                                    size: 11
                                }
                            }
                        },
                        'y-left': {
                            type: 'linear',
                            position: 'left',
                            title: {
                                display: true,
                                text: '„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„ÉºÔºà‰∏áÂÜÜÔºâ',
                                font: {
                                    size: 12
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                font: {
                                    size: 11
                                },
                                callback: function(value) {
                                    if (value >= 0) {
                                        return '+' + value.toLocaleString();
                                    } else {
                                        return value.toLocaleString();
                                    }
                                }
                            }
                        },
                        'y-right': {
                            type: 'linear',
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Á¥ØË®à„Ç≠„É£„ÉÉ„Ç∑„É•„Éï„É≠„ÉºÔºà‰∏áÂÜÜÔºâ',
                                font: {
                                    size: 12
                                }
                            },
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 11
                                },
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        window.addEventListener('DOMContentLoaded', async function() {
            // „Ç∞„É©„Éï„ÇíÊèèÁîª
            setTimeout(drawCashflowChart, 100);
            // PDF/CSVÁîüÊàê„Ç§„É≥„Çπ„Çø„É≥„Çπ„ÇíÂàùÊúüÂåñ
            let pdfGenerator;
            let csvGenerator;
            try {
                if (typeof PDFGenerator !== 'undefined') {
                    pdfGenerator = new PDFGenerator();
                    console.log('PDFGenerator initialized');
                } else {
                    console.error('PDFGenerator is not defined');
                }
                
                if (typeof CSVGenerator !== 'undefined') {
                    csvGenerator = new CSVGenerator();
                    console.log('CSVGenerator initialized');
                } else {
                    console.error('CSVGenerator is not defined');
                }
                
                if (pdfGenerator && typeof pdfGenerator.loadJsPDF === 'function') {
                    await pdfGenerator.loadJsPDF();
                    console.log('PDF library loaded');
                }
                console.log('Generators initialized');
            } catch (error) {
                console.error('Generator initialization failed:', error);
            }
        
        // downloadDocumentÈñ¢Êï∞„ÇíÂÜçÂÆöÁæ©ÔºàÊó¢Â≠ò„ÅÆÈñ¢Êï∞„Çí‰∏äÊõ∏„ÅçÔºâ
        async function downloadDocument(documentType) {
            const button = event.currentTarget || event.target.closest('button');
            const originalText = button.innerHTML;
            button.innerHTML = '<span class="material-icons" style="animation: spin 1s linear infinite; margin-right: 8px; font-size: 16px;">sync</span>ÁîüÊàê‰∏≠...';
            button.disabled = true;
            
            try {
                let doc;
                let filename;
                
                // „Éâ„Ç≠„É•„É°„É≥„Éà„Çø„Ç§„Éó„Å´Âøú„Åò„Å¶PDF„ÇíÁîüÊàê
                switch(documentType) {
                    case 'property-overview':
                        // pdf-lib„Éê„Éº„Ç∏„Éß„É≥„Çí‰ΩøÁî®ÔºàÊó•Êú¨Ë™ûÂØæÂøú„ÉªÊã°ÂºµÁâàÔºâ
                        const pdfLibGenerator = new PDFGeneratorPdfLibEnhanced();
                        await pdfLibGenerator.generatePropertyOverview();
                        // pdf-lib„ÅØÂÜÖÈÉ®„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂá¶ÁêÜ„ÇíË°å„ÅÜ„ÅÆ„Åß„Åì„Åì„ÅßÁµÇ‰∫Ü
                        button.innerHTML = originalText;
                        button.disabled = false;
                        return;
                    case 'financial-simulation-pdf':
                        // ÂèéÊîØ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥PDFÔºàpdf-libÁâàÔºâ„ÇíÁîüÊàê
                        const financialGenerator = new PDFGeneratorFinancial();
                        await financialGenerator.generateFinancialSimulation();
                        // pdf-lib„ÅØÂÜÖÈÉ®„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂá¶ÁêÜ„ÇíË°å„ÅÜ„ÅÆ„Åß„Åì„Åì„ÅßÁµÇ‰∫Ü
                        button.innerHTML = originalText;
                        button.disabled = false;
                        return;
                    case 'loan-simulation':
                        doc = await pdfGenerator.generateLoanProposal();
                        filename = 'Minamiaoyama_PRISM_Building_Loan_Proposal.pdf';
                        break;
                    case 'important-matters':
                        doc = await pdfGenerator.generateImportantMatters();
                        filename = 'Minamiaoyama_PRISM_Building_Important_Matters.pdf';
                        break;
                    case 'sales-contract':
                        doc = await pdfGenerator.generateSalesContract();
                        filename = 'Minamiaoyama_PRISM_Building_Sales_Contract.pdf';
                        break;
                    case 'cashflow-simulation':
                        // CSV„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÔºà„ÇØ„É©„Ç§„Ç¢„É≥„Éà„Çµ„Ç§„ÉâÁîüÊàêÔºâ
                        try {
                            if (!csvGenerator) {
                                console.error('CSVGenerator not initialized');
                                throw new Error('CSVÁîüÊàêÊ©üËÉΩ„ÅåÂàùÊúüÂåñ„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
                            }
                            console.log('Starting CSV generation...');
                            const csvContent = csvGenerator.generateCashflowCSV();
                            console.log('CSV content generated, downloading...');
                            csvGenerator.downloadCSV(csvContent, 'Minamiaoyama_PRISM_Building_Cashflow_Simulation.csv');
                            console.log('CSV download initiated successfully');
                        } catch (csvError) {
                            console.error('CSV generation/download error:', csvError);
                            throw csvError;
                        }
                        break;
                    default:
                        throw new Error('Unknown document type');
                }
                
                // PDF„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                if (doc) {
                    pdfGenerator.downloadPDF(doc, filename);
                }
                
                // ÊàêÂäüÈÄöÁü•
                const messages = {
                    'property-overview': 'Áâ©‰ª∂Ê¶ÇË¶ÅÊõ∏„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü',
                    'cashflow-simulation': 'ÂèéÊîØ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÔºàCSVÔºâ„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü',
                    'loan-simulation': 'ËûçË≥áÊèêÊ°àÊõ∏„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü',
                    'important-matters': 'ÈáçË¶Å‰∫ãÈ†ÖË™¨ÊòéÊõ∏„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü',
                    'sales-contract': 'Â£≤Ë≤∑Â•ëÁ¥ÑÊõ∏„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü'
                };
                
                setTimeout(() => {
                    alert(messages[documentType] || '„Éâ„Ç≠„É•„É°„É≥„Éà„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü');
                }, 100);
                
            } catch (error) {
                console.error('Generate error:', error);
                alert('„Éâ„Ç≠„É•„É°„É≥„ÉàÁîüÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }
            
            // „Ç∞„É≠„Éº„Éê„É´„Å´Èñ¢Êï∞„ÇíÂÖ¨Èñã
            window.downloadDocument = downloadDocument;
        });
    </script>
</body>
</html>