<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRISM - æŠ•è³‡å®¶å‘ã‘æ®µéšçš„ææ¡ˆã‚·ã‚¹ãƒ†ãƒ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', 'Yu Gothic', sans-serif;
            background: #f5f7fa;
            color: #2d3748;
            line-height: 1.5;
        }

        .header {
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            color: white;
            padding: 40px 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .header h1 {
            font-size: 2.8em;
            letter-spacing: 0.2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            color: #e2e8f0;
            letter-spacing: 0.05em;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .stage-indicator {
            background: white;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border-top: 3px solid #3182ce;
        }

        .stage-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .stage-item {
            flex: 1;
            text-align: center;
            position: relative;
            padding: 10px;
        }

        .stage-item:not(:last-child):after {
            content: '';
            position: absolute;
            top: 35px;
            right: -50%;
            width: 100%;
            height: 2px;
            background: #e2e8f0;
            z-index: 0;
        }

        .stage-item.completed:not(:last-child):after {
            background: #38a169;
        }

        .stage-circle {
            width: 60px;
            height: 60px;
            background: #e2e8f0;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.3em;
            color: #a0aec0;
            position: relative;
            z-index: 1;
        }

        .stage-item.completed .stage-circle {
            background: #38a169;
            color: white;
        }

        .stage-item.current .stage-circle {
            background: #3182ce;
            color: white;
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.2);
        }

        .stage-label {
            font-size: 0.875rem;
            color: #4a5568;
            font-weight: 600;
        }

        .stage-item.completed .stage-label {
            color: #38a169;
        }

        .stage-item.current .stage-label {
            color: #3182ce;
        }

        .nav-tabs {
            display: flex;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            overflow-x: auto;
            margin-bottom: 30px;
        }

        .nav-tab {
            padding: 20px 30px;
            background: white;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 600;
            color: #4a5568;
            white-space: nowrap;
            transition: all 0.2s ease;
            flex-shrink: 0;
            position: relative;
        }

        .nav-tab.locked {
            background: #f7fafc;
            color: #cbd5e0;
            cursor: not-allowed;
            position: relative;
        }

        .nav-tab.locked:after {
            content: 'ğŸ”’';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
        }

        .nav-tab:not(.locked):hover {
            background: #f7fafc;
        }

        .nav-tab.active {
            color: #1a365d;
            border-bottom: 3px solid #3182ce;
            background: #eff6ff;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-card {
            background: white;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border-top: 3px solid #3182ce;
        }

        .locked-overlay {
            position: relative;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #f7fafc 0%, #e2e8f0 100%);
            border: 2px dashed #cbd5e0;
        }

        .locked-content {
            text-align: center;
            padding: 40px;
        }

        .locked-icon {
            font-size: 4em;
            color: #cbd5e0;
            margin-bottom: 20px;
        }

        .locked-title {
            font-size: 1.5em;
            color: #4a5568;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .locked-description {
            color: #718096;
            margin-bottom: 20px;
        }

        .unlock-button {
            background: linear-gradient(to bottom, #3182ce, #2563eb);
            color: white;
            padding: 12px 30px;
            border: none;
            font-weight: 600;
            letter-spacing: 0.03em;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-block;
            text-decoration: none;
        }

        .unlock-button:hover {
            background: #2563eb;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .section-title {
            color: #1a365d;
            font-size: 1.9em;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
            font-weight: 600;
        }

        .subsection-title {
            color: #1a365d;
            font-size: 1.5em;
            margin: 25px 0 15px;
            font-weight: 600;
            border-left: 4px solid #3182ce;
            padding-left: 15px;
        }

        .property-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .info-box {
            background: #f7fafc;
            padding: 20px;
            border-left: 4px solid #3182ce;
        }

        .info-box h4 {
            color: #1a365d;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .info-box p {
            color: #4a5568;
            margin: 5px 0;
        }

        .highlight-number {
            font-size: 2.5em;
            color: #1a365d;
            font-weight: 700;
            display: block;
            margin: 10px 0;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .kpi-card {
            background: white;
            padding: 25px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border-top: 3px solid #3182ce;
        }

        .kpi-label {
            color: #718096;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
            margin-bottom: 10px;
        }

        .kpi-value {
            color: #1a365d;
            font-size: 2.5em;
            font-weight: 700;
        }

        .kpi-unit {
            color: #4a5568;
            font-size: 0.875rem;
            margin-top: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin: 20px 0;
        }

        thead {
            background: linear-gradient(to bottom, #edf2f7, #e2e8f0);
        }

        th {
            color: #2d3748;
            font-weight: 600;
            text-align: left;
            padding: 15px;
            border-bottom: 2px solid #cbd5e0;
            letter-spacing: 0.03em;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
            color: #4a5568;
        }

        tr:hover {
            background: #f7fafc;
            transition: background 0.2s;
        }

        .btn-primary {
            background: linear-gradient(to bottom, #3182ce, #2563eb);
            color: white;
            padding: 12px 30px;
            border: none;
            font-weight: 600;
            letter-spacing: 0.03em;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-block;
            text-decoration: none;
            margin: 10px 5px;
        }

        .btn-primary:hover {
            background: #2563eb;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .warning-box {
            background: #fef5e7;
            border-left: 4px solid #f9c74f;
            padding: 20px;
            margin: 20px 0;
        }

        .warning-box h4 {
            color: #d68910;
            margin-bottom: 10px;
        }

        .success-box {
            background: #e6fffa;
            border-left: 4px solid #38a169;
            padding: 20px;
            margin: 20px 0;
        }

        .checklist {
            list-style: none;
            padding-left: 0;
        }

        .checklist li {
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
            position: relative;
            padding-left: 35px;
        }

        .checklist li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #38a169;
            font-weight: bold;
            font-size: 1.2em;
        }

        .stage-description {
            background: #eff6ff;
            padding: 20px;
            margin-top: 20px;
        }

        .stage-description h3 {
            color: #1a365d;
            margin-bottom: 10px;
        }

        .action-buttons {
            text-align: center;
            padding: 30px;
            background: #f7fafc;
            margin-top: 30px;
        }

        .footer {
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            color: white;
            padding: 40px 20px 20px;
            margin-top: 50px;
            text-align: center;
        }

        .footer p {
            color: #e2e8f0;
        }

        /* ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ãƒ¢ãƒ¼ãƒ€ãƒ« */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            overflow: auto;
        }

        .modal.active {
            display: block;
        }

        .modal-content {
            background: white;
            margin: 20px auto;
            width: 90%;
            max-width: 1200px;
            box-shadow: 0 12px 35px rgba(0,0,0,0.15);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            color: white;
            padding: 25px 30px;
            position: relative;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.8em;
            letter-spacing: 0.05em;
        }

        .modal-close {
            position: absolute;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 28px;
            color: white;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .modal-close:hover {
            opacity: 0.8;
        }

        .modal-body {
            padding: 30px;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
        }

        .simulation-form {
            display: grid;
            gap: 25px;
        }

        .form-section {
            background: #f7fafc;
            padding: 20px;
            border-left: 4px solid #3182ce;
        }

        .form-section-title {
            color: #1a365d;
            font-size: 1.3em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            color: #4a5568;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: 0.03em;
        }

        .form-input {
            border: 1px solid #cbd5e0;
            padding: 10px 15px;
            font-size: 1rem;
            color: #2d3748;
            background: white;
            transition: all 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: #3182ce;
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
        }

        .input-group {
            display: flex;
            align-items: center;
        }

        .input-suffix {
            background: #e2e8f0;
            padding: 10px 15px;
            border: 1px solid #cbd5e0;
            border-left: none;
            color: #4a5568;
            font-size: 0.875rem;
        }

        .simulation-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            padding: 20px;
            background: #f7fafc;
            border-top: 2px solid #e2e8f0;
        }

        .btn-calculate {
            background: linear-gradient(to bottom, #38a169, #2f855a);
            color: white;
            padding: 14px 35px;
            border: none;
            font-weight: 600;
            font-size: 1.1em;
            letter-spacing: 0.03em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-calculate:hover {
            background: #2f855a;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .btn-reset {
            background: #e2e8f0;
            color: #4a5568;
            padding: 14px 35px;
            border: none;
            font-weight: 600;
            letter-spacing: 0.03em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-reset:hover {
            background: #cbd5e0;
        }

        .simulation-results {
            display: none;
            margin-top: 30px;
            border-top: 3px solid #3182ce;
            background: white;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .results-header {
            background: linear-gradient(135deg, #eff6ff 0%, white 100%);
            padding: 20px;
            margin: -30px -30px 25px;
            border-bottom: 2px solid #e2e8f0;
        }

        .results-header h3 {
            color: #1a365d;
            margin: 0 0 10px;
            font-size: 1.5em;
        }

        .results-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background: #f7fafc;
            padding: 20px;
            text-align: center;
            border-top: 3px solid #3182ce;
        }

        .result-label {
            color: #718096;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
            margin-bottom: 10px;
        }

        .result-value {
            color: #1a365d;
            font-size: 2em;
            font-weight: 700;
        }

        .result-unit {
            color: #4a5568;
            font-size: 0.875rem;
            margin-top: 5px;
        }

        .cashflow-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            margin-top: 20px;
        }

        .cashflow-table thead {
            background: linear-gradient(to bottom, #edf2f7, #e2e8f0);
        }

        .cashflow-table th {
            color: #2d3748;
            font-weight: 600;
            text-align: left;
            padding: 15px;
            border-bottom: 2px solid #cbd5e0;
            letter-spacing: 0.03em;
        }

        .cashflow-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
            color: #4a5568;
        }

        .cashflow-table tr:hover {
            background: #f7fafc;
            transition: background 0.2s;
        }

        .result-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            
            .container {
                padding: 10px;
            }
            
            .section-card {
                padding: 20px;
            }

            .stage-progress {
                flex-direction: column;
            }

            .stage-item:not(:last-child):after {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>PRISM</h1>
        <p>Private Real-estate Investment Smart Matching</p>
        <p style="margin-top: 10px;">æŠ•è³‡å®¶æ§˜å‘ã‘ æ®µéšçš„ç‰©ä»¶ææ¡ˆã‚·ã‚¹ãƒ†ãƒ </p>
        <button id="adminToggle" onclick="toggleAdminMode()" style="position: absolute; top: 20px; right: 20px; background: rgba(255, 255, 255, 0.2); color: white; border: 1px solid rgba(255, 255, 255, 0.5); padding: 10px 20px; cursor: pointer; border-radius: 5px; font-weight: 600;">ğŸ”§ ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰</button>
    </div>

    <!-- ç®¡ç†è€…ãƒ‘ãƒãƒ« -->
    <div id="adminPanel" style="display: none; position: fixed; top: 80px; right: 20px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); width: 320px; z-index: 1000; max-height: 80vh; overflow-y: auto;">
        <h3 style="margin-bottom: 15px; color: #1a365d;">ğŸ”§ ç®¡ç†è€…ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</h3>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #4a5568;">é¡§å®¢ã‚¿ã‚¤ãƒ—é¸æŠ</label>
            <select id="customerType" onchange="changeCustomerType()" style="width: 100%; padding: 8px; border: 1px solid #cbd5e0; border-radius: 5px;">
                <option value="new">æ–°è¦é¡§å®¢ï¼ˆç”°ä¸­æ§˜ï¼‰- ã‚¹ãƒ†ãƒ¼ã‚¸1</option>
                <option value="interested" selected>é–¢å¿ƒé¡§å®¢ï¼ˆéˆ´æœ¨æ§˜ï¼‰- ã‚¹ãƒ†ãƒ¼ã‚¸2</option>
                <option value="serious">æœ¬æ ¼æ¤œè¨ï¼ˆå±±ç”°æ§˜ï¼‰- ã‚¹ãƒ†ãƒ¼ã‚¸3</option>
                <option value="negotiating">å•†è«‡ä¸­ï¼ˆä½è—¤æ§˜ï¼‰- ã‚¹ãƒ†ãƒ¼ã‚¸4</option>
                <option value="closing">æˆç´„å‰ï¼ˆé«˜æ©‹æ§˜ï¼‰- ã‚¹ãƒ†ãƒ¼ã‚¸5</option>
            </select>
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #4a5568;">ã‚¹ãƒ†ãƒ¼ã‚¸ç›´æ¥æŒ‡å®š</label>
            <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                <button class="stage-btn" onclick="setStage(1)" style="padding: 8px 16px; border: 1px solid #cbd5e0; background: white; cursor: pointer; border-radius: 5px;">S1</button>
                <button class="stage-btn active" onclick="setStage(2)" style="padding: 8px 16px; border: 1px solid #cbd5e0; background: white; cursor: pointer; border-radius: 5px;">S2</button>
                <button class="stage-btn" onclick="setStage(3)" style="padding: 8px 16px; border: 1px solid #cbd5e0; background: white; cursor: pointer; border-radius: 5px;">S3</button>
                <button class="stage-btn" onclick="setStage(4)" style="padding: 8px 16px; border: 1px solid #cbd5e0; background: white; cursor: pointer; border-radius: 5px;">S4</button>
                <button class="stage-btn" onclick="setStage(5)" style="padding: 8px 16px; border: 1px solid #cbd5e0; background: white; cursor: pointer; border-radius: 5px;">S5</button>
            </div>
        </div>
        
        <div style="margin-bottom: 20px; padding: 15px; background: #f7fafc; border-radius: 5px;">
            <p style="margin-bottom: 5px;"><strong>ç¾åœ¨ã®çŠ¶æ…‹ï¼š</strong></p>
            <p style="margin: 2px 0;">é¡§å®¢: <span id="currentCustomer">é–¢å¿ƒé¡§å®¢ï¼ˆéˆ´æœ¨æ§˜ï¼‰</span></p>
            <p style="margin: 2px 0;">ã‚¹ãƒ†ãƒ¼ã‚¸: <span id="currentStageInfo">ã‚¹ãƒ†ãƒ¼ã‚¸2</span></p>
        </div>
        
        <div style="display: flex; flex-direction: column; gap: 10px;">
            <button onclick="unlockAll()" style="padding: 10px; background: #38a169; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 600;">ğŸ”“ å…¨è³‡æ–™ã‚¢ãƒ³ãƒ­ãƒƒã‚¯</button>
            <button onclick="resetAll()" style="padding: 10px; background: #e53e3e; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 600;">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
            <button onclick="showAnalytics()" style="padding: 10px; background: #3182ce; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 600;">ğŸ“Š ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹</button>
        </div>
        
        <div id="adminStats" style="display: none; margin-top: 20px; padding: 15px; background: #eff6ff; border-radius: 5px;">
            <h4 style="margin-bottom: 10px; color: #1a365d;">æœ¬æ—¥ã®çµ±è¨ˆ</h4>
            <p style="margin: 5px 0; font-size: 0.9em;">ã‚¢ã‚¯ã‚»ã‚¹æ•°: 127</p>
            <p style="margin: 5px 0; font-size: 0.9em;">ã‚¹ãƒ†ãƒ¼ã‚¸é€²è¡Œ: 8ä»¶</p>
            <p style="margin: 5px 0; font-size: 0.9em;">è³‡æ–™DL: 23ä»¶</p>
            <p style="margin: 5px 0; font-size: 0.9em;">å•åˆã›: 5ä»¶</p>
        </div>
    </div>

    <div class="container">
        <!-- ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ -->
        <div class="stage-indicator">
            <h2 style="color: #1a365d; margin-bottom: 20px;">ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¸</h2>
            <div class="stage-progress">
                <div class="stage-item completed" id="stage1">
                    <div class="stage-circle">1</div>
                    <div class="stage-label">åˆå›æ¥è§¦</div>
                </div>
                <div class="stage-item current" id="stage2">
                    <div class="stage-circle">2</div>
                    <div class="stage-label">é–¢å¿ƒè¡¨æ˜</div>
                </div>
                <div class="stage-item" id="stage3">
                    <div class="stage-circle">3</div>
                    <div class="stage-label">è©³ç´°æ¤œè¨</div>
                </div>
                <div class="stage-item" id="stage4">
                    <div class="stage-circle">4</div>
                    <div class="stage-label">å•†è«‡</div>
                </div>
                <div class="stage-item" id="stage5">
                    <div class="stage-circle">5</div>
                    <div class="stage-label">æœ€çµ‚ç¢ºèª</div>
                </div>
            </div>
            <div class="stage-description">
                <h3>ã‚¹ãƒ†ãƒ¼ã‚¸2ï¼šé–¢å¿ƒè¡¨æ˜</h3>
                <p>ç‰©ä»¶æ¦‚è¦ã‚’ã”ç¢ºèªã„ãŸã ãã€ã‚ˆã‚Šè©³ç´°ãªåç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã”è¦§ã„ãŸã ã‘ã‚‹æ®µéšã§ã™ã€‚</p>
                <p style="margin-top: 10px;"><strong>ã‚¢ãƒ³ãƒ­ãƒƒã‚¯æ¸ˆã¿ï¼š</strong>ç‰©ä»¶æ¦‚è¦ã€åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</p>
                <p><strong>æ¬¡ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã§é–‹ç¤ºï¼š</strong>ä¾¡æ ¼æŸ»å®šåˆ†æã€èè³‡è¨ˆç”»è©³ç´°</p>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview', 1)">1. ç‰©ä»¶æ¦‚è¦</button>
            <button class="nav-tab" onclick="showTab('simulation', 2)">2. åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
            <button class="nav-tab locked" onclick="showLockedMessage(3)">3. ä¾¡æ ¼æŸ»å®š</button>
            <button class="nav-tab locked" onclick="showLockedMessage(4)">4. èè³‡è¨ˆç”»</button>
            <button class="nav-tab locked" onclick="showLockedMessage(5)">5. æŠ•è³‡åˆ¤æ–­ã‚µãƒãƒªãƒ¼</button>
            <button class="nav-tab locked" onclick="showLockedMessage(5)">6. å¿…è¦æ›¸é¡ä¸€å¼</button>
        </div>

        <!-- 1. ç‰©ä»¶æ¦‚è¦ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸1ã§é–‹ç¤ºï¼‰ -->
        <div id="overview" class="tab-content active">
            <div class="section-card">
                <h2 class="section-title">1. ç‰©ä»¶æ¦‚è¦ãƒ»ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ†æ</h2>
                
                <h3 class="subsection-title">åŸºæœ¬æƒ…å ±</h3>
                <div class="property-overview">
                    <div class="info-box">
                        <h4>ç‰©ä»¶åç§°</h4>
                        <p>PRISMå—é’å±±ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¬ã‚¸ãƒ‡ãƒ³ã‚¹</p>
                        <p>æ±äº¬éƒ½æ¸¯åŒºå—é’å±±5-12-8</p>
                    </div>
                    <div class="info-box">
                        <h4>ç‰©ä»¶ã‚¿ã‚¤ãƒ—</h4>
                        <p>RCé€  ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã‚ºãƒãƒ³ã‚·ãƒ§ãƒ³</p>
                        <p>ç¯‰å¹´æœˆï¼š2020å¹´3æœˆç«£å·¥</p>
                    </div>
                    <div class="info-box">
                        <h4>ç‰©ä»¶ä¾¡æ ¼</h4>
                        <span class="highlight-number">6.8å„„å††</span>
                        <p>è¡¨é¢åˆ©å›ã‚Šï¼š6.35%</p>
                    </div>
                </div>

                <h3 class="subsection-title">ç«‹åœ°è©•ä¾¡</h3>
                <table>
                    <thead>
                        <tr>
                            <th>è©•ä¾¡é …ç›®</th>
                            <th>å†…å®¹</th>
                            <th>ã‚¹ã‚³ã‚¢</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>æœ€å¯„é§…</td>
                            <td>æ±äº¬ãƒ¡ãƒˆãƒ­ã€Œè¡¨å‚é“ã€é§… å¾’æ­©6åˆ† / ã€Œæ¸‹è°·ã€é§… å¾’æ­©12åˆ†</td>
                            <td>â˜…â˜…â˜…â˜…â˜…</td>
                        </tr>
                        <tr>
                            <td>éƒ½å¿ƒã‚¢ã‚¯ã‚»ã‚¹</td>
                            <td>éŠ€åº§ç·šãƒ»åŠè”µé–€ç·šãƒ»åƒä»£ç”°ç·šåˆ©ç”¨å¯ã€ä¸»è¦é§…ç›´é€š</td>
                            <td>â˜…â˜…â˜…â˜…â˜…</td>
                        </tr>
                        <tr>
                            <td>å‘¨è¾ºç’°å¢ƒ</td>
                            <td>é’å±±é€šã‚Šæ²¿ã„ã€é«˜ç´šãƒ–ãƒ©ãƒ³ãƒ‰åº—ãƒ»é£²é£Ÿåº—é›†ç©ã‚¨ãƒªã‚¢</td>
                            <td>â˜…â˜…â˜…â˜…â˜…</td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="subsection-title">è¿‘éš£è³ƒè²¸å¸‚å ´åˆ†æ</h3>
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-label">ã‚¨ãƒªã‚¢å¹³å‡è³ƒæ–™</div>
                        <div class="kpi-value">28.5</div>
                        <div class="kpi-unit">ä¸‡å††/æœˆï¼ˆ1LDKï¼‰</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">ç©ºå®¤ç‡</div>
                        <div class="kpi-value">2.8</div>
                        <div class="kpi-unit">%ï¼ˆæ¸¯åŒºå¹³å‡ï¼‰</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">ç«¶åˆç‰©ä»¶æ•°</div>
                        <div class="kpi-value">8</div>
                        <div class="kpi-unit">æ£Ÿï¼ˆåŠå¾„500mï¼‰</div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn-primary" onclick="advanceStage()">è©³ç´°æƒ…å ±ã‚’å¸Œæœ›ã™ã‚‹</button>
                    <button class="btn-primary" onclick="alert('æ‹…å½“è€…ã¸é€£çµ¡')">è³ªå•ã™ã‚‹</button>
                </div>
            </div>
        </div>

        <!-- 2. åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸2ã§é–‹ç¤ºï¼‰ -->
        <div id="simulation" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">2. æŠ•è³‡åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
                
                <h3 class="subsection-title">æŠ•è³‡æ¦‚è¦</h3>
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-label">ç‰©ä»¶ä¾¡æ ¼</div>
                        <div class="kpi-value">6.8</div>
                        <div class="kpi-unit">å„„å††</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">æƒ³å®šå¹´é–“è³ƒæ–™</div>
                        <div class="kpi-value">4,320</div>
                        <div class="kpi-unit">ä¸‡å††</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">è¡¨é¢åˆ©å›ã‚Š</div>
                        <div class="kpi-value">6.35</div>
                        <div class="kpi-unit">%</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">å®Ÿè³ªåˆ©å›ã‚Š</div>
                        <div class="kpi-value">5.28</div>
                        <div class="kpi-unit">%</div>
                    </div>
                </div>

                <h3 class="subsection-title">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼äºˆæ¸¬ï¼ˆå¹´é–“ï¼‰</h3>
                <table>
                    <thead>
                        <tr>
                            <th>é …ç›®</th>
                            <th>1å¹´ç›®</th>
                            <th>5å¹´ç›®</th>
                            <th>10å¹´ç›®</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>è³ƒæ–™åå…¥</td>
                            <td style="text-align: right;">4,320ä¸‡å††</td>
                            <td style="text-align: right;">4,320ä¸‡å††</td>
                            <td style="text-align: right;">4,200ä¸‡å††</td>
                        </tr>
                        <tr>
                            <td>ç®¡ç†è²»ãƒ»ä¿®ç¹•è²»</td>
                            <td style="text-align: right;">-432ä¸‡å††</td>
                            <td style="text-align: right;">-450ä¸‡å††</td>
                            <td style="text-align: right;">-480ä¸‡å††</td>
                        </tr>
                        <tr>
                            <td>ãƒ­ãƒ¼ãƒ³è¿”æ¸ˆï¼ˆæƒ³å®šï¼‰</td>
                            <td style="text-align: right;">-2,040ä¸‡å††</td>
                            <td style="text-align: right;">-2,040ä¸‡å††</td>
                            <td style="text-align: right;">-2,040ä¸‡å††</td>
                        </tr>
                        <tr style="background: #eff6ff;">
                            <td><strong>ç´”åç›Šï¼ˆç¨å‰ï¼‰</strong></td>
                            <td style="text-align: right; font-weight: bold; color: #1a365d;">1,662ä¸‡å††</td>
                            <td style="text-align: right; font-weight: bold; color: #1a365d;">1,650ä¸‡å††</td>
                            <td style="text-align: right; font-weight: bold; color: #1a365d;">1,505ä¸‡å††</td>
                        </tr>
                    </tbody>
                </table>

                <div class="action-buttons">
                    <button class="btn-primary" onclick="advanceStage()">ä¾¡æ ¼æŸ»å®šã‚’ç¢ºèªã™ã‚‹</button>
                    <button class="btn-primary" onclick="openCustomSimulation()">ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
                </div>
            </div>
        </div>

        <!-- 3. ä¾¡æ ¼æŸ»å®šï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸3ã§é–‹ç¤ºï¼‰ -->
        <div id="valuation" class="tab-content">
            <div class="section-card">
                <div class="locked-overlay">
                    <div class="locked-content">
                        <div class="locked-icon">ğŸ”’</div>
                        <h2 class="locked-title">ä¾¡æ ¼æŸ»å®šåˆ†æ</h2>
                        <p class="locked-description">
                            PRISMç‹¬è‡ªã®3æ‰‹æ³•ã«ã‚ˆã‚‹è©³ç´°ãªä¾¡æ ¼æŸ»å®šåˆ†æã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™ã€‚<br>
                            ã‚¨ãƒªã‚¢ç›¸å ´ã¨ã®æ¯”è¼ƒã€æŠ•è³‡å¦¥å½“æ€§ã®åˆ¤å®šçµæœã‚’å«ã¿ã¾ã™ã€‚
                        </p>
                        <button class="unlock-button" onclick="requestUnlock(3)">
                            ã‚¢ãƒ³ãƒ­ãƒƒã‚¯ã‚’ç”³è«‹ã™ã‚‹
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. èè³‡è¨ˆç”»ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸4ã§é–‹ç¤ºï¼‰ -->
        <div id="finance" class="tab-content">
            <div class="section-card">
                <div class="locked-overlay">
                    <div class="locked-content">
                        <div class="locked-icon">ğŸ”’</div>
                        <h2 class="locked-title">èè³‡è¨ˆç”»è©³ç´°</h2>
                        <p class="locked-description">
                            ææºé‡‘èæ©Ÿé–¢ã®èè³‡æ¡ä»¶ã€å¿…è¦å±æ€§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€<br>
                            éŠ€è¡Œè©•ä¾¡é¡äºˆæ¸¬ãªã©ã€èè³‡å®Ÿç¾ã«å‘ã‘ãŸè©³ç´°æƒ…å ±ã‚’ã”æä¾›ã—ã¾ã™ã€‚
                        </p>
                        <button class="unlock-button" onclick="requestUnlock(4)">
                            å•†è«‡ã‚’ç”³ã—è¾¼ã‚€
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 5. æŠ•è³‡åˆ¤æ–­ã‚µãƒãƒªãƒ¼ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸5ã§é–‹ç¤ºï¼‰ -->
        <div id="summary" class="tab-content">
            <div class="section-card">
                <div class="locked-overlay">
                    <div class="locked-content">
                        <div class="locked-icon">ğŸ”’</div>
                        <h2 class="locked-title">æŠ•è³‡åˆ¤æ–­ã‚µãƒãƒªãƒ¼</h2>
                        <p class="locked-description">
                            ç·åˆè©•ä¾¡ã€ãƒªã‚¹ã‚¯åˆ†æã€æŠ•è³‡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç­‰ã€<br>
                            æœ€çµ‚çš„ãªæŠ•è³‡åˆ¤æ–­ã«å¿…è¦ãªå…¨æƒ…å ±ã‚’çµ±åˆã—ãŸãƒ¬ãƒãƒ¼ãƒˆã§ã™ã€‚
                        </p>
                        <button class="unlock-button" onclick="requestUnlock(5)">
                            æœ€çµ‚æ¤œè¨æ®µéšã¸é€²ã‚€
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 6. å¿…è¦æ›¸é¡ä¸€å¼ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸5ã§é–‹ç¤ºï¼‰ -->
        <div id="documents" class="tab-content">
            <div class="section-card">
                <div class="locked-overlay">
                    <div class="locked-content">
                        <div class="locked-icon">ğŸ”’</div>
                        <h2 class="locked-title">å¥‘ç´„é–¢é€£æ›¸é¡ä¸€å¼</h2>
                        <p class="locked-description">
                            é‡è¦äº‹é …èª¬æ˜æ›¸ã€å£²è²·å¥‘ç´„æ›¸æ¡ˆã€ç™»è¨˜é–¢é€£æ›¸é¡ç­‰ã€<br>
                            å¥‘ç´„ã«å¿…è¦ãªå…¨ã¦ã®æ›¸é¡ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã„ãŸã ã‘ã¾ã™ã€‚
                        </p>
                        <button class="unlock-button" onclick="requestUnlock(5)">
                            å¥‘ç´„æº–å‚™ã‚’é–‹å§‹ã™ã‚‹
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="customSimModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>PRISMæŠ•è³‡åç›Šã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
                <span class="modal-close" onclick="closeCustomSimulation()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="simulation-form">
                    <!-- ç‰©ä»¶æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                    <div class="form-section">
                        <h3 class="form-section-title">ç‰©ä»¶æƒ…å ±</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">ç‰©ä»¶ä¾¡æ ¼</label>
                                <div class="input-group">
                                    <input type="number" id="purchasePrice" class="form-input" value="68000" style="flex: 1;">
                                    <span class="input-suffix">ä¸‡å††</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">é ­é‡‘æ¯”ç‡</label>
                                <div class="input-group">
                                    <input type="number" id="downPayment" class="form-input" value="25" min="0" max="100" style="flex: 1;">
                                    <span class="input-suffix">%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- èè³‡æ¡ä»¶ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                    <div class="form-section">
                        <h3 class="form-section-title">èè³‡æ¡ä»¶</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">å€Ÿå…¥é‡‘åˆ©</label>
                                <div class="input-group">
                                    <input type="number" id="interestRate" class="form-input" value="1.2" step="0.1" min="0" style="flex: 1;">
                                    <span class="input-suffix">%</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">å€Ÿå…¥æœŸé–“</label>
                                <div class="input-group">
                                    <input type="number" id="loanTerm" class="form-input" value="30" min="1" max="35" style="flex: 1;">
                                    <span class="input-suffix">å¹´</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- åç›Šæ¡ä»¶ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                    <div class="form-section">
                        <h3 class="form-section-title">åç›Šæ¡ä»¶</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">æœˆé¡è³ƒæ–™åå…¥</label>
                                <div class="input-group">
                                    <input type="number" id="monthlyRent" class="form-input" value="360" style="flex: 1;">
                                    <span class="input-suffix">ä¸‡å††</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">æƒ³å®šç©ºå®¤ç‡</label>
                                <div class="input-group">
                                    <input type="number" id="vacancyRate" class="form-input" value="5" min="0" max="100" style="flex: 1;">
                                    <span class="input-suffix">%</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ç®¡ç†è²»ç‡</label>
                                <div class="input-group">
                                    <input type="number" id="managementFee" class="form-input" value="5" min="0" max="100" style="flex: 1;">
                                    <span class="input-suffix">%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- çµŒè²»ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                    <div class="form-section">
                        <h3 class="form-section-title">ãã®ä»–çµŒè²»</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">å›ºå®šè³‡ç”£ç¨ï¼ˆå¹´é¡ï¼‰</label>
                                <div class="input-group">
                                    <input type="number" id="propertyTax" class="form-input" value="120" style="flex: 1;">
                                    <span class="input-suffix">ä¸‡å††</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ä¿®ç¹•ç©ç«‹é‡‘ï¼ˆæœˆé¡ï¼‰</label>
                                <div class="input-group">
                                    <input type="number" id="repairReserve" class="form-input" value="10" style="flex: 1;">
                                    <span class="input-suffix">ä¸‡å††</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æœŸé–“</label>
                                <div class="input-group">
                                    <input type="number" id="simulationYears" class="form-input" value="10" min="1" max="30" style="flex: 1;">
                                    <span class="input-suffix">å¹´</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="simulation-actions">
                    <button class="btn-calculate" onclick="calculateSimulation()">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ</button>
                    <button class="btn-reset" onclick="resetSimulationForm()">ãƒªã‚»ãƒƒãƒˆ</button>
                </div>

                <!-- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
                <div id="simulationResults" class="simulation-results">
                    <div class="results-header">
                        <h3>ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ</h3>
                        <p style="color: #718096; margin: 0;">PRISMç‹¬è‡ªã®åç›Šåˆ†æã«ã‚ˆã‚Šç®—å‡º</p>
                    </div>

                    <!-- æŠ•è³‡æ¦‚è¦ -->
                    <h4 style="color: #1a365d; margin-bottom: 15px; border-left: 4px solid #3182ce; padding-left: 15px;">æŠ•è³‡æ¦‚è¦</h4>
                    <div class="results-summary">
                        <div class="result-card">
                            <div class="result-label">è‡ªå·±è³‡é‡‘</div>
                            <div class="result-value" id="resultEquity">-</div>
                            <div class="result-unit">ï¼ˆé ­é‡‘ï¼‹è«¸è²»ç”¨ï¼‰</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">å€Ÿå…¥é‡‘é¡</div>
                            <div class="result-value" id="resultLoan">-</div>
                            <div class="result-unit">èè³‡é¡</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">æœˆé¡è¿”æ¸ˆé¡</div>
                            <div class="result-value" id="resultMonthlyPayment">-</div>
                            <div class="result-unit">å…ƒåˆ©å‡ç­‰</div>
                        </div>
                    </div>

                    <!-- å¹´é–“åæ”¯ -->
                    <h4 style="color: #1a365d; margin: 25px 0 15px; border-left: 4px solid #3182ce; padding-left: 15px;">å¹´é–“åæ”¯åˆ†æ</h4>
                    <div class="results-summary">
                        <div class="result-card">
                            <div class="result-label">å¹´é–“è³ƒæ–™åå…¥</div>
                            <div class="result-value" id="resultAnnualRent">-</div>
                            <div class="result-unit">ç©ºå®¤ç‡è€ƒæ…®å¾Œ</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">å¹´é–“çµŒè²»</div>
                            <div class="result-value" id="resultAnnualExpense">-</div>
                            <div class="result-unit">ãƒ­ãƒ¼ãƒ³è¿”æ¸ˆè¾¼</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">å¹´é–“ç´”åç›Š</div>
                            <div class="result-value" id="resultNetIncome" style="color: #38a169;">-</div>
                            <div class="result-unit">ç¨å¼•å‰</div>
                        </div>
                    </div>

                    <!-- æŠ•è³‡æŒ‡æ¨™ -->
                    <h4 style="color: #1a365d; margin: 25px 0 15px; border-left: 4px solid #3182ce; padding-left: 15px;">æŠ•è³‡æŒ‡æ¨™</h4>
                    <div class="results-summary">
                        <div class="result-card">
                            <div class="result-label">è¡¨é¢åˆ©å›ã‚Š</div>
                            <div class="result-value" id="resultGrossYield">-</div>
                            <div class="result-unit">å¹´é–“è³ƒæ–™Ã·ç‰©ä»¶ä¾¡æ ¼</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">å®Ÿè³ªåˆ©å›ã‚Š</div>
                            <div class="result-value" id="resultNetYield">-</div>
                            <div class="result-unit">ç´”åç›ŠÃ·è‡ªå·±è³‡é‡‘</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">æŠ•è³‡å›åæœŸé–“</div>
                            <div class="result-value" id="resultPayback">-</div>
                            <div class="result-unit">è‡ªå·±è³‡é‡‘å›åå¹´æ•°</div>
                        </div>
                    </div>

                    <!-- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼äºˆæ¸¬è¡¨ -->
                    <h4 style="color: #1a365d; margin: 25px 0 15px; border-left: 4px solid #3182ce; padding-left: 15px;">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼äºˆæ¸¬</h4>
                    <table class="cashflow-table">
                        <thead>
                            <tr>
                                <th>å¹´åº¦</th>
                                <th style="text-align: right;">è³ƒæ–™åå…¥</th>
                                <th style="text-align: right;">å¹´é–“çµŒè²»</th>
                                <th style="text-align: right;">ç´”åç›Š</th>
                                <th style="text-align: right;">ç´¯è¨ˆåç›Š</th>
                            </tr>
                        </thead>
                        <tbody id="cashflowTable">
                            <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                        </tbody>
                    </table>

                    <div class="result-actions">
                        <button class="btn-primary" onclick="downloadSimulation()">Excelãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        <button class="btn-primary" onclick="saveSimulation()">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¿å­˜</button>
                        <button class="btn-primary" onclick="requestConsultation()">å°‚é–€å®¶ã«ç›¸è«‡</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <h3 style="margin-bottom: 20px;">PRISM - Private Real-estate Investment Smart Matching</h3>
        <p>æ ªå¼ä¼šç¤¾ãƒ•ãƒ©ãƒ³ã‚·ãƒ¥ã‚¨ãƒƒãƒˆ ä¸å‹•ç”£äº‹æ¥­éƒ¨</p>
        <p style="margin-top: 10px;">ã€’103-0014 æ±äº¬éƒ½ä¸­å¤®åŒºæ—¥æœ¬æ©‹è›æ®»ç”º2-13-5 ç¾æ¿ƒå‹ãƒ“ãƒ«301A</p>
        <p>TEL: 03-6667-5757 | FAX: 03-6667-5758</p>
        <p style="margin-top: 20px; font-size: 0.9em;">Copyright Â© Franchette Corp. All Rights Reserved.</p>
    </div>

    <script>
        // ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¸ï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰
        let currentStage = 2;
        let isAdminMode = false;
        
        // ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½
        function openCustomSimulation() {
            document.getElementById('customSimModal').classList.add('active');
        }

        function closeCustomSimulation() {
            document.getElementById('customSimModal').classList.remove('active');
        }

        function calculateSimulation() {
            // å…¥åŠ›å€¤ã®å–å¾—
            const purchasePrice = parseFloat(document.getElementById('purchasePrice').value) || 0;
            const downPaymentRatio = parseFloat(document.getElementById('downPayment').value) / 100 || 0;
            const interestRate = parseFloat(document.getElementById('interestRate').value) / 100 || 0;
            const loanTerm = parseInt(document.getElementById('loanTerm').value) || 0;
            const monthlyRent = parseFloat(document.getElementById('monthlyRent').value) || 0;
            const vacancyRate = parseFloat(document.getElementById('vacancyRate').value) / 100 || 0;
            const managementFeeRate = parseFloat(document.getElementById('managementFee').value) / 100 || 0;
            const propertyTax = parseFloat(document.getElementById('propertyTax').value) || 0;
            const repairReserve = parseFloat(document.getElementById('repairReserve').value) || 0;
            const simulationYears = parseInt(document.getElementById('simulationYears').value) || 10;

            // è¨ˆç®—
            const equity = purchasePrice * downPaymentRatio;
            const loanAmount = purchasePrice - equity;
            const monthlyInterestRate = interestRate / 12;
            const numberOfPayments = loanTerm * 12;
            
            // æœˆé¡è¿”æ¸ˆé¡ï¼ˆå…ƒåˆ©å‡ç­‰è¿”æ¸ˆï¼‰
            let monthlyPayment = 0;
            if (monthlyInterestRate > 0) {
                monthlyPayment = loanAmount * (monthlyInterestRate * Math.pow(1 + monthlyInterestRate, numberOfPayments)) / 
                                 (Math.pow(1 + monthlyInterestRate, numberOfPayments) - 1);
            } else {
                monthlyPayment = loanAmount / numberOfPayments;
            }

            // å¹´é–“åæ”¯è¨ˆç®—
            const annualRentGross = monthlyRent * 12;
            const annualRentNet = annualRentGross * (1 - vacancyRate);
            const annualManagementFee = annualRentNet * managementFeeRate;
            const annualRepair = repairReserve * 12;
            const annualLoanPayment = monthlyPayment * 12;
            const annualExpenses = annualManagementFee + propertyTax + annualRepair + annualLoanPayment;
            const annualNetIncome = annualRentNet - annualExpenses;

            // åˆ©å›ã‚Šè¨ˆç®—
            const grossYield = (annualRentGross / purchasePrice) * 100;
            const netYield = (annualNetIncome / equity) * 100;
            const paybackPeriod = equity / annualNetIncome;

            // çµæœã®è¡¨ç¤º
            document.getElementById('resultEquity').textContent = `${equity.toFixed(0)}ä¸‡å††`;
            document.getElementById('resultLoan').textContent = `${loanAmount.toFixed(0)}ä¸‡å††`;
            document.getElementById('resultMonthlyPayment').textContent = `${(monthlyPayment / 10000).toFixed(1)}ä¸‡å††`;
            document.getElementById('resultAnnualRent').textContent = `${annualRentNet.toFixed(0)}ä¸‡å††`;
            document.getElementById('resultAnnualExpense').textContent = `${annualExpenses.toFixed(0)}ä¸‡å††`;
            document.getElementById('resultNetIncome').textContent = `${annualNetIncome.toFixed(0)}ä¸‡å††`;
            document.getElementById('resultGrossYield').textContent = `${grossYield.toFixed(2)}%`;
            document.getElementById('resultNetYield').textContent = `${netYield.toFixed(2)}%`;
            document.getElementById('resultPayback').textContent = `${Math.abs(paybackPeriod).toFixed(1)}å¹´`;

            // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼è¡¨ã®ç”Ÿæˆ
            const cashflowTable = document.getElementById('cashflowTable');
            cashflowTable.innerHTML = '';
            let cumulativeIncome = 0;

            for (let year = 1; year <= simulationYears; year += (simulationYears > 10 ? 5 : 1)) {
                // çµŒå¹´ã«ã‚ˆã‚‹è³ƒæ–™ä¸‹è½ã‚’è€ƒæ…®ï¼ˆå¹´1%ä¸‹è½ã¨ä»®å®šï¼‰
                const rentDeclineRate = Math.pow(0.99, year - 1);
                const yearRent = annualRentNet * rentDeclineRate;
                const yearExpenses = annualExpenses;
                const yearNetIncome = yearRent - yearExpenses;
                cumulativeIncome += yearNetIncome;

                const row = cashflowTable.insertRow();
                row.innerHTML = `
                    <td>${year}å¹´ç›®</td>
                    <td style="text-align: right;">${yearRent.toFixed(0)}ä¸‡å††</td>
                    <td style="text-align: right;">${yearExpenses.toFixed(0)}ä¸‡å††</td>
                    <td style="text-align: right; color: ${yearNetIncome >= 0 ? '#38a169' : '#e53e3e'};">
                        ${yearNetIncome.toFixed(0)}ä¸‡å††
                    </td>
                    <td style="text-align: right; font-weight: bold; color: ${cumulativeIncome >= 0 ? '#38a169' : '#e53e3e'};">
                        ${cumulativeIncome.toFixed(0)}ä¸‡å††
                    </td>
                `;
            }

            document.getElementById('simulationResults').style.display = 'block';
        }

        function resetSimulationForm() {
            // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('purchasePrice').value = 68000;
            document.getElementById('downPayment').value = 25;
            document.getElementById('interestRate').value = 1.2;
            document.getElementById('loanTerm').value = 30;
            document.getElementById('monthlyRent').value = 360;
            document.getElementById('vacancyRate').value = 5;
            document.getElementById('managementFee').value = 5;
            document.getElementById('propertyTax').value = 120;
            document.getElementById('repairReserve').value = 10;
            document.getElementById('simulationYears').value = 10;
            
            // çµæœã‚¨ãƒªã‚¢ã‚’éè¡¨ç¤º
            document.getElementById('simulationResults').style.display = 'none';
        }

        function downloadSimulation() {
            alert('PRISMæŠ•è³‡åˆ†æãƒ¬ãƒãƒ¼ãƒˆï¼ˆExcelå½¢å¼ï¼‰ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã™ã€‚\nè©³ç´°ãªåæ”¯äºˆæ¸¬ã¨æ„Ÿåº¦åˆ†æã‚’å«ã‚€ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒ¬ãƒãƒ¼ãƒˆã§ã™ã€‚');
            // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ
        }

        function saveSimulation() {
            alert('ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã‚’ãƒã‚¤ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã«ä¿å­˜ã—ã¾ã—ãŸã€‚\nä»–ã®ç‰©ä»¶ã¨ã®æ¯”è¼ƒåˆ†æãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚');
            // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
        }

        function requestConsultation() {
            alert('PRISMå°‚é–€ã‚¢ãƒ‰ãƒã‚¤ã‚¶ãƒ¼ã¸ã®ç›¸è«‡ç”³è«‹ã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸã€‚\n24æ™‚é–“ä»¥å†…ã«æŠ•è³‡æˆ¦ç•¥ã®ã”ææ¡ˆã‚’ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚');
            // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€å•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ ã¸é·ç§»
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å¤–å´ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
        window.onclick = function(event) {
            const modal = document.getElementById('customSimModal');
            if (event.target == modal) {
                closeCustomSimulation();
            }
        }
        
        // ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡æ›¿
        function toggleAdminMode() {
            isAdminMode = !isAdminMode;
            const adminPanel = document.getElementById('adminPanel');
            const adminBtn = document.getElementById('adminToggle');
            
            if (isAdminMode) {
                adminPanel.style.display = 'block';
                adminBtn.style.background = '#3182ce';
                adminBtn.innerHTML = 'ğŸ”§ ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰ï¼ˆONï¼‰';
            } else {
                adminPanel.style.display = 'none';
                adminBtn.style.background = 'rgba(255, 255, 255, 0.2)';
                adminBtn.innerHTML = 'ğŸ”§ ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰';
            }
        }
        
        // ã‚¹ãƒ†ãƒ¼ã‚¸è¨­å®šï¼ˆç®¡ç†è€…ç”¨ï¼‰
        function setStage(stage) {
            currentStage = stage;
            updateStageIndicator();
            unlockContent();
            
            // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
            document.querySelectorAll('.stage-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ç®¡ç†è€…æƒ…å ±ã‚’æ›´æ–°
            document.getElementById('currentStageInfo').textContent = `ã‚¹ãƒ†ãƒ¼ã‚¸${stage}`;
            
            // è©²å½“ã™ã‚‹ã‚¿ãƒ–ã‚’è¡¨ç¤º
            if (stage === 1) showTab('overview', 1);
            else if (stage === 2) showTab('simulation', 2);
            else if (stage === 3) loadAndShowTab('valuation', 3);
            else if (stage === 4) loadAndShowTab('finance', 4);
            else if (stage === 5) loadAndShowTab('summary', 5);
        }
        
        // é¡§å®¢ã‚¿ã‚¤ãƒ—å¤‰æ›´ï¼ˆç®¡ç†è€…ç”¨ï¼‰
        function changeCustomerType() {
            const customerType = document.getElementById('customerType').value;
            const customerNames = {
                'new': 'æ–°è¦é¡§å®¢ï¼ˆç”°ä¸­æ§˜ï¼‰',
                'interested': 'é–¢å¿ƒé¡§å®¢ï¼ˆéˆ´æœ¨æ§˜ï¼‰',
                'serious': 'æœ¬æ ¼æ¤œè¨ï¼ˆå±±ç”°æ§˜ï¼‰',
                'negotiating': 'å•†è«‡ä¸­ï¼ˆä½è—¤æ§˜ï¼‰',
                'closing': 'æˆç´„å‰ï¼ˆé«˜æ©‹æ§˜ï¼‰'
            };
            
            const stageMap = {
                'new': 1,
                'interested': 2,
                'serious': 3,
                'negotiating': 4,
                'closing': 5
            };
            
            document.getElementById('currentCustomer').textContent = customerNames[customerType];
            setStage(stageMap[customerType]);
        }
        
        // å…¨è³‡æ–™ã‚¢ãƒ³ãƒ­ãƒƒã‚¯ï¼ˆç®¡ç†è€…ç”¨ï¼‰
        function unlockAll() {
            currentStage = 5;
            updateStageIndicator();
            unlockContent();
            loadAllContent();
            alert('å…¨ã¦ã®è³‡æ–™ãŒã‚¢ãƒ³ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã—ãŸã€‚');
        }
        
        // ãƒªã‚»ãƒƒãƒˆï¼ˆç®¡ç†è€…ç”¨ï¼‰
        function resetAll() {
            currentStage = 2;
            updateStageIndicator();
            resetContent();
            showTab('overview', 1);
            document.getElementById('customerType').value = 'interested';
            alert('åˆæœŸçŠ¶æ…‹ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸2ï¼‰ã«ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸã€‚');
        }
        
        // ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹è¡¨ç¤ºï¼ˆç®¡ç†è€…ç”¨ï¼‰
        function showAnalytics() {
            const statsDiv = document.getElementById('adminStats');
            if (statsDiv.style.display === 'none') {
                statsDiv.style.display = 'grid';
            } else {
                statsDiv.style.display = 'none';
            }
        }
        
        // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒªã‚»ãƒƒãƒˆ
        function resetContent() {
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach((tab, index) => {
                if (index > 1) {
                    tab.classList.add('locked');
                }
            });
            
            // ãƒ­ãƒƒã‚¯ç”»é¢ã‚’å†è¨­å®š
            document.querySelector('#valuation .section-card').innerHTML = getLockedContent('ä¾¡æ ¼æŸ»å®šåˆ†æ', 'PRISMç‹¬è‡ªã®3æ‰‹æ³•ã«ã‚ˆã‚‹è©³ç´°ãªä¾¡æ ¼æŸ»å®šåˆ†æã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™ã€‚<br>ã‚¨ãƒªã‚¢ç›¸å ´ã¨ã®æ¯”è¼ƒã€æŠ•è³‡å¦¥å½“æ€§ã®åˆ¤å®šçµæœã‚’å«ã¿ã¾ã™ã€‚', 3);
            document.querySelector('#finance .section-card').innerHTML = getLockedContent('èè³‡è¨ˆç”»è©³ç´°', 'ææºé‡‘èæ©Ÿé–¢ã®èè³‡æ¡ä»¶ã€å¿…è¦å±æ€§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€<br>éŠ€è¡Œè©•ä¾¡é¡äºˆæ¸¬ãªã©ã€èè³‡å®Ÿç¾ã«å‘ã‘ãŸè©³ç´°æƒ…å ±ã‚’ã”æä¾›ã—ã¾ã™ã€‚', 4);
            document.querySelector('#summary .section-card').innerHTML = getLockedContent('æŠ•è³‡åˆ¤æ–­ã‚µãƒãƒªãƒ¼', 'ç·åˆè©•ä¾¡ã€ãƒªã‚¹ã‚¯åˆ†æã€æŠ•è³‡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç­‰ã€<br>æœ€çµ‚çš„ãªæŠ•è³‡åˆ¤æ–­ã«å¿…è¦ãªå…¨æƒ…å ±ã‚’çµ±åˆã—ãŸãƒ¬ãƒãƒ¼ãƒˆã§ã™ã€‚', 5);
            document.querySelector('#documents .section-card').innerHTML = getLockedContent('å¥‘ç´„é–¢é€£æ›¸é¡ä¸€å¼', 'é‡è¦äº‹é …èª¬æ˜æ›¸ã€å£²è²·å¥‘ç´„æ›¸æ¡ˆã€ç™»è¨˜é–¢é€£æ›¸é¡ç­‰ã€<br>å¥‘ç´„ã«å¿…è¦ãªå…¨ã¦ã®æ›¸é¡ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã„ãŸã ã‘ã¾ã™ã€‚', 5);
        }
        
        // ãƒ­ãƒƒã‚¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®HTMLç”Ÿæˆ
        function getLockedContent(title, description, stage) {
            return `
                <div class="locked-overlay">
                    <div class="locked-content">
                        <div class="locked-icon">ğŸ”’</div>
                        <h2 class="locked-title">${title}</h2>
                        <p class="locked-description">${description}</p>
                        <button class="unlock-button" onclick="requestUnlock(${stage})">
                            ${stage === 3 ? 'ã‚¢ãƒ³ãƒ­ãƒƒã‚¯ã‚’ç”³è«‹ã™ã‚‹' : 
                              stage === 4 ? 'å•†è«‡ã‚’ç”³ã—è¾¼ã‚€' : 
                              'æœ€çµ‚æ¤œè¨æ®µéšã¸é€²ã‚€'}
                        </button>
                    </div>
                </div>
            `;
        }
        
        // å…¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„èª­ã¿è¾¼ã¿ï¼ˆç®¡ç†è€…ç”¨ï¼‰
        function loadAllContent() {
            loadStageContent(3);
            loadStageContent(4);
            loadStageContent(5);
        }
        
        // ã‚¿ãƒ–è¡¨ç¤ºã¨å†…å®¹èª­ã¿è¾¼ã¿
        function loadAndShowTab(tabId, stage) {
            loadStageContent(stage);
            showTab(tabId, stage);
        }
        
        function showTab(tabId, requiredStage) {
            // å¿…è¦ãªã‚¹ãƒ†ãƒ¼ã‚¸ã«é”ã—ã¦ã„ãªã„å ´åˆ
            if (requiredStage && requiredStage > currentStage && !isAdminMode) {
                showLockedMessage(requiredStage);
                return;
            }
            
            // ã™ã¹ã¦ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤º
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => {
                content.classList.remove('active');
            });
            
            // ã™ã¹ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã‹ã‚‰ active ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
            document.getElementById(tabId).classList.add('active');
            
            // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ãƒœã‚¿ãƒ³ã« active ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
            const activeTab = Array.from(tabs).find(tab => 
                tab.textContent.includes(getTabTitle(tabId))
            );
            if (activeTab && !activeTab.classList.contains('locked')) {
                activeTab.classList.add('active');
            }
            
            // ãƒšãƒ¼ã‚¸ãƒˆãƒƒãƒ—ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function getTabTitle(tabId) {
            const titles = {
                'overview': 'ç‰©ä»¶æ¦‚è¦',
                'simulation': 'åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³',
                'valuation': 'ä¾¡æ ¼æŸ»å®š',
                'finance': 'èè³‡è¨ˆç”»',
                'summary': 'æŠ•è³‡åˆ¤æ–­',
                'documents': 'å¿…è¦æ›¸é¡'
            };
            return titles[tabId] || '';
        }
        
        function showLockedMessage(requiredStage) {
            const messages = {
                3: 'ä¾¡æ ¼æŸ»å®šåˆ†æã‚’ã”è¦§ã„ãŸã ãã«ã¯ã€è©³ç´°æ¤œè¨æ®µéšã¸ã®ç§»è¡ŒãŒå¿…è¦ã§ã™ã€‚',
                4: 'èè³‡è¨ˆç”»ã®è©³ç´°ã¯ã€å•†è«‡æ®µéšã§ã”æä¾›ã„ãŸã—ã¾ã™ã€‚',
                5: 'æœ€çµ‚è³‡æ–™ã¯ã€å¥‘ç´„å‰ã®æœ€çµ‚ç¢ºèªæ®µéšã§ã”æä¾›ã„ãŸã—ã¾ã™ã€‚'
            };
            
            alert(messages[requiredStage] || 'ã“ã®æƒ…å ±ã¯æ¬¡ã®æ®µéšã§ã”æä¾›ã„ãŸã—ã¾ã™ã€‚');
        }
        
        function requestUnlock(stage) {
            const actions = {
                3: 'ä¾¡æ ¼æŸ»å®šåˆ†æã®ã‚¢ãƒ³ãƒ­ãƒƒã‚¯ç”³è«‹ã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸã€‚æ‹…å½“è€…ã‚ˆã‚Šé€£çµ¡ã„ãŸã—ã¾ã™ã€‚',
                4: 'å•†è«‡ã®ãŠç”³ã—è¾¼ã¿ã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸã€‚æ—¥ç¨‹èª¿æ•´ã®ã”é€£çµ¡ã‚’ã„ãŸã—ã¾ã™ã€‚',
                5: 'æœ€çµ‚æ¤œè¨æ®µéšã¸ã®ç§»è¡Œã‚’ç¢ºèªã—ã¾ã—ãŸã€‚å…¨è³‡æ–™ã‚’æº–å‚™ã„ãŸã—ã¾ã™ã€‚'
            };
            
            alert(actions[stage]);
            // å®Ÿéš›ã«ã¯ã“ã“ã§APIã‚³ãƒ¼ãƒ«ãªã©ã‚’è¡Œã†
        }
        
        function advanceStage() {
            if (currentStage < 5) {
                currentStage++;
                updateStageIndicator();
                unlockContent();
                alert(`ã‚¹ãƒ†ãƒ¼ã‚¸${currentStage}ã«é€²ã¿ã¾ã—ãŸã€‚æ–°ã—ã„æƒ…å ±ãŒã‚¢ãƒ³ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã—ãŸã€‚`);
            }
        }
        
        function updateStageIndicator() {
            // ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’æ›´æ–°
            const stageItems = document.querySelectorAll('.stage-item');
            stageItems.forEach((item, index) => {
                if (index < currentStage - 1) {
                    item.classList.add('completed');
                    item.classList.remove('current');
                } else if (index === currentStage - 1) {
                    item.classList.add('current');
                    item.classList.remove('completed');
                } else {
                    item.classList.remove('completed', 'current');
                }
            });
            
            // ã‚¹ãƒ†ãƒ¼ã‚¸èª¬æ˜ã‚’æ›´æ–°
            const descriptions = {
                1: {
                    title: 'ã‚¹ãƒ†ãƒ¼ã‚¸1ï¼šåˆå›æ¥è§¦',
                    desc: 'ç‰©ä»¶ã®åŸºæœ¬æƒ…å ±ã‚’ã”ç¢ºèªã„ãŸã ãæ®µéšã§ã™ã€‚',
                    unlocked: 'ç‰©ä»¶æ¦‚è¦',
                    next: 'åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³'
                },
                2: {
                    title: 'ã‚¹ãƒ†ãƒ¼ã‚¸2ï¼šé–¢å¿ƒè¡¨æ˜',
                    desc: 'ç‰©ä»¶æ¦‚è¦ã‚’ã”ç¢ºèªã„ãŸã ãã€ã‚ˆã‚Šè©³ç´°ãªåç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã”è¦§ã„ãŸã ã‘ã‚‹æ®µéšã§ã™ã€‚',
                    unlocked: 'ç‰©ä»¶æ¦‚è¦ã€åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³',
                    next: 'ä¾¡æ ¼æŸ»å®šåˆ†æã€èè³‡è¨ˆç”»è©³ç´°'
                },
                3: {
                    title: 'ã‚¹ãƒ†ãƒ¼ã‚¸3ï¼šè©³ç´°æ¤œè¨',
                    desc: 'PRISMç‹¬è‡ªã®ä¾¡æ ¼æŸ»å®šåˆ†æã«ã‚ˆã‚Šã€æŠ•è³‡åˆ¤æ–­ã®ææ–™ã‚’ã”æä¾›ã—ã¾ã™ã€‚',
                    unlocked: 'ç‰©ä»¶æ¦‚è¦ã€åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ä¾¡æ ¼æŸ»å®š',
                    next: 'èè³‡è¨ˆç”»è©³ç´°ã€æŠ•è³‡åˆ¤æ–­ã‚µãƒãƒªãƒ¼'
                },
                4: {
                    title: 'ã‚¹ãƒ†ãƒ¼ã‚¸4ï¼šå•†è«‡',
                    desc: 'èè³‡è¨ˆç”»ã‚’å«ã‚€å…·ä½“çš„ãªæŠ•è³‡ãƒ—ãƒ©ãƒ³ã‚’ã”ææ¡ˆã—ã¾ã™ã€‚',
                    unlocked: 'ç‰©ä»¶æ¦‚è¦ã€åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ä¾¡æ ¼æŸ»å®šã€èè³‡è¨ˆç”»',
                    next: 'æŠ•è³‡åˆ¤æ–­ã‚µãƒãƒªãƒ¼ã€å¥‘ç´„æ›¸é¡'
                },
                5: {
                    title: 'ã‚¹ãƒ†ãƒ¼ã‚¸5ï¼šæœ€çµ‚ç¢ºèª',
                    desc: 'å…¨ã¦ã®æƒ…å ±ã‚’é–‹ç¤ºã—ã€æœ€çµ‚çš„ãªæŠ•è³‡åˆ¤æ–­ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚',
                    unlocked: 'å…¨è³‡æ–™',
                    next: 'å¥‘ç´„æ‰‹ç¶šãã¸'
                }
            };
            
            const stageDesc = descriptions[currentStage];
            if (stageDesc) {
                document.querySelector('.stage-description').innerHTML = `
                    <h3>${stageDesc.title}</h3>
                    <p>${stageDesc.desc}</p>
                    <p style="margin-top: 10px;"><strong>ã‚¢ãƒ³ãƒ­ãƒƒã‚¯æ¸ˆã¿ï¼š</strong>${stageDesc.unlocked}</p>
                    <p><strong>æ¬¡ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã§é–‹ç¤ºï¼š</strong>${stageDesc.next}</p>
                `;
            }
        }
        
        function unlockContent() {
            const tabs = document.querySelectorAll('.nav-tab');
            const unlockMap = {
                1: [0],              // ã‚¹ãƒ†ãƒ¼ã‚¸1: ç‰©ä»¶æ¦‚è¦ã®ã¿
                2: [0, 1],           // ã‚¹ãƒ†ãƒ¼ã‚¸2: ç‰©ä»¶æ¦‚è¦ã€åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                3: [0, 1, 2],        // ã‚¹ãƒ†ãƒ¼ã‚¸3: ï¼‹ä¾¡æ ¼æŸ»å®š
                4: [0, 1, 2, 3],     // ã‚¹ãƒ†ãƒ¼ã‚¸4: ï¼‹èè³‡è¨ˆç”»
                5: [0, 1, 2, 3, 4, 5] // ã‚¹ãƒ†ãƒ¼ã‚¸5: å…¨ã¦
            };
            
            tabs.forEach((tab, index) => {
                if (unlockMap[currentStage] && unlockMap[currentStage].includes(index)) {
                    tab.classList.remove('locked');
                } else if (!isAdminMode) {
                    tab.classList.add('locked');
                }
            });
        }
        
        // ã‚¹ãƒ†ãƒ¼ã‚¸ã”ã¨ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤º
        function loadStageContent(stage) {
            if (stage >= 3) {
                // ä¾¡æ ¼æŸ»å®šã®ãƒ­ãƒƒã‚¯ã‚’è§£é™¤ã—ã¦å®Ÿã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
                document.querySelector('#valuation .section-card').innerHTML = `
                    <h2 class="section-title">3. PRISMç‹¬è‡ªä¾¡æ ¼æŸ»å®šåˆ†æ</h2>
                    <h3 class="subsection-title">æŸ»å®šçµæœã‚µãƒãƒªãƒ¼</h3>
                    <div class="kpi-grid">
                        <div class="kpi-card">
                            <div class="kpi-label">å£²å‡ºä¾¡æ ¼</div>
                            <div class="kpi-value">6.8</div>
                            <div class="kpi-unit">å„„å††</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">PRISMæŸ»å®šä¾¡æ ¼</div>
                            <div class="kpi-value">7.2</div>
                            <div class="kpi-unit">å„„å††</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">ä¾¡æ ¼å¦¥å½“æ€§</div>
                            <div class="kpi-value" style="color: #38a169;">å„ªè‰¯</div>
                            <div class="kpi-unit">å‰²å®‰åˆ¤å®š</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">æŠ•è³‡æ¨å¥¨åº¦</div>
                            <div class="kpi-value">S</div>
                            <div class="kpi-unit">æœ€å„ªå…ˆæ¨å¥¨</div>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn-primary" onclick="advanceStage()">èè³‡è¨ˆç”»ã‚’ç¢ºèªã™ã‚‹</button>
                    </div>
                `;
            }
            
            if (stage >= 4) {
                // èè³‡è¨ˆç”»ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
                document.querySelector('#finance .section-card').innerHTML = `
                    <h2 class="section-title">4. èè³‡è¨ˆç”»ãƒ»éŠ€è¡Œè©•ä¾¡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
                    <h3 class="subsection-title">æ¨å¥¨èè³‡ãƒ—ãƒ©ãƒ³</h3>
                    <div class="property-overview">
                        <div class="info-box">
                            <h4>èè³‡é‡‘é¡</h4>
                            <span class="highlight-number">5.1å„„å††</span>
                            <p>èè³‡æ¯”ç‡ï¼š75%</p>
                        </div>
                        <div class="info-box">
                            <h4>è‡ªå·±è³‡é‡‘</h4>
                            <span class="highlight-number">1.8å„„å††</span>
                            <p>é ­é‡‘ï¼‹è«¸è²»ç”¨</p>
                        </div>
                        <div class="info-box">
                            <h4>æƒ³å®šé‡‘åˆ©</h4>
                            <span class="highlight-number">1.2%</span>
                            <p>å¤‰å‹•é‡‘åˆ©ï¼ˆå„ªé‡é©ç”¨ï¼‰</p>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn-primary" onclick="advanceStage()">æœ€çµ‚ç¢ºèªã¸é€²ã‚€</button>
                    </div>
                `;
            }
            
            if (stage >= 5) {
                // æŠ•è³‡åˆ¤æ–­ã‚µãƒãƒªãƒ¼ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
                document.querySelector('#summary .section-card').innerHTML = `
                    <h2 class="section-title">5. æŠ•è³‡åˆ¤æ–­ã‚µãƒãƒªãƒ¼</h2>
                    <div style="background: #eff6ff; padding: 30px; text-align: center; margin: 20px 0;">
                        <h2 style="color: #1a365d; margin-bottom: 20px;">PRISMæŠ•è³‡æ¨å¥¨åº¦</h2>
                        <span style="font-size: 4em; color: #1a365d; font-weight: bold;">S</span>
                        <p style="margin-top: 10px; font-size: 1.2em;">æœ€å„ªå…ˆæ¨å¥¨</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn-primary" onclick="alert('å¥‘ç´„æº–å‚™ã‚’é–‹å§‹ã—ã¾ã™')">å¥‘ç´„æº–å‚™ã¸é€²ã‚€</button>
                    </div>
                `;
                
                // å¿…è¦æ›¸é¡ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
                document.querySelector('#documents .section-card').innerHTML = `
                    <h2 class="section-title">6. ã”æä¾›è³‡æ–™ä¸€è¦§</h2>
                    <h3 class="subsection-title">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½è³‡æ–™</h3>
                    <ul class="checklist">
                        <li>ç‰©ä»¶æ¦‚è¦æ›¸ï¼ˆè©³ç´°ç‰ˆï¼‰</li>
                        <li>PRISMä¾¡å€¤è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆï¼ˆ30ãƒšãƒ¼ã‚¸ï¼‰</li>
                        <li>10å¹´é–“åæ”¯ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆExcelï¼‰</li>
                        <li>é‡è¦äº‹é …èª¬æ˜æ›¸ï¼ˆæ¡ˆï¼‰</li>
                        <li>å£²è²·å¥‘ç´„æ›¸ï¼ˆæ¡ˆï¼‰</li>
                    </ul>
                    <div class="action-buttons">
                        <button class="btn-primary" onclick="alert('è³‡æ–™ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰')">å…¨è³‡æ–™ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>